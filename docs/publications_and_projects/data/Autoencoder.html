<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Suraj Jaiswal">
<meta name="dcterms.date" content="2023-11-17">

<title>Image-to-Image for Climate Modelling using Auto-Encoders – Suraj Jaiswal</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6ec84bd1cbca259591e26654c72239a2.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Suraj Jaiswal</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blogs/index.html"> 
<span class="menu-text">Blogs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications_and_projects/index.html"> 
<span class="menu-text">Publications and Projects</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../resume/Suraj_Jaiswal_Resume.pdf"> 
<span class="menu-text">Resume</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link active" data-scroll-target="#exploratory-data-analysis">Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#visualizing-96-hr-files" id="toc-visualizing-96-hr-files" class="nav-link" data-scroll-target="#visualizing-96-hr-files">Visualizing 96 hr files</a></li>
  <li><a href="#visualizing-120-hr-files" id="toc-visualizing-120-hr-files" class="nav-link" data-scroll-target="#visualizing-120-hr-files">Visualizing 120 hr files</a></li>
  </ul></li>
  <li><a href="#constructing-data" id="toc-constructing-data" class="nav-link" data-scroll-target="#constructing-data">Constructing data</a></li>
  <li><a href="#simple-autoencoder" id="toc-simple-autoencoder" class="nav-link" data-scroll-target="#simple-autoencoder">Simple autoencoder</a>
  <ul class="collapse">
  <li><a href="#model-defination" id="toc-model-defination" class="nav-link" data-scroll-target="#model-defination">Model defination</a></li>
  <li><a href="#training-single-channel-input-and-outputp25" id="toc-training-single-channel-input-and-outputp25" class="nav-link" data-scroll-target="#training-single-channel-input-and-outputp25">Training single channel input and output(P25)</a></li>
  <li><a href="#training-single-channel-input-and-outputp25-1" id="toc-training-single-channel-input-and-outputp25-1" class="nav-link" data-scroll-target="#training-single-channel-input-and-outputp25-1">Training single channel input and output(P25)</a></li>
  <li><a href="#insights" id="toc-insights" class="nav-link" data-scroll-target="#insights">Insights</a></li>
  </ul></li>
  <li><a href="#autoencoder-with-convolutional-layers" id="toc-autoencoder-with-convolutional-layers" class="nav-link" data-scroll-target="#autoencoder-with-convolutional-layers">Autoencoder with convolutional layers</a>
  <ul class="collapse">
  <li><a href="#model-defination-1" id="toc-model-defination-1" class="nav-link" data-scroll-target="#model-defination-1">Model defination</a></li>
  <li><a href="#training-on-all-channel-and-predicting-on-all-channel" id="toc-training-on-all-channel-and-predicting-on-all-channel" class="nav-link" data-scroll-target="#training-on-all-channel-and-predicting-on-all-channel">training on all channel and predicting on all channel</a></li>
  <li><a href="#single-channel-input-single-channel-output-p25" id="toc-single-channel-input-single-channel-output-p25" class="nav-link" data-scroll-target="#single-channel-input-single-channel-output-p25">Single channel input single channel output (P25)</a></li>
  <li><a href="#single-channel-input-multiple-channel-output-p10" id="toc-single-channel-input-multiple-channel-output-p10" class="nav-link" data-scroll-target="#single-channel-input-multiple-channel-output-p10">Single channel input multiple channel output (P10)</a></li>
  <li><a href="#insights-1" id="toc-insights-1" class="nav-link" data-scroll-target="#insights-1">Insights</a></li>
  <li><a href="#training-on-top-4-channel-and-predicting-on-all-channel-conv" id="toc-training-on-top-4-channel-and-predicting-on-all-channel-conv" class="nav-link" data-scroll-target="#training-on-top-4-channel-and-predicting-on-all-channel-conv">Training on top 4 channel and predicting on all channel CONV</a></li>
  </ul></li>
  <li><a href="#unet-autoencoder-with-convolutional-layers" id="toc-unet-autoencoder-with-convolutional-layers" class="nav-link" data-scroll-target="#unet-autoencoder-with-convolutional-layers">UNET Autoencoder with convolutional layers</a>
  <ul class="collapse">
  <li><a href="#model-defination-2" id="toc-model-defination-2" class="nav-link" data-scroll-target="#model-defination-2">Model defination</a></li>
  <li><a href="#training-on-all-channel-and-predicting-on-all-channel-unet" id="toc-training-on-all-channel-and-predicting-on-all-channel-unet" class="nav-link" data-scroll-target="#training-on-all-channel-and-predicting-on-all-channel-unet">Training on all channel and predicting on all channel UNET</a></li>
  <li><a href="#single-channel-input-single-channel-outputp25-unet" id="toc-single-channel-input-single-channel-outputp25-unet" class="nav-link" data-scroll-target="#single-channel-input-single-channel-outputp25-unet">Single channel input single channel output(P25) UNET</a></li>
  <li><a href="#single-channel-input-single-channel-outputp10-unet" id="toc-single-channel-input-single-channel-outputp10-unet" class="nav-link" data-scroll-target="#single-channel-input-single-channel-outputp10-unet">Single channel input single channel output(P10) UNET</a></li>
  <li><a href="#insights-2" id="toc-insights-2" class="nav-link" data-scroll-target="#insights-2">Insights</a></li>
  <li><a href="#training-on-top-4-channel-and-predicting-on-all-channel-unet" id="toc-training-on-top-4-channel-and-predicting-on-all-channel-unet" class="nav-link" data-scroll-target="#training-on-top-4-channel-and-predicting-on-all-channel-unet">Training on top 4 channel and predicting on all channel UNET</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Image-to-Image for Climate Modelling using Auto-Encoders</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Deep Learning</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Suraj Jaiswal </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 17, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><img src="../images/autoencoder/camx.png" width="800"></p>
<p><a href="https://colab.research.google.com/github/jaiswalsuraj487/Climax_project_autoencoder/blob/main/Autoencoder.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>
<p>We have implemented MLP autoencoder, CNN autoencoder, and UNET autoencoder for image to image prediction on Camx dataset.</p>
<p>Go through the <a href="https://github.com/jaiswalsuraj487/Climax_project_autoencoder/blob/main/Presentation.pdf">link</a> to see the presentation of the project to get the flow.</p>
<p>Git Repo: <a href="https://github.com/jaiswalsuraj487/Climax_project_autoencoder">link</a></p>
<div id="cell-3" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xarray <span class="im">as</span> xr</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.utils.data <span class="im">as</span> data</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># from torchsummary import summary</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchinfo <span class="im">import</span> summary</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> trange</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>device <span class="op">=</span> torch.device(<span class="st">"cuda"</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">"cpu"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># device = torch.device("cuda:2")</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(device)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>current_device <span class="op">=</span> device <span class="co">#torch.cuda.current_device()</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>device_name <span class="op">=</span> torch.cuda.get_device_name(current_device)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Current GPU assigned: </span><span class="sc">{</span>current_device<span class="sc">}</span><span class="ss">, Name: </span><span class="sc">{</span>device_name<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cuda
Current GPU assigned: cuda, Name: Quadro RTX 5000</code></pre>
</div>
</div>
<p>Consider it a prediction task, use any channel like pressure and/or wind speed inputs to start with, because they are the indicators of horizontal movement of air pollution. Multiple inputs can go as multiple channels of images similar to RGB. Output can be P25 or P10 in cam 120hr files.</p>
<div id="cell-6" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_latitudes():</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    lat_start<span class="op">=</span> <span class="fl">76.8499984741211</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    lat_step<span class="op">=</span><span class="fl">0.009999999776482582</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    latitudes<span class="op">=</span>[]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">80</span>):</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        latitudes.append(lat_start<span class="op">+</span>i<span class="op">*</span>lat_step)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    latitudes.reverse()</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> latitudes</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_longitudes():</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    long_start<span class="op">=</span> <span class="fl">28.200000762939453</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    long_step<span class="op">=</span><span class="fl">0.009999999776482582</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    longitudes<span class="op">=</span>[]</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">80</span>):</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        longitudes.append(long_start<span class="op">+</span>i<span class="op">*</span>long_step)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># longitudes.reverse()</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> longitudes</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>latitudes<span class="op">=</span>get_latitudes()</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>longitudes<span class="op">=</span>get_longitudes()</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_plot(data,hour,var_name):</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(data[var_name].shape) #shape (120, 1, 80, 80)</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    p10_hour<span class="op">=</span>data[var_name][<span class="st">'TSTEP'</span><span class="op">==</span>hour] <span class="co"># shape (1, 80, 80)</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    p10_hour<span class="op">=</span>p10_hour[<span class="dv">0</span>,:,:] <span class="co"># shape (80, 80)</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    plt.imshow(p10_hour)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f'</span><span class="sc">{</span>var_name<span class="sc">}</span><span class="ss"> at hour '</span><span class="op">+</span><span class="bu">str</span>(hour))</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.colorbar()</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># only show every latitude and longitude of end points</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># round to 2 decimal places</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    top<span class="op">=</span>latitudes[<span class="dv">0</span>]</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    top<span class="op">=</span><span class="bu">round</span>(top,<span class="dv">2</span>) </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    bottom<span class="op">=</span>latitudes[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    bottom<span class="op">=</span><span class="bu">round</span>(bottom,<span class="dv">2</span>)</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    left<span class="op">=</span>longitudes[<span class="dv">0</span>]</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    left<span class="op">=</span><span class="bu">round</span>(left,<span class="dv">2</span>)</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    right<span class="op">=</span>longitudes[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    right<span class="op">=</span><span class="bu">round</span>(right,<span class="dv">2</span>)</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    plt.xticks([<span class="dv">0</span>,<span class="dv">79</span>],[left,right])</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Longitude'</span>)</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    plt.yticks([<span class="dv">0</span>,<span class="dv">79</span>],[top,bottom])</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Latitude'</span>)</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.savefig(f'plots/120/{var_name}_{day}.png')</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.close()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory Data Analysis</h1>
<section id="visualizing-96-hr-files" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-96-hr-files">Visualizing 96 hr files</h2>
<div id="cell-9" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_96 <span class="op">=</span> xr.open_dataset(<span class="st">'data/camxmet2d.delhi.20230717.96hours.nc'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data_96_df <span class="op">=</span> data_96.to_dataframe().reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-10" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_96</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:     (TSTEP: 96, VAR: 14, DATE-TIME: 2, LAY: 1, ROW: 80, COL: 80)
Dimensions without coordinates: TSTEP, VAR, DATE-TIME, LAY, ROW, COL
Data variables: (12/15)
    TFLAG       (TSTEP, VAR, DATE-TIME) int32 2023198 0 ... 2023201 230000
    TSURF_K     (TSTEP, LAY, ROW, COL) float32 302.3 302.3 302.3 ... 300.6 301.2
    SNOWEW_M    (TSTEP, LAY, ROW, COL) float32 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0
    SNOWAGE_HR  (TSTEP, LAY, ROW, COL) float32 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0
    PRATE_MMpH  (TSTEP, LAY, ROW, COL) float32 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0
    CLOUD_OD    (TSTEP, LAY, ROW, COL) float32 62.24 61.67 61.1 ... 37.1 36.78
    ...          ...
    SWSFC_WpM2  (TSTEP, LAY, ROW, COL) float32 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0
    SOLM_M3pM3  (TSTEP, LAY, ROW, COL) float32 0.3131 0.3114 ... 0.3278 0.3292
    CLDTOP_KM   (TSTEP, LAY, ROW, COL) float32 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0
    CAPE        (TSTEP, LAY, ROW, COL) float32 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0
    PBL_WRF_M   (TSTEP, LAY, ROW, COL) float32 17.21 17.21 17.21 ... 94.4 120.0
    PBL_YSU_M   (TSTEP, LAY, ROW, COL) float32 17.21 17.21 17.21 ... 64.43 94.71
Attributes: (12/33)
    IOAPI_VERSION:  $Id: @(#) ioapi library version 3.0 $                    ...
    EXEC_ID:        ????????????????                                         ...
    FTYPE:          1
    CDATE:          2023198
    CTIME:          73941
    WDATE:          2023198
    ...             ...
    VGLVLS:         [0. 0.]
    GDNAM:          ????????????????
    UPNAM:          CAMx2IOAPI      
    VAR-LIST:       TSURF_K         SNOWEW_M        SNOWAGE_HR      PRATE_MMp...
    FILEDESC:       I/O API formatted CAMx AVRG output                       ...
    HISTORY:        </pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-18efa3c0-582b-4ecd-9fa8-10e5a242d197" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-18efa3c0-582b-4ecd-9fa8-10e5a242d197" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span>TSTEP</span>: 96</li><li><span>VAR</span>: 14</li><li><span>DATE-TIME</span>: 2</li><li><span>LAY</span>: 1</li><li><span>ROW</span>: 80</li><li><span>COL</span>: 80</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-cd67a78f-c112-4829-bd09-e15d76b399d2" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-cd67a78f-c112-4829-bd09-e15d76b399d2" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-898e5c1a-c6b8-4a43-8fe1-afc1d605d8be" class="xr-section-summary-in" type="checkbox"><label for="section-898e5c1a-c6b8-4a43-8fe1-afc1d605d8be" class="xr-section-summary">Data variables: <span>(15)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>TFLAG</span></div><div class="xr-var-dims">(TSTEP, VAR, DATE-TIME)</div><div class="xr-var-dtype">int32</div><div class="xr-var-preview xr-preview">2023198 0 ... 2023201 230000</div><input id="attrs-5b5c8f8e-4ad1-4ff2-be46-ae8c9f1d8ab9" class="xr-var-attrs-in" type="checkbox"><label for="attrs-5b5c8f8e-4ad1-4ff2-be46-ae8c9f1d8ab9" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d4722ae2-6905-4a71-a5b1-3d67a6979563" class="xr-var-data-in" type="checkbox"><label for="data-d4722ae2-6905-4a71-a5b1-3d67a6979563" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>&lt;YYYYDDD,HHMMSS&gt;</dd><dt><span>long_name :</span></dt><dd>TFLAG           </dd><dt><span>var_desc :</span></dt><dd>Timestep-valid flags:  (1) YYYYDDD or (2) HHMMSS                                </dd></dl></div><div class="xr-var-data"><pre>array([[[2023198,       0],
        [2023198,       0],
        ...,
        [2023198,       0],
        [2023198,       0]],

       [[2023198,   10000],
        [2023198,   10000],
        ...,
        [2023198,   10000],
        [2023198,   10000]],

       ...,

       [[2023201,  220000],
        [2023201,  220000],
        ...,
        [2023201,  220000],
        [2023201,  220000]],

       [[2023201,  230000],
        [2023201,  230000],
        ...,
        [2023201,  230000],
        [2023201,  230000]]], dtype=int32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>TSURF_K</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">302.3 302.3 302.3 ... 300.6 301.2</div><input id="attrs-dd1f4ed6-b0d0-48f6-ba94-e44794c999f2" class="xr-var-attrs-in" type="checkbox"><label for="attrs-dd1f4ed6-b0d0-48f6-ba94-e44794c999f2" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3f3bc55f-c6d2-4914-acb3-66a64fca9f40" class="xr-var-data-in" type="checkbox"><label for="data-3f3bc55f-c6d2-4914-acb3-66a64fca9f40" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>TSURF_K         </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE TSURF_K                                                                </dd></dl></div><div class="xr-var-data"><pre>array([[[[302.31464, ..., 301.9288 ],
         ...,
         [301.28806, ..., 301.65118]]],


       ...,


       [[[299.001  , ..., 299.86826],
         ...,
         [299.08127, ..., 301.1575 ]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>SNOWEW_M</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id="attrs-077a61d6-d268-4e78-9c51-c32a80316f72" class="xr-var-attrs-in" type="checkbox"><label for="attrs-077a61d6-d268-4e78-9c51-c32a80316f72" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-fb990580-7fc9-4209-b7ff-172a52ec7534" class="xr-var-data-in" type="checkbox"><label for="data-fb990580-7fc9-4209-b7ff-172a52ec7534" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>SNOWEW_M        </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE SNOWEW_M                                                               </dd></dl></div><div class="xr-var-data"><pre>array([[[[0., ..., 0.],
         ...,
         [0., ..., 0.]]],


       ...,


       [[[0., ..., 0.],
         ...,
         [0., ..., 0.]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>SNOWAGE_HR</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id="attrs-8c7cc109-5432-47ad-b527-cb57765f344f" class="xr-var-attrs-in" type="checkbox"><label for="attrs-8c7cc109-5432-47ad-b527-cb57765f344f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ebbb7f10-d6ac-4122-99cd-5b5b0d64ee8f" class="xr-var-data-in" type="checkbox"><label for="data-ebbb7f10-d6ac-4122-99cd-5b5b0d64ee8f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>SNOWAGE_HR      </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE SNOWAGE_HR                                                             </dd></dl></div><div class="xr-var-data"><pre>array([[[[0., ..., 0.],
         ...,
         [0., ..., 0.]]],


       ...,


       [[[0., ..., 0.],
         ...,
         [0., ..., 0.]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>PRATE_MMpH</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id="attrs-f4ce6126-e130-48c7-b48a-667a9cfeeff5" class="xr-var-attrs-in" type="checkbox"><label for="attrs-f4ce6126-e130-48c7-b48a-667a9cfeeff5" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-2541ecc1-ab12-4c2f-9c29-b0d9845314e3" class="xr-var-data-in" type="checkbox"><label for="data-2541ecc1-ab12-4c2f-9c29-b0d9845314e3" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>PRATE_MMpH      </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE PRATE_MMpH                                                             </dd></dl></div><div class="xr-var-data"><pre>array([[[[0., ..., 0.],
         ...,
         [0., ..., 0.]]],


       ...,


       [[[0., ..., 0.],
         ...,
         [0., ..., 0.]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>CLOUD_OD</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">62.24 61.67 61.1 ... 37.1 36.78</div><input id="attrs-7d5afbd7-676c-42fa-8439-febf3a13b2e2" class="xr-var-attrs-in" type="checkbox"><label for="attrs-7d5afbd7-676c-42fa-8439-febf3a13b2e2" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5c96eb9e-a444-4d76-9b20-541046eaf3b7" class="xr-var-data-in" type="checkbox"><label for="data-5c96eb9e-a444-4d76-9b20-541046eaf3b7" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>CLOUD_OD        </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE CLOUD_OD                                                               </dd></dl></div><div class="xr-var-data"><pre>array([[[[62.239326, ..., 30.003962],
         ...,
         [54.13987 , ..., 43.78004 ]]],


       ...,


       [[[29.166183, ..., 58.07322 ],
         ...,
         [32.563763, ..., 36.776646]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>U10_MpS</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">1.63 1.585 1.54 ... 0.8064 0.8805</div><input id="attrs-468a3206-2b3e-48d8-afa4-ae18bcd19d54" class="xr-var-attrs-in" type="checkbox"><label for="attrs-468a3206-2b3e-48d8-afa4-ae18bcd19d54" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-4e5f7f83-771d-426e-8803-5b2c79adfcab" class="xr-var-data-in" type="checkbox"><label for="data-4e5f7f83-771d-426e-8803-5b2c79adfcab" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>U10_MpS         </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE U10_MpS                                                                </dd></dl></div><div class="xr-var-data"><pre>array([[[[ 1.630373, ..., -0.434344],
         ...,
         [-0.544169, ..., -2.070899]]],


       ...,


       [[[ 0.569056, ...,  0.423629],
         ...,
         [ 0.774855, ...,  0.880477]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>V10_MpS</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">0.1487 0.158 ... -1.202 -1.152</div><input id="attrs-16dc3216-e129-459c-832f-8c35c018ab29" class="xr-var-attrs-in" type="checkbox"><label for="attrs-16dc3216-e129-459c-832f-8c35c018ab29" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b27b7742-99b5-4549-b303-780abae2ce46" class="xr-var-data-in" type="checkbox"><label for="data-b27b7742-99b5-4549-b303-780abae2ce46" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>V10_MpS         </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE V10_MpS                                                                </dd></dl></div><div class="xr-var-data"><pre>array([[[[ 0.148722, ...,  0.630212],
         ...,
         [-0.328182, ...,  0.625002]]],


       ...,


       [[[ 0.040896, ..., -1.492097],
         ...,
         [-0.365465, ..., -1.152316]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>T2_K</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">302.6 302.6 302.6 ... 300.4 300.8</div><input id="attrs-847006e0-bcf3-4767-a309-6800dabbbdc2" class="xr-var-attrs-in" type="checkbox"><label for="attrs-847006e0-bcf3-4767-a309-6800dabbbdc2" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b44cbe17-765f-43fd-97e9-43d0830aa3ba" class="xr-var-data-in" type="checkbox"><label for="data-b44cbe17-765f-43fd-97e9-43d0830aa3ba" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>T2_K            </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE T2_K                                                                   </dd></dl></div><div class="xr-var-data"><pre>array([[[[302.57184, ..., 302.88318],
         ...,
         [301.1836 , ..., 302.19128]]],


       ...,


       [[[299.17767, ..., 300.1615 ],
         ...,
         [299.30466, ..., 300.77878]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>SWSFC_WpM2</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id="attrs-a14407c4-0b55-4673-a7c7-1689050a2cc5" class="xr-var-attrs-in" type="checkbox"><label for="attrs-a14407c4-0b55-4673-a7c7-1689050a2cc5" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-df9f3217-4a6b-4d9f-90c0-a7bd1b2694d3" class="xr-var-data-in" type="checkbox"><label for="data-df9f3217-4a6b-4d9f-90c0-a7bd1b2694d3" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>SWSFC_WpM2      </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE SWSFC_WpM2                                                             </dd></dl></div><div class="xr-var-data"><pre>array([[[[0., ..., 0.],
         ...,
         [0., ..., 0.]]],


       ...,


       [[[0., ..., 0.],
         ...,
         [0., ..., 0.]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>SOLM_M3pM3</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">0.3131 0.3114 ... 0.3278 0.3292</div><input id="attrs-bb30f667-16ab-4af2-a23b-babc62bf2db3" class="xr-var-attrs-in" type="checkbox"><label for="attrs-bb30f667-16ab-4af2-a23b-babc62bf2db3" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-3c860109-d9ac-4b25-852d-2ea228add1df" class="xr-var-data-in" type="checkbox"><label for="data-3c860109-d9ac-4b25-852d-2ea228add1df" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>SOLM_M3pM3      </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE SOLM_M3pM3                                                             </dd></dl></div><div class="xr-var-data"><pre>array([[[[0.313128, ..., 0.271955],
         ...,
         [0.306425, ..., 0.287092]]],


       ...,


       [[[0.312972, ..., 0.263079],
         ...,
         [0.29241 , ..., 0.32918 ]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>CLDTOP_KM</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id="attrs-3d05e78f-7042-400d-83d1-dc5053845837" class="xr-var-attrs-in" type="checkbox"><label for="attrs-3d05e78f-7042-400d-83d1-dc5053845837" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-01fbebc1-21c4-419d-b9b6-77657bc94e72" class="xr-var-data-in" type="checkbox"><label for="data-01fbebc1-21c4-419d-b9b6-77657bc94e72" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>CLDTOP_KM       </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE CLDTOP_KM                                                              </dd></dl></div><div class="xr-var-data"><pre>array([[[[0., ..., 0.],
         ...,
         [0., ..., 0.]]],


       ...,


       [[[0., ..., 0.],
         ...,
         [0., ..., 0.]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>CAPE</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id="attrs-f15642b5-e840-49af-9852-7a85a5192908" class="xr-var-attrs-in" type="checkbox"><label for="attrs-f15642b5-e840-49af-9852-7a85a5192908" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-110bf01d-b159-4125-8be3-0cce91506a4d" class="xr-var-data-in" type="checkbox"><label for="data-110bf01d-b159-4125-8be3-0cce91506a4d" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>CAPE            </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE CAPE                                                                   </dd></dl></div><div class="xr-var-data"><pre>array([[[[0., ..., 0.],
         ...,
         [0., ..., 0.]]],


       ...,


       [[[0., ..., 0.],
         ...,
         [0., ..., 0.]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>PBL_WRF_M</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">17.21 17.21 17.21 ... 94.4 120.0</div><input id="attrs-fc80f450-69e8-4656-8020-b169af29f6c7" class="xr-var-attrs-in" type="checkbox"><label for="attrs-fc80f450-69e8-4656-8020-b169af29f6c7" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8d6709fe-c0e5-4195-b74f-148ea917e4c6" class="xr-var-data-in" type="checkbox"><label for="data-8d6709fe-c0e5-4195-b74f-148ea917e4c6" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>PBL_WRF_M       </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE PBL_WRF_M                                                              </dd></dl></div><div class="xr-var-data"><pre>array([[[[ 17.212452, ...,  17.253763],
         ...,
         [ 17.153704, ...,  17.189987]]],


       ...,


       [[[ 33.101303, ...,  30.475212],
         ...,
         [ 24.450672, ..., 120.012794]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>PBL_YSU_M</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">17.21 17.21 17.21 ... 64.43 94.71</div><input id="attrs-a0f2fbf6-1e83-4f7d-a9e7-ccb0be57a3ad" class="xr-var-attrs-in" type="checkbox"><label for="attrs-a0f2fbf6-1e83-4f7d-a9e7-ccb0be57a3ad" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6524361e-f709-4afd-85de-c648f1b46ec5" class="xr-var-data-in" type="checkbox"><label for="data-6524361e-f709-4afd-85de-c648f1b46ec5" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>PBL_YSU_M       </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE PBL_YSU_M                                                              </dd></dl></div><div class="xr-var-data"><pre>array([[[[17.212452, ..., 17.253763],
         ...,
         [17.153704, ..., 17.189987]]],


       ...,


       [[[17.060207, ..., 17.152937],
         ...,
         [17.07223 , ..., 94.71051 ]]]], dtype=float32)</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-52017f9e-61ef-4b3f-b821-96b88dbb719b" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-52017f9e-61ef-4b3f-b821-96b88dbb719b" class="xr-section-summary" title="Expand/collapse section">Indexes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-eca7ea67-f310-41a6-914f-bffc8d7b1293" class="xr-section-summary-in" type="checkbox"><label for="section-eca7ea67-f310-41a6-914f-bffc8d7b1293" class="xr-section-summary">Attributes: <span>(33)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>IOAPI_VERSION :</span></dt><dd>$Id: @(#) ioapi library version 3.0 $                                           </dd><dt><span>EXEC_ID :</span></dt><dd>????????????????                                                                </dd><dt><span>FTYPE :</span></dt><dd>1</dd><dt><span>CDATE :</span></dt><dd>2023198</dd><dt><span>CTIME :</span></dt><dd>73941</dd><dt><span>WDATE :</span></dt><dd>2023198</dd><dt><span>WTIME :</span></dt><dd>73941</dd><dt><span>SDATE :</span></dt><dd>2023198</dd><dt><span>STIME :</span></dt><dd>0</dd><dt><span>TSTEP :</span></dt><dd>10000</dd><dt><span>NTHIK :</span></dt><dd>1</dd><dt><span>NCOLS :</span></dt><dd>80</dd><dt><span>NROWS :</span></dt><dd>80</dd><dt><span>NLAYS :</span></dt><dd>1</dd><dt><span>NVARS :</span></dt><dd>14</dd><dt><span>GDTYP :</span></dt><dd>1</dd><dt><span>P_ALP :</span></dt><dd>0.0</dd><dt><span>P_BET :</span></dt><dd>0.0</dd><dt><span>P_GAM :</span></dt><dd>0.0</dd><dt><span>XCENT :</span></dt><dd>0.0</dd><dt><span>YCENT :</span></dt><dd>0.0</dd><dt><span>XORIG :</span></dt><dd>76.8499984741211</dd><dt><span>YORIG :</span></dt><dd>28.200000762939453</dd><dt><span>XCELL :</span></dt><dd>0.009999999776482582</dd><dt><span>YCELL :</span></dt><dd>0.009999999776482582</dd><dt><span>VGTYP :</span></dt><dd>-9999</dd><dt><span>VGTOP :</span></dt><dd>-9.999e+36</dd><dt><span>VGLVLS :</span></dt><dd>[0. 0.]</dd><dt><span>GDNAM :</span></dt><dd>????????????????</dd><dt><span>UPNAM :</span></dt><dd>CAMx2IOAPI      </dd><dt><span>VAR-LIST :</span></dt><dd>TSURF_K         SNOWEW_M        SNOWAGE_HR      PRATE_MMpH      CLOUD_OD        U10_MpS         V10_MpS         T2_K            SWSFC_WpM2      SOLM_M3pM3      CLDTOP_KM       CAPE            PBL_WRF_M       PBL_YSU_M       </dd><dt><span>FILEDESC :</span></dt><dd>I/O API formatted CAMx AVRG output                                              </dd><dt><span>HISTORY :</span></dt><dd></dd></dl></div></li></ul></div></div>
</div>
</div>
<div id="cell-11" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_96_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TSTEP</th>
<th data-quarto-table-cell-role="th">VAR</th>
<th data-quarto-table-cell-role="th">DATE-TIME</th>
<th data-quarto-table-cell-role="th">LAY</th>
<th data-quarto-table-cell-role="th">ROW</th>
<th data-quarto-table-cell-role="th">COL</th>
<th data-quarto-table-cell-role="th">TFLAG</th>
<th data-quarto-table-cell-role="th">TSURF_K</th>
<th data-quarto-table-cell-role="th">SNOWEW_M</th>
<th data-quarto-table-cell-role="th">SNOWAGE_HR</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">CLOUD_OD</th>
<th data-quarto-table-cell-role="th">U10_MpS</th>
<th data-quarto-table-cell-role="th">V10_MpS</th>
<th data-quarto-table-cell-role="th">T2_K</th>
<th data-quarto-table-cell-role="th">SWSFC_WpM2</th>
<th data-quarto-table-cell-role="th">SOLM_M3pM3</th>
<th data-quarto-table-cell-role="th">CLDTOP_KM</th>
<th data-quarto-table-cell-role="th">CAPE</th>
<th data-quarto-table-cell-role="th">PBL_WRF_M</th>
<th data-quarto-table-cell-role="th">PBL_YSU_M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2023198</td>
<td>302.314636</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>62.239326</td>
<td>1.630373</td>
<td>0.148722</td>
<td>302.571838</td>
<td>0.0</td>
<td>0.313128</td>
<td>0.0</td>
<td>0.0</td>
<td>17.212452</td>
<td>17.212452</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>2023198</td>
<td>302.312042</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>61.671093</td>
<td>1.585281</td>
<td>0.158011</td>
<td>302.584351</td>
<td>0.0</td>
<td>0.311416</td>
<td>0.0</td>
<td>0.0</td>
<td>17.212652</td>
<td>17.212652</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>2023198</td>
<td>302.309479</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>61.102859</td>
<td>1.540188</td>
<td>0.167299</td>
<td>302.596832</td>
<td>0.0</td>
<td>0.309703</td>
<td>0.0</td>
<td>0.0</td>
<td>17.212852</td>
<td>17.212852</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>3</td>
<td>2023198</td>
<td>302.306885</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>60.534630</td>
<td>1.495095</td>
<td>0.176587</td>
<td>302.609344</td>
<td>0.0</td>
<td>0.307990</td>
<td>0.0</td>
<td>0.0</td>
<td>17.213055</td>
<td>17.213055</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>2023198</td>
<td>302.303558</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>59.912636</td>
<td>1.450304</td>
<td>0.184773</td>
<td>302.621948</td>
<td>0.0</td>
<td>0.306286</td>
<td>0.0</td>
<td>0.0</td>
<td>17.213356</td>
<td>17.213356</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17203195</td>
<td>95</td>
<td>13</td>
<td>1</td>
<td>0</td>
<td>79</td>
<td>75</td>
<td>230000</td>
<td>298.979095</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>37.972748</td>
<td>0.600130</td>
<td>-1.341342</td>
<td>299.389465</td>
<td>0.0</td>
<td>0.324286</td>
<td>0.0</td>
<td>0.0</td>
<td>26.661556</td>
<td>17.082989</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17203196</td>
<td>95</td>
<td>13</td>
<td>1</td>
<td>0</td>
<td>79</td>
<td>76</td>
<td>230000</td>
<td>299.372223</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>37.747482</td>
<td>0.658128</td>
<td>-1.301898</td>
<td>299.638062</td>
<td>0.0</td>
<td>0.324927</td>
<td>0.0</td>
<td>0.0</td>
<td>43.123440</td>
<td>17.094244</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17203197</td>
<td>95</td>
<td>13</td>
<td>1</td>
<td>0</td>
<td>79</td>
<td>77</td>
<td>230000</td>
<td>299.967468</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>37.423786</td>
<td>0.732263</td>
<td>-1.252025</td>
<td>300.018402</td>
<td>0.0</td>
<td>0.326345</td>
<td>0.0</td>
<td>0.0</td>
<td>68.759804</td>
<td>17.112419</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17203198</td>
<td>95</td>
<td>13</td>
<td>1</td>
<td>0</td>
<td>79</td>
<td>78</td>
<td>230000</td>
<td>300.562744</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>37.100090</td>
<td>0.806398</td>
<td>-1.202152</td>
<td>300.398743</td>
<td>0.0</td>
<td>0.327763</td>
<td>0.0</td>
<td>0.0</td>
<td>94.396065</td>
<td>64.426094</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17203199</td>
<td>95</td>
<td>13</td>
<td>1</td>
<td>0</td>
<td>79</td>
<td>79</td>
<td>230000</td>
<td>301.157501</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>36.776646</td>
<td>0.880477</td>
<td>-1.152316</td>
<td>300.778778</td>
<td>0.0</td>
<td>0.329180</td>
<td>0.0</td>
<td>0.0</td>
<td>120.012794</td>
<td>94.710510</td>
</tr>
</tbody>
</table>

<p>17203200 rows × 21 columns</p>
</div>
</div>
</div>
<div id="cell-12" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data_96_df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['TSTEP', 'VAR', 'DATE-TIME', 'LAY', 'ROW', 'COL', 'TFLAG', 'TSURF_K',
       'SNOWEW_M', 'SNOWAGE_HR', 'PRATE_MMpH', 'CLOUD_OD', 'U10_MpS',
       'V10_MpS', 'T2_K', 'SWSFC_WpM2', 'SOLM_M3pM3', 'CLDTOP_KM', 'CAPE',
       'PBL_WRF_M', 'PBL_YSU_M'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-13" class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data_96[<span class="st">'U10_MpS'</span>] <span class="co">#shape (96, 1, 80, 80)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'U10_MpS' (TSTEP: 96, LAY: 1, ROW: 80, COL: 80)&gt;
array([[[[ 1.630373, ..., -0.434344],
         ...,
         [-0.544169, ..., -2.070899]]],


       ...,


       [[[ 0.569056, ...,  0.423629],
         ...,
         [ 0.774855, ...,  0.880477]]]], dtype=float32)
Dimensions without coordinates: TSTEP, LAY, ROW, COL
Attributes:
    long_name:  U10_MpS         
    units:      ppmV            
    var_desc:   VARIABLE U10_MpS                                             ...</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.DataArray</div><div class="xr-array-name">'U10_MpS'</div><ul class="xr-dim-list"><li><span>TSTEP</span>: 96</li><li><span>LAY</span>: 1</li><li><span>ROW</span>: 80</li><li><span>COL</span>: 80</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input id="section-085cc97d-6f7a-4496-b28e-7eb2f5cf5e4b" class="xr-array-in" type="checkbox" checked=""><label for="section-085cc97d-6f7a-4496-b28e-7eb2f5cf5e4b" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>1.63 1.585 1.54 1.495 1.45 ... 0.6001 0.6581 0.7323 0.8064 0.8805</span></div><div class="xr-array-data"><pre>array([[[[ 1.630373, ..., -0.434344],
         ...,
         [-0.544169, ..., -2.070899]]],


       ...,


       [[[ 0.569056, ...,  0.423629],
         ...,
         [ 0.774855, ...,  0.880477]]]], dtype=float32)</pre></div></div></li><li class="xr-section-item"><input id="section-a9c67cc9-f0ab-45d1-a319-1270ba210638" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-a9c67cc9-f0ab-45d1-a319-1270ba210638" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-08116eee-4b1f-4da7-a683-184b1ea0796d" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-08116eee-4b1f-4da7-a683-184b1ea0796d" class="xr-section-summary" title="Expand/collapse section">Indexes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-2946039e-2dab-4633-9b78-1324a5ef09da" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-2946039e-2dab-4633-9b78-1324a5ef09da" class="xr-section-summary">Attributes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>U10_MpS         </dd><dt><span>units :</span></dt><dd>ppmV            </dd><dt><span>var_desc :</span></dt><dd>VARIABLE U10_MpS                                                                </dd></dl></div></li></ul></div></div>
</div>
</div>
<div id="cell-14" class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data_96[<span class="st">'U10_MpS'</span>].shape , data_96[<span class="st">'U10_MpS'</span>][<span class="st">'TSTEP'</span><span class="op">==</span><span class="dv">0</span>].shape, data_96[<span class="st">'U10_MpS'</span>][<span class="st">'TSTEP'</span><span class="op">==</span><span class="dv">0</span>][<span class="dv">0</span>].shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>((96, 1, 80, 80), (1, 80, 80), (80, 80))</code></pre>
</div>
</div>
<div id="cell-15" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(data_96[<span class="st">'U10_MpS'</span>][<span class="st">'TSTEP'</span><span class="op">==</span><span class="dv">0</span>][<span class="dv">0</span>]) <span class="co">#shape (80, 80)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f76abc7cf70&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-11-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="Autoencoder_files/figure-html/cell-11-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>create_plot(data <span class="op">=</span> data_96, hour <span class="op">=</span> <span class="dv">1</span>, var_name <span class="op">=</span> <span class="st">'U10_MpS'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-12-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="Autoencoder_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualizing-120-hr-files" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-120-hr-files">Visualizing 120 hr files</h2>
<div id="cell-18" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_120 <span class="op">=</span> xr.open_dataset(<span class="st">'data/camx120hr_merged_20230717.nc'</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>data_120_df <span class="op">=</span> data_120.to_dataframe().reset_index() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-19" class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data_120 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:  (TSTEP: 120, LAY: 1, ROW: 80, COL: 80, VAR: 9, DATE-TIME: 2)
Dimensions without coordinates: TSTEP, LAY, ROW, COL, VAR, DATE-TIME
Data variables:
    P10      (TSTEP, LAY, ROW, COL) float32 23.86 23.86 24.07 ... 10.1 10.1
    P25      (TSTEP, LAY, ROW, COL) float32 19.24 19.24 19.62 ... 9.63 9.63
    TFLAG    (TSTEP, VAR, DATE-TIME) int32 2023197 0 2023197 ... 2023201 230000
Attributes: (12/34)
    IOAPI_VERSION:  $Id: @(#) ioapi library version 3.0 $                    ...
    EXEC_ID:        ????????????????                                         ...
    FTYPE:          1
    CDATE:          2023197
    CTIME:          83911
    WDATE:          2023197
    ...             ...
    GDNAM:          ????????????????
    UPNAM:          CAMXMETOU       
    VAR-LIST:       P10             P25             
    FILEDESC:       I/O API formatted CAMx AVRG output                       ...
    HISTORY:        Mon Jul 17 08:45:22 2023: ncrcat camxout.2023.07.16.nc ca...
    NCO:            netCDF Operators version 4.9.1 (Homepage = http://nco.sf....</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-740e5d34-011a-4d63-aa2a-691931ebb3e8" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-740e5d34-011a-4d63-aa2a-691931ebb3e8" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span>TSTEP</span>: 120</li><li><span>LAY</span>: 1</li><li><span>ROW</span>: 80</li><li><span>COL</span>: 80</li><li><span>VAR</span>: 9</li><li><span>DATE-TIME</span>: 2</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-7c3a8202-9fdd-4104-9ec0-b4326966912e" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-7c3a8202-9fdd-4104-9ec0-b4326966912e" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-019325b9-c458-4610-a473-67963dfc2aa5" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-019325b9-c458-4610-a473-67963dfc2aa5" class="xr-section-summary">Data variables: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>P10</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">23.86 23.86 24.07 ... 10.1 10.1</div><input id="attrs-7ab4d7f0-d464-4fc0-981b-b40d84cf5198" class="xr-var-attrs-in" type="checkbox"><label for="attrs-7ab4d7f0-d464-4fc0-981b-b40d84cf5198" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-fef3217d-c771-471b-a095-2dfcc689b7de" class="xr-var-data-in" type="checkbox"><label for="data-fef3217d-c771-471b-a095-2dfcc689b7de" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>CPRM            </dd><dt><span>units :</span></dt><dd>micrograms/m**3 </dd><dt><span>var_desc :</span></dt><dd>VARIABLE CPRM                                                                   </dd></dl></div><div class="xr-var-data"><pre>array([[[[23.857107, ..., 28.82367 ],
         ...,
         [34.902046, ..., 18.506985]]],


       ...,


       [[[38.434433, ..., 22.536842],
         ...,
         [20.921093, ..., 10.097546]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>P25</span></div><div class="xr-var-dims">(TSTEP, LAY, ROW, COL)</div><div class="xr-var-dtype">float32</div><div class="xr-var-preview xr-preview">19.24 19.24 19.62 ... 9.63 9.63</div><input id="attrs-d2787dcf-2123-4b35-bbb0-57bb3968eda5" class="xr-var-attrs-in" type="checkbox"><label for="attrs-d2787dcf-2123-4b35-bbb0-57bb3968eda5" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-7e5743ed-6da0-4ac3-ac63-89f842737dab" class="xr-var-data-in" type="checkbox"><label for="data-7e5743ed-6da0-4ac3-ac63-89f842737dab" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>FPRM            </dd><dt><span>units :</span></dt><dd>micrograms/m**3 </dd><dt><span>var_desc :</span></dt><dd>VARIABLE FPRM                                                                   </dd></dl></div><div class="xr-var-data"><pre>array([[[[19.240587, ..., 26.00578 ],
         ...,
         [31.570122, ..., 17.510971]]],


       ...,


       [[[22.36091 , ..., 16.678066],
         ...,
         [18.63693 , ...,  9.629862]]]], dtype=float32)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>TFLAG</span></div><div class="xr-var-dims">(TSTEP, VAR, DATE-TIME)</div><div class="xr-var-dtype">int32</div><div class="xr-var-preview xr-preview">2023197 0 ... 2023201 230000</div><input id="attrs-4172f445-f206-4a6a-9d18-01b3545bf806" class="xr-var-attrs-in" type="checkbox"><label for="attrs-4172f445-f206-4a6a-9d18-01b3545bf806" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-e257699f-5785-465f-b12d-33f6defe64a8" class="xr-var-data-in" type="checkbox"><label for="data-e257699f-5785-465f-b12d-33f6defe64a8" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>units :</span></dt><dd>&lt;YYYYDDD,HHMMSS&gt;</dd><dt><span>long_name :</span></dt><dd>TFLAG           </dd><dt><span>var_desc :</span></dt><dd>Timestep-valid flags:  (1) YYYYDDD or (2) HHMMSS                                </dd></dl></div><div class="xr-var-data"><pre>array([[[2023197,       0],
        [2023197,       0],
        ...,
        [2023197,       0],
        [2023197,       0]],

       [[2023197,   10000],
        [2023197,   10000],
        ...,
        [2023197,   10000],
        [2023197,   10000]],

       ...,

       [[2023201,  220000],
        [2023201,  220000],
        ...,
        [2023201,  220000],
        [2023201,  220000]],

       [[2023201,  230000],
        [2023201,  230000],
        ...,
        [2023201,  230000],
        [2023201,  230000]]], dtype=int32)</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-2aa6ad5a-5536-40b1-bf53-4ca9d61c2b33" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-2aa6ad5a-5536-40b1-bf53-4ca9d61c2b33" class="xr-section-summary" title="Expand/collapse section">Indexes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-4f1e8eb1-930e-4a6e-9d7a-a95d55f17bd2" class="xr-section-summary-in" type="checkbox"><label for="section-4f1e8eb1-930e-4a6e-9d7a-a95d55f17bd2" class="xr-section-summary">Attributes: <span>(34)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>IOAPI_VERSION :</span></dt><dd>$Id: @(#) ioapi library version 3.0 $                                           </dd><dt><span>EXEC_ID :</span></dt><dd>????????????????                                                                </dd><dt><span>FTYPE :</span></dt><dd>1</dd><dt><span>CDATE :</span></dt><dd>2023197</dd><dt><span>CTIME :</span></dt><dd>83911</dd><dt><span>WDATE :</span></dt><dd>2023197</dd><dt><span>WTIME :</span></dt><dd>83911</dd><dt><span>SDATE :</span></dt><dd>2023197</dd><dt><span>STIME :</span></dt><dd>0</dd><dt><span>TSTEP :</span></dt><dd>10000</dd><dt><span>NTHIK :</span></dt><dd>1</dd><dt><span>NCOLS :</span></dt><dd>80</dd><dt><span>NROWS :</span></dt><dd>80</dd><dt><span>NLAYS :</span></dt><dd>1</dd><dt><span>NVARS :</span></dt><dd>2</dd><dt><span>GDTYP :</span></dt><dd>1</dd><dt><span>P_ALP :</span></dt><dd>0.0</dd><dt><span>P_BET :</span></dt><dd>0.0</dd><dt><span>P_GAM :</span></dt><dd>0.0</dd><dt><span>XCENT :</span></dt><dd>0.0</dd><dt><span>YCENT :</span></dt><dd>0.0</dd><dt><span>XORIG :</span></dt><dd>76.8499984741211</dd><dt><span>YORIG :</span></dt><dd>28.200000762939453</dd><dt><span>XCELL :</span></dt><dd>0.009999999776482582</dd><dt><span>YCELL :</span></dt><dd>0.009999999776482582</dd><dt><span>VGTYP :</span></dt><dd>-9999</dd><dt><span>VGTOP :</span></dt><dd>-9.999e+36</dd><dt><span>VGLVLS :</span></dt><dd>[0. 0.]</dd><dt><span>GDNAM :</span></dt><dd>????????????????</dd><dt><span>UPNAM :</span></dt><dd>CAMXMETOU       </dd><dt><span>VAR-LIST :</span></dt><dd>P10             P25             </dd><dt><span>FILEDESC :</span></dt><dd>I/O API formatted CAMx AVRG output                                              </dd><dt><span>HISTORY :</span></dt><dd>Mon Jul 17 08:45:22 2023: ncrcat camxout.2023.07.16.nc camxout.2023.07.17.nc camxout.2023.07.18.nc camxout.2023.07.19.nc camxout.2023.07.20.nc camx120hr.nc
</dd><dt><span>NCO :</span></dt><dd>netCDF Operators version 4.9.1 (Homepage = http://nco.sf.net, Code = http://github.com/nco/nco)</dd></dl></div></li></ul></div></div>
</div>
</div>
<div id="cell-20" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data_120_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TSTEP</th>
<th data-quarto-table-cell-role="th">LAY</th>
<th data-quarto-table-cell-role="th">ROW</th>
<th data-quarto-table-cell-role="th">COL</th>
<th data-quarto-table-cell-role="th">VAR</th>
<th data-quarto-table-cell-role="th">DATE-TIME</th>
<th data-quarto-table-cell-role="th">P10</th>
<th data-quarto-table-cell-role="th">P25</th>
<th data-quarto-table-cell-role="th">TFLAG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>23.857107</td>
<td>19.240587</td>
<td>2023197</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>23.857107</td>
<td>19.240587</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>23.857107</td>
<td>19.240587</td>
<td>2023197</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>23.857107</td>
<td>19.240587</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>23.857107</td>
<td>19.240587</td>
<td>2023197</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13823995</td>
<td>119</td>
<td>0</td>
<td>79</td>
<td>79</td>
<td>6</td>
<td>1</td>
<td>10.097546</td>
<td>9.629862</td>
<td>230000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13823996</td>
<td>119</td>
<td>0</td>
<td>79</td>
<td>79</td>
<td>7</td>
<td>0</td>
<td>10.097546</td>
<td>9.629862</td>
<td>2023201</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13823997</td>
<td>119</td>
<td>0</td>
<td>79</td>
<td>79</td>
<td>7</td>
<td>1</td>
<td>10.097546</td>
<td>9.629862</td>
<td>230000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13823998</td>
<td>119</td>
<td>0</td>
<td>79</td>
<td>79</td>
<td>8</td>
<td>0</td>
<td>10.097546</td>
<td>9.629862</td>
<td>2023201</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13823999</td>
<td>119</td>
<td>0</td>
<td>79</td>
<td>79</td>
<td>8</td>
<td>1</td>
<td>10.097546</td>
<td>9.629862</td>
<td>230000</td>
</tr>
</tbody>
</table>

<p>13824000 rows × 9 columns</p>
</div>
</div>
</div>
<div id="cell-21" class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data_120_df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TSTEP</th>
<th data-quarto-table-cell-role="th">LAY</th>
<th data-quarto-table-cell-role="th">ROW</th>
<th data-quarto-table-cell-role="th">COL</th>
<th data-quarto-table-cell-role="th">VAR</th>
<th data-quarto-table-cell-role="th">DATE-TIME</th>
<th data-quarto-table-cell-role="th">P10</th>
<th data-quarto-table-cell-role="th">P25</th>
<th data-quarto-table-cell-role="th">TFLAG</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>1.382400e+07</td>
<td>13824000.0</td>
<td>1.382400e+07</td>
<td>1.382400e+07</td>
<td>1.382400e+07</td>
<td>13824000.0</td>
<td>1.382400e+07</td>
<td>1.382400e+07</td>
<td>1.382400e+07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>5.950000e+01</td>
<td>0.0</td>
<td>3.950000e+01</td>
<td>3.950000e+01</td>
<td>4.000000e+00</td>
<td>0.5</td>
<td>4.101470e+01</td>
<td>2.856279e+01</td>
<td>1.069100e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>3.463981e+01</td>
<td>0.0</td>
<td>2.309221e+01</td>
<td>2.309221e+01</td>
<td>2.581989e+00</td>
<td>0.5</td>
<td>2.361775e+01</td>
<td>1.582030e+01</td>
<td>9.553543e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000e+00</td>
<td>0.0</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.000000e+00</td>
<td>0.0</td>
<td>1.111396e+00</td>
<td>8.114247e-01</td>
<td>0.000000e+00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>2.975000e+01</td>
<td>0.0</td>
<td>1.975000e+01</td>
<td>1.975000e+01</td>
<td>2.000000e+00</td>
<td>0.0</td>
<td>2.546643e+01</td>
<td>1.880392e+01</td>
<td>1.175000e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>5.950000e+01</td>
<td>0.0</td>
<td>3.950000e+01</td>
<td>3.950000e+01</td>
<td>4.000000e+00</td>
<td>0.5</td>
<td>3.590978e+01</td>
<td>2.589731e+01</td>
<td>1.126598e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>8.925000e+01</td>
<td>0.0</td>
<td>5.925000e+01</td>
<td>5.925000e+01</td>
<td>6.000000e+00</td>
<td>1.0</td>
<td>5.103806e+01</td>
<td>3.433007e+01</td>
<td>2.023199e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>1.190000e+02</td>
<td>0.0</td>
<td>7.900000e+01</td>
<td>7.900000e+01</td>
<td>8.000000e+00</td>
<td>1.0</td>
<td>6.492913e+02</td>
<td>6.130998e+02</td>
<td>2.023201e+06</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-22" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data_120[<span class="st">'COL'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'COL' (COL: 80)&gt;
array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79])
Dimensions without coordinates: COL</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.DataArray</div><div class="xr-array-name">'COL'</div><ul class="xr-dim-list"><li><span>COL</span>: 80</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input id="section-a3266fcd-3fd4-46f7-be05-e3e92458b8a0" class="xr-array-in" type="checkbox" checked=""><label for="section-a3266fcd-3fd4-46f7-be05-e3e92458b8a0" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>0 1 2 3 4 5 6 7 8 9 10 11 12 ... 68 69 70 71 72 73 74 75 76 77 78 79</span></div><div class="xr-array-data"><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79])</pre></div></div></li><li class="xr-section-item"><input id="section-ca95894f-b1f4-4815-b0dc-9f7b68437e6a" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-ca95894f-b1f4-4815-b0dc-9f7b68437e6a" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-318f7394-d62f-4c1a-9f07-fa1d1cf76b7a" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-318f7394-d62f-4c1a-9f07-fa1d1cf76b7a" class="xr-section-summary" title="Expand/collapse section">Indexes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-64667dc3-b506-436a-9c57-4aa25edcca30" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-64667dc3-b506-436a-9c57-4aa25edcca30" class="xr-section-summary" title="Expand/collapse section">Attributes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"></dl></div></li></ul></div></div>
</div>
</div>
<div id="cell-23" class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data_120[<span class="st">'P10'</span>] <span class="co">#shape (120, 1, 80, 80)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'P10' (TSTEP: 120, LAY: 1, ROW: 80, COL: 80)&gt;
array([[[[23.857107, ..., 28.82367 ],
         ...,
         [34.902046, ..., 18.506985]]],


       ...,


       [[[38.434433, ..., 22.536842],
         ...,
         [20.921093, ..., 10.097546]]]], dtype=float32)
Dimensions without coordinates: TSTEP, LAY, ROW, COL
Attributes:
    long_name:  CPRM            
    units:      micrograms/m**3 
    var_desc:   VARIABLE CPRM                                                ...</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.DataArray</div><div class="xr-array-name">'P10'</div><ul class="xr-dim-list"><li><span>TSTEP</span>: 120</li><li><span>LAY</span>: 1</li><li><span>ROW</span>: 80</li><li><span>COL</span>: 80</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input id="section-1b7bf7b7-1a85-47aa-8744-45074d2b30f0" class="xr-array-in" type="checkbox" checked=""><label for="section-1b7bf7b7-1a85-47aa-8744-45074d2b30f0" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>23.86 23.86 24.07 23.42 22.83 22.56 ... 9.551 9.664 9.808 10.1 10.1</span></div><div class="xr-array-data"><pre>array([[[[23.857107, ..., 28.82367 ],
         ...,
         [34.902046, ..., 18.506985]]],


       ...,


       [[[38.434433, ..., 22.536842],
         ...,
         [20.921093, ..., 10.097546]]]], dtype=float32)</pre></div></div></li><li class="xr-section-item"><input id="section-7e5f5f25-2ebb-42b1-a018-7d164a823429" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-7e5f5f25-2ebb-42b1-a018-7d164a823429" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-e53cea0f-57dd-4ef2-a105-b11af196c5cf" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-e53cea0f-57dd-4ef2-a105-b11af196c5cf" class="xr-section-summary" title="Expand/collapse section">Indexes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-eeeb8b84-8f1f-412d-a0a7-cb5e296c9cca" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-eeeb8b84-8f1f-412d-a0a7-cb5e296c9cca" class="xr-section-summary">Attributes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>CPRM            </dd><dt><span>units :</span></dt><dd>micrograms/m**3 </dd><dt><span>var_desc :</span></dt><dd>VARIABLE CPRM                                                                   </dd></dl></div></li></ul></div></div>
</div>
</div>
<div id="cell-24" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>data_120[<span class="st">'P10'</span>][<span class="st">'TSTEP'</span><span class="op">==</span><span class="dv">1</span>]<span class="co"># shape 1x80x80</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.DataArray 'P10' (LAY: 1, ROW: 80, COL: 80)&gt;
array([[[23.857107, 23.857107, ..., 28.82367 , 28.82367 ],
        [23.857107, 23.857107, ..., 28.82367 , 28.82367 ],
        ...,
        [34.902046, 34.902046, ..., 18.506985, 18.506985],
        [34.902046, 34.902046, ..., 18.506985, 18.506985]]], dtype=float32)
Dimensions without coordinates: LAY, ROW, COL
Attributes:
    long_name:  CPRM            
    units:      micrograms/m**3 
    var_desc:   VARIABLE CPRM                                                ...</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.DataArray</div><div class="xr-array-name">'P10'</div><ul class="xr-dim-list"><li><span>LAY</span>: 1</li><li><span>ROW</span>: 80</li><li><span>COL</span>: 80</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input id="section-172d2e68-f2f1-4fdc-acdb-ad2d94dd023d" class="xr-array-in" type="checkbox" checked=""><label for="section-172d2e68-f2f1-4fdc-acdb-ad2d94dd023d" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>23.86 23.86 24.07 23.42 22.83 22.56 ... 18.47 18.77 18.69 18.51 18.51</span></div><div class="xr-array-data"><pre>array([[[23.857107, 23.857107, ..., 28.82367 , 28.82367 ],
        [23.857107, 23.857107, ..., 28.82367 , 28.82367 ],
        ...,
        [34.902046, 34.902046, ..., 18.506985, 18.506985],
        [34.902046, 34.902046, ..., 18.506985, 18.506985]]], dtype=float32)</pre></div></div></li><li class="xr-section-item"><input id="section-e4284734-ce26-4acb-9412-914aef79d70a" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-e4284734-ce26-4acb-9412-914aef79d70a" class="xr-section-summary" title="Expand/collapse section">Coordinates: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-265595d1-8e6c-407f-9c9c-6f4f36baffd0" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-265595d1-8e6c-407f-9c9c-6f4f36baffd0" class="xr-section-summary" title="Expand/collapse section">Indexes: <span>(0)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"></ul></div></li><li class="xr-section-item"><input id="section-6b52bd03-6e10-45cc-bcdc-3772aa8356ea" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-6b52bd03-6e10-45cc-bcdc-3772aa8356ea" class="xr-section-summary">Attributes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>long_name :</span></dt><dd>CPRM            </dd><dt><span>units :</span></dt><dd>micrograms/m**3 </dd><dt><span>var_desc :</span></dt><dd>VARIABLE CPRM                                                                   </dd></dl></div></li></ul></div></div>
</div>
</div>
<div id="cell-25" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data_120[<span class="st">'P10'</span>][<span class="st">'TSTEP'</span><span class="op">==</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="co"># shape 80x80</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(data_120[<span class="st">'P25'</span>][<span class="st">'TSTEP'</span><span class="op">==</span><span class="dv">1</span>][<span class="dv">0</span>])<span class="co">#, vmin=0, vmax=100)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f190d573e80&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-20-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="Autoencoder_files/figure-html/cell-20-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-26" class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>create_plot(data_120,<span class="dv">1</span>,<span class="st">'P25'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-21-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="Autoencoder_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="constructing-data" class="level1">
<h1>Constructing data</h1>
<div id="cell-28" class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the folder path where your files are located</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>folder_path <span class="op">=</span> <span class="st">'data/'</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use glob to retrieve all netCDF files in the folder</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>file_pattern <span class="op">=</span> <span class="st">'camx120*.nc'</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>files_120 <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> file_pattern)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># files_120</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>file_pattern <span class="op">=</span> <span class="st">'*96hours.nc'</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>files_96 <span class="op">=</span> glob.glob(folder_path <span class="op">+</span> file_pattern)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># files_96</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-29" class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(files_120))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>files_120.sort()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(files_120[<span class="dv">0</span>], files_120[<span class="op">-</span><span class="dv">1</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>70
data/camx120hr_merged_20230717.nc data/camx120hr_merged_20230924.nc</code></pre>
</div>
</div>
<div id="cell-30" class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(files_96))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>files_96.sort()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(files_96[<span class="dv">0</span>], files_96[<span class="op">-</span><span class="dv">1</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>69
data/camxmet2d.delhi.20230717.96hours.nc data/camxmet2d.delhi.20230924.96hours.nc</code></pre>
</div>
</div>
<p>camx96hr has 20230808 day file missing. so removing it from camx120hr as well ‘data/camx120hr_merged_20230808.nc’</p>
<div id="cell-32" class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>files_120.remove(<span class="st">'data/camx120hr_merged_20230808.nc'</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(files_120) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>69</code></pre>
</div>
</div>
<p>camx96hr file contains 96 hrs for days [0,1,2,3]</p>
<p>camx120hr file contains 120 hrs for days [-1,0,1,2,3]</p>
<p>We need current day data from each file to avoid redundancy. So we will take 0-23 hrs from camx96hr and 24-47hrs from camx120hr</p>
<div id="cell-34" class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_data(target_var_96_list, target_var_120_list):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> []</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> []</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_var_96 <span class="kw">in</span> target_var_96_list:</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        column <span class="op">=</span> []</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> files_96:</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>            data_96 <span class="op">=</span> xr.open_dataset(i)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">24</span>):</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                variable96 <span class="op">=</span> data_96[target_var_96][<span class="st">'TSTEP'</span><span class="op">==</span>j]</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                column.append(variable96)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        column <span class="op">=</span> np.array(column)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(column.shape) # (69*24, 1, 80, 80)</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        X.append(column)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.array(X)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.concatenate([X[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">0</span>])], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'X shape '</span>,X.shape)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_var_120 <span class="kw">in</span> target_var_120_list:</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>        column <span class="op">=</span> []</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> files_120:</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>            data_120 <span class="op">=</span> xr.open_dataset(i)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">24</span>):</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>                variable120 <span class="op">=</span> data_120[target_var_120][<span class="st">'TSTEP'</span><span class="op">==</span><span class="dv">24</span><span class="op">+</span>j]</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>                column.append(variable120)</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>        column <span class="op">=</span> np.array(column)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(column.shape) # (69*24, 1, 80, 80)</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>        y.append(column)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.array(y)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.concatenate([y[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(y.shape[<span class="dv">0</span>])], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'y shape'</span>, y.shape)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X,y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>target_var_96_list <span class="op">=</span>[<span class="st">'TSURF_K'</span>,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'SNOWEW_M'</span>, <span class="st">'SNOWAGE_HR'</span>, <span class="st">'PRATE_MMpH'</span>, <span class="st">'CLOUD_OD'</span>, <span class="st">'U10_MpS'</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'V10_MpS'</span>, <span class="st">'T2_K'</span>, <span class="st">'SWSFC_WpM2'</span>, <span class="st">'SOLM_M3pM3'</span>, <span class="st">'CLDTOP_KM'</span>, <span class="st">'CAPE'</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'PBL_WRF_M'</span>, <span class="st">'PBL_YSU_M'</span>]  <span class="co"># ['U10_MpS', 'T2_K', 'V10_MpS']</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>target_var_120_list <span class="op">=</span> [<span class="st">'P25'</span>,<span class="st">'P10'</span>] </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>X,y  <span class="op">=</span> get_data(target_var_96_list, target_var_120_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X shape  (1656, 14, 80, 80)
y shape (1656, 2, 80, 80)</code></pre>
</div>
</div>
<div id="cell-36" class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CustomDataset(data.Dataset):</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_data, output_data):</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.input_data <span class="op">=</span> input_data</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_data <span class="op">=</span> output_data</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__len__</span>(<span class="va">self</span>):</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.input_data)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__getitem__</span>(<span class="va">self</span>, index):</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        input_sample <span class="op">=</span> torch.Tensor(<span class="va">self</span>.input_data[index])</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        output_sample <span class="op">=</span> torch.Tensor(<span class="va">self</span>.output_data[index])</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> input_sample, output_sample </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simple-autoencoder" class="level1">
<h1>Simple autoencoder</h1>
<section id="model-defination" class="level2">
<h2 class="anchored" data-anchor-id="model-defination">Model defination</h2>
<p><img src="../images/autoencoder/MLP_autoencoder_archi.png" width="800"></p>
<div id="cell-40" class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Autoencoder_MLP(nn.Module):</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(Autoencoder_MLP, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Define the layers</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.flatten <span class="op">=</span> nn.Flatten()  <span class="co"># Flatten the 2D input matrix</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(<span class="dv">80</span><span class="op">*</span><span class="dv">80</span>, <span class="dv">1024</span>)  <span class="co"># Fully connected layer 1</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(<span class="dv">1024</span>, <span class="dv">512</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc3 <span class="op">=</span> nn.Linear(<span class="dv">512</span>, <span class="dv">1024</span>)  <span class="co"># Fully connected layer 2</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc4 <span class="op">=</span> nn.Linear(<span class="dv">1024</span>, <span class="dv">80</span><span class="op">*</span><span class="dv">80</span>)  <span class="co"># Fully connected layer 2</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.relu <span class="op">=</span> nn.ReLU()  <span class="co"># Activation function</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Flatten the input</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.flatten(x)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward pass through the fully connected layers</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc1(x)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.relu(x)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc2(x)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.relu(x)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc3(x)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.relu(x)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc4(x)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reshape the output to match the 2D matrix size</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x.view(<span class="op">-</span><span class="dv">1</span>, <span class="dv">80</span>, <span class="dv">80</span>)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-41" class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>summary(Autoencoder_MLP(), input_size<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">80</span>, <span class="dv">80</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Autoencoder_MLP                          [1, 80, 80]               --
├─Flatten: 1-1                           [1, 6400]                 --
├─Linear: 1-2                            [1, 1024]                 6,554,624
├─ReLU: 1-3                              [1, 1024]                 --
├─Linear: 1-4                            [1, 512]                  524,800
├─ReLU: 1-5                              [1, 512]                  --
├─Linear: 1-6                            [1, 1024]                 525,312
├─ReLU: 1-7                              [1, 1024]                 --
├─Linear: 1-8                            [1, 6400]                 6,560,000
==========================================================================================
Total params: 14,164,736
Trainable params: 14,164,736
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 14.16
==========================================================================================
Input size (MB): 0.03
Forward/backward pass size (MB): 0.07
Params size (MB): 56.66
Estimated Total Size (MB): 56.76
==========================================================================================</code></pre>
</div>
</div>
</section>
<section id="training-single-channel-input-and-outputp25" class="level2">
<h2 class="anchored" data-anchor-id="training-single-channel-input-and-outputp25">Training single channel input and output(P25)</h2>
<div id="cell-43" class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>X.shape, y.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>((1656, 14, 80, 80), (1656, 2, 80, 80))</code></pre>
</div>
</div>
<div id="cell-44" class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>X_train_all, X_test_all, y_train_all, y_test_all <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>X_train_all.shape, X_test_all.shape, y_train_all.shape, y_test_all.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>((1324, 14, 80, 80), (332, 14, 80, 80), (1324, 2, 80, 80), (332, 2, 80, 80))</code></pre>
</div>
</div>
<div id="cell-45" class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_25 <span class="op">=</span> []</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>y_channel <span class="op">=</span> <span class="dv">0</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># x_channel = 0</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x_channel <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>]):</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Selecting the channel #######################</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'X Channel name : '</span>, target_var_96_list[x_channel])</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    X_train <span class="op">=</span> X_train_all[:, x_channel, :,:]</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    X_test <span class="op">=</span> X_test_all[:, x_channel, :,:]</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    y_train <span class="op">=</span> y_train_all[:, y_channel, :,:]</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    y_test <span class="op">=</span> y_test_all[:, y_channel, :,:]</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Shapes: '</span>, X_train.shape, X_test.shape, y_train.shape, y_test.shape)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Creating the dataset loader #######################</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    train_custom_dataset <span class="op">=</span> CustomDataset(X_train, y_train)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_custom_dataset))</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    train_loader <span class="op">=</span> data.DataLoader(train_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_loader))</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    test_custom_dataset <span class="op">=</span> CustomDataset(X_test, y_test)</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_custom_dataset))</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    test_loader <span class="op">=</span> data.DataLoader(test_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_loader))</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#################### Training the model ####################</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Autoencoder_MLP()</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    model.to(device)</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the loss function and optimizer</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    criterion <span class="op">=</span> nn.MSELoss()</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>    losses <span class="op">=</span> []</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Training loop</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>    num_epochs <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(num_epochs):</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>        model.train()  <span class="co"># Set the model to training mode</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> train_loader:</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>            optimizer.zero_grad()  <span class="co"># Zero the gradients</span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Backpropagation</span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>            total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the average loss for this epoch</span></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>        average_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>        losses.append(average_loss)</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Epoch [</span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss">] Loss: </span><span class="sc">{</span>average_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">############################# testing the model #############################</span></span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>    test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a>            test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the average test loss</span></span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a>    average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a>    test_loss_list_P_25.append(average_test_loss)</span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a>    plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, num_epochs <span class="op">+</span> <span class="dv">1</span>), losses)</span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Train Loss vs. Epoch for channel '</span><span class="op">+</span>target_var_96_list[x_channel])</span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>) </span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a>    plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  TSURF_K
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 405.4315
Epoch [21/200] Loss: 214.5978
Epoch [41/200] Loss: 215.0236
Epoch [61/200] Loss: 207.2482
Epoch [81/200] Loss: 206.7534
Epoch [101/200] Loss: 213.1840
Epoch [121/200] Loss: 207.5252
Epoch [141/200] Loss: 208.2888
Epoch [161/200] Loss: 209.6494
Epoch [181/200] Loss: 209.7600
Average Test Loss: 190.0971</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="Autoencoder_files/figure-html/cell-33-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWEW_M
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 464.9160
Epoch [21/200] Loss: 206.1055
Epoch [41/200] Loss: 210.0196
Epoch [61/200] Loss: 209.2211
Epoch [81/200] Loss: 211.8091
Epoch [101/200] Loss: 205.4592
Epoch [121/200] Loss: 203.9590
Epoch [141/200] Loss: 208.5030
Epoch [161/200] Loss: 207.1320
Epoch [181/200] Loss: 204.3017
Average Test Loss: 189.7174</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="Autoencoder_files/figure-html/cell-33-output-4.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWAGE_HR
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 460.0334
Epoch [21/200] Loss: 207.1043
Epoch [41/200] Loss: 206.5882
Epoch [61/200] Loss: 208.3192
Epoch [81/200] Loss: 205.4035
Epoch [101/200] Loss: 209.7349
Epoch [121/200] Loss: 205.5515
Epoch [141/200] Loss: 206.1994
Epoch [161/200] Loss: 205.4001
Epoch [181/200] Loss: 206.3801
Average Test Loss: 190.0263</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="Autoencoder_files/figure-html/cell-33-output-6.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PRATE_MMpH
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 476.9623
Epoch [21/200] Loss: 207.3108
Epoch [41/200] Loss: 208.4855
Epoch [61/200] Loss: 206.4735
Epoch [81/200] Loss: 205.5895
Epoch [101/200] Loss: 205.6536
Epoch [121/200] Loss: 205.9680
Epoch [141/200] Loss: 205.7129
Epoch [161/200] Loss: 208.6799
Epoch [181/200] Loss: 205.6486
Average Test Loss: 189.6717</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="Autoencoder_files/figure-html/cell-33-output-8.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLOUD_OD
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 599.1686
Epoch [21/200] Loss: 454.3787
Epoch [41/200] Loss: 149.9270
Epoch [61/200] Loss: 23.7072
Epoch [81/200] Loss: 7.4556
Epoch [101/200] Loss: 18.4050
Epoch [121/200] Loss: 3.0840
Epoch [141/200] Loss: 100.6344
Epoch [161/200] Loss: 25.9631
Epoch [181/200] Loss: 38.8335
Average Test Loss: 9.8902</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-10.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="Autoencoder_files/figure-html/cell-33-output-10.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  U10_MpS
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 373.7542
Epoch [21/200] Loss: 51.2008
Epoch [41/200] Loss: 37.7057
Epoch [61/200] Loss: 25.3702
Epoch [81/200] Loss: 0.2791
Epoch [101/200] Loss: 20.1649
Epoch [121/200] Loss: 0.2297
Epoch [141/200] Loss: 84.8078
Epoch [161/200] Loss: 2.4612
Epoch [181/200] Loss: 1.4404
Average Test Loss: 0.7598</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-12.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="Autoencoder_files/figure-html/cell-33-output-12.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  V10_MpS
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 399.2307
Epoch [21/200] Loss: 1.1263
Epoch [41/200] Loss: 0.0137
Epoch [61/200] Loss: 0.0820
Epoch [81/200] Loss: 2.3733
Epoch [101/200] Loss: 0.0002
Epoch [121/200] Loss: 0.0113
Epoch [141/200] Loss: 0.0393
Epoch [161/200] Loss: 11.0771
Epoch [181/200] Loss: 0.0003
Average Test Loss: 0.0507</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-14.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="Autoencoder_files/figure-html/cell-33-output-14.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  T2_K
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 412.2657
Epoch [21/200] Loss: 210.9129
Epoch [41/200] Loss: 209.2686
Epoch [61/200] Loss: 206.7048
Epoch [81/200] Loss: 206.0187
Epoch [101/200] Loss: 209.1361
Epoch [121/200] Loss: 212.1444
Epoch [141/200] Loss: 206.8286
Epoch [161/200] Loss: 205.8083
Epoch [181/200] Loss: 208.7421
Average Test Loss: 190.9819</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-16.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="Autoencoder_files/figure-html/cell-33-output-16.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SWSFC_WpM2
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 485.4561
Epoch [21/200] Loss: 210.1752
Epoch [41/200] Loss: 207.2874
Epoch [61/200] Loss: 207.9026
Epoch [81/200] Loss: 206.2404
Epoch [101/200] Loss: 205.9271
Epoch [121/200] Loss: 205.6481
Epoch [141/200] Loss: 208.2400
Epoch [161/200] Loss: 205.4081
Epoch [181/200] Loss: 205.1859
Average Test Loss: 199.1508</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-18.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="Autoencoder_files/figure-html/cell-33-output-18.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SOLM_M3pM3
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 305.6402
Epoch [21/200] Loss: 176.6024
Epoch [41/200] Loss: 161.6851
Epoch [61/200] Loss: 157.7673
Epoch [81/200] Loss: 138.7664
Epoch [101/200] Loss: 132.1217
Epoch [121/200] Loss: 109.4900
Epoch [141/200] Loss: 104.2382
Epoch [161/200] Loss: 69.5860
Epoch [181/200] Loss: 50.0248
Average Test Loss: 42.1182</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-20.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="Autoencoder_files/figure-html/cell-33-output-20.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLDTOP_KM
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 461.0668
Epoch [21/200] Loss: 205.2268
Epoch [41/200] Loss: 213.0740
Epoch [61/200] Loss: 206.9702
Epoch [81/200] Loss: 205.7769
Epoch [101/200] Loss: 210.3533
Epoch [121/200] Loss: 206.2578
Epoch [141/200] Loss: 207.2727
Epoch [161/200] Loss: 205.3765
Epoch [181/200] Loss: 206.2520
Average Test Loss: 192.2221</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-22.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="Autoencoder_files/figure-html/cell-33-output-22.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CAPE
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 468.8439
Epoch [21/200] Loss: 207.2851
Epoch [41/200] Loss: 211.7429
Epoch [61/200] Loss: 205.8536
Epoch [81/200] Loss: 205.3124
Epoch [101/200] Loss: 207.8155
Epoch [121/200] Loss: 208.3488
Epoch [141/200] Loss: 206.0120
Epoch [161/200] Loss: 205.9442
Epoch [181/200] Loss: 204.1215
Average Test Loss: 190.8858</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-24.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="Autoencoder_files/figure-html/cell-33-output-24.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_WRF_M
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 287.4021
Epoch [21/200] Loss: 209.5118
Epoch [41/200] Loss: 209.2537
Epoch [61/200] Loss: 206.0375
Epoch [81/200] Loss: 207.1711
Epoch [101/200] Loss: 205.2734
Epoch [121/200] Loss: 210.4286
Epoch [141/200] Loss: 207.5243
Epoch [161/200] Loss: 208.9856
Epoch [181/200] Loss: 204.6973
Average Test Loss: 191.9669</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-26.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="Autoencoder_files/figure-html/cell-33-output-26.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_YSU_M
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 323.2034
Epoch [21/200] Loss: 207.3925
Epoch [41/200] Loss: 210.0555
Epoch [61/200] Loss: 206.0877
Epoch [81/200] Loss: 207.9315
Epoch [101/200] Loss: 207.4798
Epoch [121/200] Loss: 206.1072
Epoch [141/200] Loss: 207.4259
Epoch [161/200] Loss: 209.3318
Epoch [181/200] Loss: 207.3006
Average Test Loss: 194.3565</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-33-output-28.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="Autoencoder_files/figure-html/cell-33-output-28.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-46" class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_25</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[190.09705144708806,
 189.7173545143821,
 190.02632834694603,
 189.67173489657316,
 9.890190774744207,
 0.7598354017192667,
 0.050707115029746834,
 190.98193498091265,
 199.15079567649147,
 42.118152445012875,
 192.22213883833453,
 190.88581431995738,
 191.9668634588068,
 194.3564910888672]</code></pre>
</div>
</div>
<div id="cell-47" class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>name_loss_pairs <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(target_var_96_list, test_loss_list_P_25))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort based on loss values</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>sorted_name_loss_pairs <span class="op">=</span> <span class="bu">sorted</span>(name_loss_pairs, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs:</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pair)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(sorted_name_loss_pairs)</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the lowest 3 names</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>lowest_3_names <span class="op">=</span> [pair[<span class="dv">0</span>] <span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs[:<span class="dv">3</span>]]</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Lowest 3 names:"</span>, lowest_3_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>('V10_MpS', 0.050707115029746834)
('U10_MpS', 0.7598354017192667)
('CLOUD_OD', 9.890190774744207)
('SOLM_M3pM3', 42.118152445012875)
('PRATE_MMpH', 189.67173489657316)
('SNOWEW_M', 189.7173545143821)
('SNOWAGE_HR', 190.02632834694603)
('TSURF_K', 190.09705144708806)
('CAPE', 190.88581431995738)
('T2_K', 190.98193498091265)
('PBL_WRF_M', 191.9668634588068)
('CLDTOP_KM', 192.22213883833453)
('PBL_YSU_M', 194.3564910888672)
('SWSFC_WpM2', 199.15079567649147)
Lowest 3 names: ['V10_MpS', 'U10_MpS', 'CLOUD_OD']</code></pre>
</div>
</div>
</section>
<section id="training-single-channel-input-and-outputp25-1" class="level2">
<h2 class="anchored" data-anchor-id="training-single-channel-input-and-outputp25-1">Training single channel input and output(P25)</h2>
<div id="cell-49" class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_10 <span class="op">=</span> []</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>y_channel <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># x_channel = 0</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x_channel <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>]):</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Selecting the channel #######################</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'X Channel name : '</span>, target_var_96_list[x_channel])</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    X_train <span class="op">=</span> X_train_all[:, x_channel, :,:]</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    X_test <span class="op">=</span> X_test_all[:, x_channel, :,:]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    y_train <span class="op">=</span> y_train_all[:, y_channel, :,:]</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    y_test <span class="op">=</span> y_test_all[:, y_channel, :,:]</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Shapes: '</span>, X_train.shape, X_test.shape, y_train.shape, y_test.shape)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Creating the dataset loader #######################</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    train_custom_dataset <span class="op">=</span> CustomDataset(X_train, y_train)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_custom_dataset))</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    train_loader <span class="op">=</span> data.DataLoader(train_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_loader))</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    test_custom_dataset <span class="op">=</span> CustomDataset(X_test, y_test)</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_custom_dataset))</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    test_loader <span class="op">=</span> data.DataLoader(test_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_loader))</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#################### Training the model ####################</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Autoencoder_MLP()</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    model.to(device)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the loss function and optimizer</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>    criterion <span class="op">=</span> nn.MSELoss()</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>    losses <span class="op">=</span> []</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Training loop</span></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>    num_epochs <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(num_epochs):</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>        model.train()  <span class="co"># Set the model to training mode</span></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> train_loader:</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>            optimizer.zero_grad()  <span class="co"># Zero the gradients</span></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Backpropagation</span></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>            total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the average loss for this epoch</span></span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>        average_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>        losses.append(average_loss)</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Epoch [</span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss">] Loss: </span><span class="sc">{</span>average_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">############################# testing the model #############################</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>    test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>            test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the average test loss</span></span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>    average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a>    test_loss_list_P_10.append(average_test_loss)</span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a>    plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, num_epochs <span class="op">+</span> <span class="dv">1</span>), losses)</span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Train Loss vs. Epoch for channel '</span><span class="op">+</span>target_var_96_list[x_channel])</span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>) </span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a>    plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  TSURF_K
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 689.7490
Epoch [21/200] Loss: 418.6676
Epoch [41/200] Loss: 410.9685
Epoch [61/200] Loss: 404.8066
Epoch [81/200] Loss: 400.5351
Epoch [101/200] Loss: 401.0250
Epoch [121/200] Loss: 401.0659
Epoch [141/200] Loss: 403.6432
Epoch [161/200] Loss: 402.2360
Epoch [181/200] Loss: 407.2921
Average Test Loss: 401.8882</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="Autoencoder_files/figure-html/cell-36-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWEW_M
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 1031.9999
Epoch [21/200] Loss: 405.7656
Epoch [41/200] Loss: 402.2811
Epoch [61/200] Loss: 403.8337
Epoch [81/200] Loss: 398.2591
Epoch [101/200] Loss: 409.4181
Epoch [121/200] Loss: 396.3737
Epoch [141/200] Loss: 395.1861
Epoch [161/200] Loss: 403.0066
Epoch [181/200] Loss: 397.6094
Average Test Loss: 361.2384</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="Autoencoder_files/figure-html/cell-36-output-4.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWAGE_HR
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 1050.1397
Epoch [21/200] Loss: 397.1798
Epoch [41/200] Loss: 401.0453
Epoch [61/200] Loss: 401.7171
Epoch [81/200] Loss: 400.2689
Epoch [101/200] Loss: 396.7101
Epoch [121/200] Loss: 404.5816
Epoch [141/200] Loss: 397.7231
Epoch [161/200] Loss: 394.6489
Epoch [181/200] Loss: 399.8899
Average Test Loss: 362.0641</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="Autoencoder_files/figure-html/cell-36-output-6.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PRATE_MMpH
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 1034.3143
Epoch [21/200] Loss: 399.8861
Epoch [41/200] Loss: 399.7876
Epoch [61/200] Loss: 395.9112
Epoch [81/200] Loss: 400.4803
Epoch [101/200] Loss: 396.5552
Epoch [121/200] Loss: 401.0467
Epoch [141/200] Loss: 406.4987
Epoch [161/200] Loss: 401.3759
Epoch [181/200] Loss: 397.4671
Average Test Loss: 361.1263</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="Autoencoder_files/figure-html/cell-36-output-8.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLOUD_OD
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 1214.4916
Epoch [21/200] Loss: 725.7131
Epoch [41/200] Loss: 220.5272
Epoch [61/200] Loss: 23.5934
Epoch [81/200] Loss: 8.8063
Epoch [101/200] Loss: 274.7881
Epoch [121/200] Loss: 218.0335
Epoch [141/200] Loss: 232.4360
Epoch [161/200] Loss: 212.6520
Epoch [181/200] Loss: 195.4785
Average Test Loss: 180.2198</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-10.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="Autoencoder_files/figure-html/cell-36-output-10.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  U10_MpS
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 822.4214
Epoch [21/200] Loss: 182.0370
Epoch [41/200] Loss: 50.0221
Epoch [61/200] Loss: 60.5883
Epoch [81/200] Loss: 37.8001
Epoch [101/200] Loss: 2.6386
Epoch [121/200] Loss: 0.0629
Epoch [141/200] Loss: 76.5106
Epoch [161/200] Loss: 41.2225
Epoch [181/200] Loss: 4.6194
Average Test Loss: 0.6711</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-12.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="Autoencoder_files/figure-html/cell-36-output-12.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  V10_MpS
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 1160.5402
Epoch [21/200] Loss: 8.7026
Epoch [41/200] Loss: 0.3045
Epoch [61/200] Loss: 0.1493
Epoch [81/200] Loss: 0.1235
Epoch [101/200] Loss: 5.4404
Epoch [121/200] Loss: 0.0000
Epoch [141/200] Loss: 10.2387
Epoch [161/200] Loss: 0.2644
Epoch [181/200] Loss: 0.0284
Average Test Loss: 0.6849</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-14.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="Autoencoder_files/figure-html/cell-36-output-14.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  T2_K
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 646.6076
Epoch [21/200] Loss: 412.2161
Epoch [41/200] Loss: 407.6458
Epoch [61/200] Loss: 403.7684
Epoch [81/200] Loss: 399.9570
Epoch [101/200] Loss: 397.7386
Epoch [121/200] Loss: 402.0990
Epoch [141/200] Loss: 397.6674
Epoch [161/200] Loss: 398.1612
Epoch [181/200] Loss: 403.3343
Average Test Loss: 360.5232</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-16.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="Autoencoder_files/figure-html/cell-36-output-16.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SWSFC_WpM2
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 1027.1539
Epoch [21/200] Loss: 403.9408
Epoch [41/200] Loss: 401.9444
Epoch [61/200] Loss: 399.7967
Epoch [81/200] Loss: 401.7070
Epoch [101/200] Loss: 404.1586
Epoch [121/200] Loss: 398.2909
Epoch [141/200] Loss: 396.0758
Epoch [161/200] Loss: 396.4020
Epoch [181/200] Loss: 402.5728
Average Test Loss: 362.6420</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-18.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="Autoencoder_files/figure-html/cell-36-output-18.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SOLM_M3pM3
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 696.3634
Epoch [21/200] Loss: 331.1351
Epoch [41/200] Loss: 296.5541
Epoch [61/200] Loss: 301.9112
Epoch [81/200] Loss: 272.0759
Epoch [101/200] Loss: 251.3878
Epoch [121/200] Loss: 232.4279
Epoch [141/200] Loss: 170.0628
Epoch [161/200] Loss: 138.8842
Epoch [181/200] Loss: 108.4864
Average Test Loss: 110.6638</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-20.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="Autoencoder_files/figure-html/cell-36-output-20.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLDTOP_KM
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 1017.6373
Epoch [21/200] Loss: 400.4651
Epoch [41/200] Loss: 405.2223
Epoch [61/200] Loss: 402.9269
Epoch [81/200] Loss: 400.7290
Epoch [101/200] Loss: 400.5154
Epoch [121/200] Loss: 404.1065
Epoch [141/200] Loss: 403.8573
Epoch [161/200] Loss: 397.0463
Epoch [181/200] Loss: 398.1819
Average Test Loss: 361.3055</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-22.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="Autoencoder_files/figure-html/cell-36-output-22.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CAPE
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 1029.8392
Epoch [21/200] Loss: 401.8889
Epoch [41/200] Loss: 399.1993
Epoch [61/200] Loss: 400.2419
Epoch [81/200] Loss: 396.8849
Epoch [101/200] Loss: 395.3639
Epoch [121/200] Loss: 401.5739
Epoch [141/200] Loss: 403.1417
Epoch [161/200] Loss: 402.3704
Epoch [181/200] Loss: 400.0658
Average Test Loss: 361.0597</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-24.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="Autoencoder_files/figure-html/cell-36-output-24.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_WRF_M
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 536.0374
Epoch [21/200] Loss: 401.9832
Epoch [41/200] Loss: 402.4697
Epoch [61/200] Loss: 404.1890
Epoch [81/200] Loss: 400.4949
Epoch [101/200] Loss: 399.0872
Epoch [121/200] Loss: 398.4192
Epoch [141/200] Loss: 400.4667
Epoch [161/200] Loss: 398.1382
Epoch [181/200] Loss: 408.3430
Average Test Loss: 360.3921</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-26.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="Autoencoder_files/figure-html/cell-36-output-26.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_YSU_M
Shapes:  (1324, 80, 80) (332, 80, 80) (1324, 80, 80) (332, 80, 80)
Epoch [1/200] Loss: 538.3320
Epoch [21/200] Loss: 405.8272
Epoch [41/200] Loss: 430.2409
Epoch [61/200] Loss: 398.9199
Epoch [81/200] Loss: 404.8572
Epoch [101/200] Loss: 397.2876
Epoch [121/200] Loss: 403.3052
Epoch [141/200] Loss: 401.7307
Epoch [161/200] Loss: 396.1157
Epoch [181/200] Loss: 399.0870
Average Test Loss: 361.4502</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-36-output-28.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="Autoencoder_files/figure-html/cell-36-output-28.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-50" class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[401.88824185458094,
 361.23838112571025,
 362.0641340775923,
 361.1262997713956,
 180.2197820490057,
 0.6710819737477736,
 0.6848962740464644,
 360.5232141668146,
 362.6420177112926,
 110.6638252951882,
 361.3054504394531,
 361.05967018821025,
 360.39211342551494,
 361.45016063343394]</code></pre>
</div>
</div>
<div id="cell-51" class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>name_loss_pairs <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(target_var_96_list, test_loss_list_P_10))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort based on loss values</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>sorted_name_loss_pairs <span class="op">=</span> <span class="bu">sorted</span>(name_loss_pairs, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs:</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pair)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(sorted_name_loss_pairs)</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the lowest 3 names</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>lowest_3_names <span class="op">=</span> [pair[<span class="dv">0</span>] <span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs[:<span class="dv">3</span>]]</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Lowest 3 names:"</span>, lowest_3_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>('U10_MpS', 0.6710819737477736)
('V10_MpS', 0.6848962740464644)
('SOLM_M3pM3', 110.6638252951882)
('CLOUD_OD', 180.2197820490057)
('PBL_WRF_M', 360.39211342551494)
('T2_K', 360.5232141668146)
('CAPE', 361.05967018821025)
('PRATE_MMpH', 361.1262997713956)
('SNOWEW_M', 361.23838112571025)
('CLDTOP_KM', 361.3054504394531)
('PBL_YSU_M', 361.45016063343394)
('SNOWAGE_HR', 362.0641340775923)
('SWSFC_WpM2', 362.6420177112926)
('TSURF_K', 401.88824185458094)
Lowest 3 names: ['U10_MpS', 'V10_MpS', 'SOLM_M3pM3']</code></pre>
</div>
</div>
</section>
<section id="insights" class="level2">
<h2 class="anchored" data-anchor-id="insights">Insights</h2>
<div id="cell-53" class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding values at corresponding indices</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> [(x <span class="op">+</span> y)<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(test_loss_list_P_10, test_loss_list_P_25)]</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a DataFrame</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>data_frame <span class="op">=</span> {<span class="st">'Input channel'</span>: target_var_96_list, <span class="st">'P10'</span>: test_loss_list_P_10, <span class="st">'P25'</span>: test_loss_list_P_25, <span class="st">'P10+P25 avg'</span>: result}</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data_frame)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Sorting the DataFrame based on "List1 + List2"</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>df_sorted <span class="op">=</span> df.sort_values(by<span class="op">=</span><span class="st">'P10+P25 avg'</span>)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the sorted DataFrame</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>df_rounded <span class="op">=</span> df_sorted.<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>df_rounded.to_csv(<span class="st">'/home/rishabh.mondal/climax_alternative/Climax_2/results/test_loss_list_P_10_P25_MLP_auto.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>df_rounded</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Input channel</th>
<th data-quarto-table-cell-role="th">P10</th>
<th data-quarto-table-cell-role="th">P25</th>
<th data-quarto-table-cell-role="th">P10+P25 avg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>V10_MpS</td>
<td>0.7</td>
<td>0.1</td>
<td>0.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>U10_MpS</td>
<td>0.7</td>
<td>0.8</td>
<td>0.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>SOLM_M3pM3</td>
<td>110.7</td>
<td>42.1</td>
<td>76.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>CLOUD_OD</td>
<td>180.2</td>
<td>9.9</td>
<td>95.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>PRATE_MMpH</td>
<td>361.1</td>
<td>189.7</td>
<td>275.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>SNOWEW_M</td>
<td>361.2</td>
<td>189.7</td>
<td>275.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>T2_K</td>
<td>360.5</td>
<td>191.0</td>
<td>275.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>CAPE</td>
<td>361.1</td>
<td>190.9</td>
<td>276.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>SNOWAGE_HR</td>
<td>362.1</td>
<td>190.0</td>
<td>276.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>PBL_WRF_M</td>
<td>360.4</td>
<td>192.0</td>
<td>276.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>CLDTOP_KM</td>
<td>361.3</td>
<td>192.2</td>
<td>276.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>PBL_YSU_M</td>
<td>361.5</td>
<td>194.4</td>
<td>277.9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>SWSFC_WpM2</td>
<td>362.6</td>
<td>199.2</td>
<td>280.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>TSURF_K</td>
<td>401.9</td>
<td>190.1</td>
<td>296.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="autoencoder-with-convolutional-layers" class="level1">
<h1>Autoencoder with convolutional layers</h1>
<section id="model-defination-1" class="level2">
<h2 class="anchored" data-anchor-id="model-defination-1">Model defination</h2>
<p><img src="../images/autoencoder/Conv_autoencoder_architecture.png" width="800"></p>
<div id="cell-57" class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Encoder(nn.Module):</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, image_size, num_input_channels, num_output_channels <span class="op">=</span> <span class="dv">1</span>, c_hid <span class="op">=</span> <span class="dv">16</span>, latent_dim <span class="op">=</span> <span class="dv">1024</span>, activation<span class="op">=</span> nn.GELU):</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(Encoder, <span class="va">self</span>).<span class="fu">__init__</span>() </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.image_size <span class="op">=</span> image_size</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_input_channels <span class="op">=</span> num_input_channels</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_output_channels <span class="op">=</span> num_output_channels</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_hid <span class="op">=</span> c_hid </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.latent_dim <span class="op">=</span> latent_dim</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.activation <span class="op">=</span> activation</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.net <span class="op">=</span> nn.Sequential( </span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels<span class="op">=</span><span class="va">self</span>.num_input_channels, out_channels<span class="op">=</span><span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels<span class="op">=</span><span class="va">self</span>.c_hid, out_channels<span class="op">=</span><span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels<span class="op">=</span><span class="va">self</span>.c_hid, out_channels<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.c_hid, out_channels<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.c_hid, out_channels<span class="op">=</span><span class="dv">4</span><span class="op">*</span><span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>            nn.Flatten(),</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>            nn.Linear((<span class="dv">4</span> <span class="op">*</span> <span class="va">self</span>.c_hid) <span class="op">*</span> <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span> <span class="op">*</span> <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span>, <span class="va">self</span>.latent_dim)</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>        ) </span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.net(x)</span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Decoder(nn.Module):</span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, image_size, num_input_channels, num_output_channels <span class="op">=</span> <span class="dv">1</span>,c_hid <span class="op">=</span> <span class="dv">16</span>, latent_dim <span class="op">=</span> <span class="dv">1024</span>, activation<span class="op">=</span> nn.GELU):</span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(Decoder, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.image_size <span class="op">=</span> image_size</span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_input_channels <span class="op">=</span> num_input_channels</span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_output_channels <span class="op">=</span> num_output_channels</span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_hid <span class="op">=</span> c_hid</span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.latent_dim <span class="op">=</span> latent_dim</span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.activation <span class="op">=</span> activation</span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.decoder <span class="op">=</span> nn.Sequential(</span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a>            nn.Linear(<span class="va">self</span>.latent_dim, (<span class="dv">4</span> <span class="op">*</span> <span class="va">self</span>.c_hid) <span class="op">*</span> <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span> <span class="op">*</span> <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span>),</span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a>            nn.Unflatten(<span class="dv">1</span>, (<span class="dv">4</span><span class="op">*</span><span class="va">self</span>.c_hid, <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span>, <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span>)),</span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a>            nn.ConvTranspose2d(in_channels<span class="op">=</span><span class="dv">4</span><span class="op">*</span><span class="va">self</span>.c_hid, out_channels<span class="op">=</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>, output_padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb83-43"><a href="#cb83-43" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels <span class="op">=</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.c_hid, out_channels<span class="op">=</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb83-44"><a href="#cb83-44" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a>            nn.ConvTranspose2d(in_channels <span class="op">=</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.c_hid, out_channels <span class="op">=</span> <span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>, output_padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels <span class="op">=</span> <span class="va">self</span>.c_hid,out_channels<span class="op">=</span> <span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a>            nn.ConvTranspose2d(in_channels <span class="op">=</span> <span class="va">self</span>.c_hid, out_channels<span class="op">=</span> <span class="va">self</span>.num_output_channels, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>, output_padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb83-52"><a href="#cb83-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb83-53"><a href="#cb83-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.decoder(x)</span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Autoencoder_CNN(nn.Module):</span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, image_size, num_input_channels, num_output_channels <span class="op">=</span> <span class="dv">1</span>,c_hid <span class="op">=</span> <span class="dv">16</span>, latent_dim <span class="op">=</span> <span class="dv">1024</span>, activation<span class="op">=</span> nn.GELU, encoder <span class="op">=</span> Encoder, decoder <span class="op">=</span> Decoder):</span>
<span id="cb83-57"><a href="#cb83-57" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(Autoencoder_CNN, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb83-58"><a href="#cb83-58" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.image_size <span class="op">=</span> image_size</span>
<span id="cb83-59"><a href="#cb83-59" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_input_channels <span class="op">=</span> num_input_channels</span>
<span id="cb83-60"><a href="#cb83-60" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_output_channels <span class="op">=</span> num_output_channels</span>
<span id="cb83-61"><a href="#cb83-61" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_hid <span class="op">=</span> c_hid</span>
<span id="cb83-62"><a href="#cb83-62" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.latent_dim <span class="op">=</span> latent_dim </span>
<span id="cb83-63"><a href="#cb83-63" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.activation <span class="op">=</span> activation    </span>
<span id="cb83-64"><a href="#cb83-64" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.encoder <span class="op">=</span> encoder(<span class="va">self</span>.image_size, <span class="va">self</span>.num_input_channels, <span class="va">self</span>.num_output_channels, <span class="va">self</span>.c_hid, <span class="va">self</span>.latent_dim, <span class="va">self</span>.activation)</span>
<span id="cb83-65"><a href="#cb83-65" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.decoder <span class="op">=</span> decoder(<span class="va">self</span>.image_size, <span class="va">self</span>.num_input_channels, <span class="va">self</span>.num_output_channels, <span class="va">self</span>.c_hid, <span class="va">self</span>.latent_dim, <span class="va">self</span>.activation)</span>
<span id="cb83-66"><a href="#cb83-66" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb83-67"><a href="#cb83-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb83-68"><a href="#cb83-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb83-69"><a href="#cb83-69" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.encoder(x)</span>
<span id="cb83-70"><a href="#cb83-70" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(x.shape)</span></span>
<span id="cb83-71"><a href="#cb83-71" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.decoder(x)</span>
<span id="cb83-72"><a href="#cb83-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-58" class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>model_auto <span class="op">=</span> Autoencoder_CNN(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">14</span>, num_output_channels<span class="op">=</span><span class="dv">2</span>, c_hid <span class="op">=</span> <span class="dv">16</span>, latent_dim <span class="op">=</span> <span class="dv">1024</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>model_auto</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>dummy_input <span class="op">=</span> torch.randn(<span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">80</span>, <span class="dv">80</span>)  <span class="co"># Assuming input size of (batch_size, num_num_input_channels, height, width)</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> model_auto(dummy_input)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(out.shape)    </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_auto)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([11, 2, 80, 80])
Autoencoder_CNN(
  (encoder): Encoder(
    (net): Sequential(
      (0): Conv2d(14, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      (1): GELU(approximate='none')
      (2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (3): GELU(approximate='none')
      (4): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      (5): GELU(approximate='none')
      (6): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (7): GELU(approximate='none')
      (8): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      (9): GELU(approximate='none')
      (10): Flatten(start_dim=1, end_dim=-1)
      (11): Linear(in_features=6400, out_features=1024, bias=True)
    )
  )
  (decoder): Decoder(
    (decoder): Sequential(
      (0): Linear(in_features=1024, out_features=6400, bias=True)
      (1): Unflatten(dim=1, unflattened_size=(64, 10, 10))
      (2): ConvTranspose2d(64, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), output_padding=(1, 1))
      (3): GELU(approximate='none')
      (4): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (5): GELU(approximate='none')
      (6): ConvTranspose2d(32, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), output_padding=(1, 1))
      (7): GELU(approximate='none')
      (8): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (9): GELU(approximate='none')
      (10): ConvTranspose2d(16, 2, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), output_padding=(1, 1))
    )
  )
)</code></pre>
</div>
</div>
<div id="cell-59" class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchinfo <span class="im">import</span> summary</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>summary(model_auto, input_size<span class="op">=</span>(<span class="dv">1656</span>, <span class="dv">14</span>, <span class="dv">80</span>, <span class="dv">80</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Autoencoder_CNN                          [1656, 2, 80, 80]         --
├─Encoder: 1-1                           [1656, 1024]              --
│    └─Sequential: 2-1                   [1656, 1024]              --
│    │    └─Conv2d: 3-1                  [1656, 16, 40, 40]        2,032
│    │    └─GELU: 3-2                    [1656, 16, 40, 40]        --
│    │    └─Conv2d: 3-3                  [1656, 16, 40, 40]        2,320
│    │    └─GELU: 3-4                    [1656, 16, 40, 40]        --
│    │    └─Conv2d: 3-5                  [1656, 32, 20, 20]        4,640
│    │    └─GELU: 3-6                    [1656, 32, 20, 20]        --
│    │    └─Conv2d: 3-7                  [1656, 32, 20, 20]        9,248
│    │    └─GELU: 3-8                    [1656, 32, 20, 20]        --
│    │    └─Conv2d: 3-9                  [1656, 64, 10, 10]        18,496
│    │    └─GELU: 3-10                   [1656, 64, 10, 10]        --
│    │    └─Flatten: 3-11                [1656, 6400]              --
│    │    └─Linear: 3-12                 [1656, 1024]              6,554,624
├─Decoder: 1-2                           [1656, 2, 80, 80]         --
│    └─Sequential: 2-2                   [1656, 2, 80, 80]         --
│    │    └─Linear: 3-13                 [1656, 6400]              6,560,000
│    │    └─Unflatten: 3-14              [1656, 64, 10, 10]        --
│    │    └─ConvTranspose2d: 3-15        [1656, 32, 20, 20]        18,464
│    │    └─GELU: 3-16                   [1656, 32, 20, 20]        --
│    │    └─Conv2d: 3-17                 [1656, 32, 20, 20]        9,248
│    │    └─GELU: 3-18                   [1656, 32, 20, 20]        --
│    │    └─ConvTranspose2d: 3-19        [1656, 16, 40, 40]        4,624
│    │    └─GELU: 3-20                   [1656, 16, 40, 40]        --
│    │    └─Conv2d: 3-21                 [1656, 16, 40, 40]        2,320
│    │    └─GELU: 3-22                   [1656, 16, 40, 40]        --
│    │    └─ConvTranspose2d: 3-23        [1656, 2, 80, 80]         290
==========================================================================================
Total params: 13,186,306
Trainable params: 13,186,306
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 85.34
==========================================================================================
Input size (MB): 593.51
Forward/backward pass size (MB): 2387.61
Params size (MB): 52.75
Estimated Total Size (MB): 3033.86
==========================================================================================</code></pre>
</div>
</div>
<div id="cell-60" class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchsummary <span class="im">import</span> summary</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>summary(model_auto, input_size<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">80</span>, <span class="dv">80</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1           [-1, 16, 40, 40]           2,032
              GELU-2           [-1, 16, 40, 40]               0
            Conv2d-3           [-1, 16, 40, 40]           2,320
              GELU-4           [-1, 16, 40, 40]               0
            Conv2d-5           [-1, 32, 20, 20]           4,640
              GELU-6           [-1, 32, 20, 20]               0
            Conv2d-7           [-1, 32, 20, 20]           9,248
              GELU-8           [-1, 32, 20, 20]               0
            Conv2d-9           [-1, 64, 10, 10]          18,496
             GELU-10           [-1, 64, 10, 10]               0
          Flatten-11                 [-1, 6400]               0
           Linear-12                 [-1, 1024]       6,554,624
          Encoder-13                 [-1, 1024]               0
           Linear-14                 [-1, 6400]       6,560,000
        Unflatten-15           [-1, 64, 10, 10]               0
  ConvTranspose2d-16           [-1, 32, 20, 20]          18,464
             GELU-17           [-1, 32, 20, 20]               0
           Conv2d-18           [-1, 32, 20, 20]           9,248
             GELU-19           [-1, 32, 20, 20]               0
  ConvTranspose2d-20           [-1, 16, 40, 40]           4,624
             GELU-21           [-1, 16, 40, 40]               0
           Conv2d-22           [-1, 16, 40, 40]           2,320
             GELU-23           [-1, 16, 40, 40]               0
  ConvTranspose2d-24            [-1, 2, 80, 80]             290
          Decoder-25            [-1, 2, 80, 80]               0
================================================================
Total params: 13,186,306
Trainable params: 13,186,306
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.34
Forward/backward pass size (MB): 2.80
Params size (MB): 50.30
Estimated Total Size (MB): 53.44
----------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="training-on-all-channel-and-predicting-on-all-channel" class="level2">
<h2 class="anchored" data-anchor-id="training-on-all-channel-and-predicting-on-all-channel">training on all channel and predicting on all channel</h2>
<div id="cell-62" class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>target_var_96_list <span class="op">=</span>[<span class="st">'TSURF_K'</span>,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'SNOWEW_M'</span>, <span class="st">'SNOWAGE_HR'</span>, <span class="st">'PRATE_MMpH'</span>, <span class="st">'CLOUD_OD'</span>, <span class="st">'U10_MpS'</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'V10_MpS'</span>, <span class="st">'T2_K'</span>, <span class="st">'SWSFC_WpM2'</span>, <span class="st">'SOLM_M3pM3'</span>, <span class="st">'CLDTOP_KM'</span>, <span class="st">'CAPE'</span>,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'PBL_WRF_M'</span>, <span class="st">'PBL_YSU_M'</span>]  <span class="co"># ['U10_MpS', 'T2_K', 'V10_MpS']</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>target_var_120_list <span class="op">=</span> [<span class="st">'P25'</span>,<span class="st">'P10'</span>] </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>X,y  <span class="op">=</span> get_data(target_var_96_list, target_var_120_list)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>X_train_all, X_test_all, y_train_all, y_test_all <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>X_train_all.shape, X_test_all.shape, y_train_all.shape, y_test_all.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X shape  (1656, 14, 80, 80)
y shape (1656, 2, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>((1324, 14, 80, 80), (332, 14, 80, 80), (1324, 2, 80, 80), (332, 2, 80, 80))</code></pre>
</div>
</div>
<div id="cell-63" class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train_all.shape, X_test_all.shape, y_train_all.shape, y_test_all.shape)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>train_custom_dataset <span class="op">=</span> CustomDataset(X_train_all, y_train_all)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(train_custom_dataset))</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>train_loader <span class="op">=</span> data.DataLoader(train_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(train_loader))</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>test_custom_dataset <span class="op">=</span> CustomDataset(X_test_all, y_test_all)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(test_custom_dataset))</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>test_loader <span class="op">=</span> data.DataLoader(test_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(test_loader))</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="co">#################### Training the model ####################</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Autoencoder_CNN(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">14</span>, num_output_channels<span class="op">=</span><span class="dv">2</span>, c_hid <span class="op">=</span> <span class="dv">64</span>, latent_dim <span class="op">=</span> <span class="dv">2048</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>model.to(device) </span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchinfo <span class="im">import</span> summary</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary(model, input_size<span class="op">=</span>(<span class="dv">1656</span>, <span class="dv">14</span>, <span class="dv">80</span>, <span class="dv">80</span>)))</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the loss function and optimizer</span></span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>criterion <span class="op">=</span> nn.MSELoss()</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>losses <span class="op">=</span> [] </span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Training loop</span></span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>num_epochs <span class="op">=</span> <span class="dv">50</span> <span class="co">#200</span></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> trange(num_epochs):</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>    model.train()  <span class="co"># Set the model to training mode</span></span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>    total_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> inputs, targets <span class="kw">in</span> train_loader:</span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>        optimizer.zero_grad()  <span class="co"># Zero the gradients</span></span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>        inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>        targets <span class="op">=</span> targets.to(device)</span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward pass</span></span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(inputs)</span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate the loss</span></span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Backpropagation</span></span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a>        loss.backward()</span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a>        optimizer.step()</span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the average loss for this epoch</span></span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a>    average_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a>    losses.append(average_loss)</span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span>: </span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Epoch [</span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss">] Loss: </span><span class="sc">{</span>average_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a><span class="co">############################# testing the model #############################</span></span>
<span id="cb93-53"><a href="#cb93-53" aria-hidden="true" tabindex="-1"></a>        model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb93-54"><a href="#cb93-54" aria-hidden="true" tabindex="-1"></a>        test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb93-55"><a href="#cb93-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-56"><a href="#cb93-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb93-57"><a href="#cb93-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb93-58"><a href="#cb93-58" aria-hidden="true" tabindex="-1"></a>                inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb93-59"><a href="#cb93-59" aria-hidden="true" tabindex="-1"></a>                targets <span class="op">=</span> targets.to(device)</span>
<span id="cb93-60"><a href="#cb93-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-61"><a href="#cb93-61" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Forward pass</span></span>
<span id="cb93-62"><a href="#cb93-62" aria-hidden="true" tabindex="-1"></a>                outputs <span class="op">=</span> model(inputs)</span>
<span id="cb93-63"><a href="#cb93-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-64"><a href="#cb93-64" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Calculate the loss</span></span>
<span id="cb93-65"><a href="#cb93-65" aria-hidden="true" tabindex="-1"></a>                loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb93-66"><a href="#cb93-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-67"><a href="#cb93-67" aria-hidden="true" tabindex="-1"></a>                test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb93-68"><a href="#cb93-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-69"><a href="#cb93-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the average test loss</span></span>
<span id="cb93-70"><a href="#cb93-70" aria-hidden="true" tabindex="-1"></a>        average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb93-71"><a href="#cb93-71" aria-hidden="true" tabindex="-1"></a>        <span class="co"># test_loss_list_P_25.append(average_test_loss)</span></span>
<span id="cb93-72"><a href="#cb93-72" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb93-73"><a href="#cb93-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-74"><a href="#cb93-74" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, num_epochs <span class="op">+</span> <span class="dv">1</span>), losses)</span>
<span id="cb93-75"><a href="#cb93-75" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb93-76"><a href="#cb93-76" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb93-77"><a href="#cb93-77" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.title('Train Loss vs. Epoch for channel '+target_var_96_list[x_channel])</span></span>
<span id="cb93-78"><a href="#cb93-78" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>) </span>
<span id="cb93-79"><a href="#cb93-79" aria-hidden="true" tabindex="-1"></a>plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1324, 14, 80, 80) (332, 14, 80, 80) (1324, 2, 80, 80) (332, 2, 80, 80)
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Autoencoder_CNN                          [1656, 2, 80, 80]         --
├─Encoder: 1-1                           [1656, 2048]              --
│    └─Sequential: 2-1                   [1656, 2048]              --
│    │    └─Conv2d: 3-1                  [1656, 64, 40, 40]        8,128
│    │    └─GELU: 3-2                    [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-3                  [1656, 64, 40, 40]        36,928
│    │    └─GELU: 3-4                    [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-5                  [1656, 128, 20, 20]       73,856
│    │    └─GELU: 3-6                    [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-7                  [1656, 128, 20, 20]       147,584
│    │    └─GELU: 3-8                    [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-9                  [1656, 256, 10, 10]       295,168
│    │    └─GELU: 3-10                   [1656, 256, 10, 10]       --
│    │    └─Flatten: 3-11                [1656, 25600]             --
│    │    └─Linear: 3-12                 [1656, 2048]              52,430,848
├─Decoder: 1-2                           [1656, 2, 80, 80]         --
│    └─Sequential: 2-2                   [1656, 2, 80, 80]         --
│    │    └─Linear: 3-13                 [1656, 25600]             52,454,400
│    │    └─Unflatten: 3-14              [1656, 256, 10, 10]       --
│    │    └─ConvTranspose2d: 3-15        [1656, 128, 20, 20]       295,040
│    │    └─GELU: 3-16                   [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-17                 [1656, 128, 20, 20]       147,584
│    │    └─GELU: 3-18                   [1656, 128, 20, 20]       --
│    │    └─ConvTranspose2d: 3-19        [1656, 64, 40, 40]        73,792
│    │    └─GELU: 3-20                   [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-21                 [1656, 64, 40, 40]        36,928
│    │    └─GELU: 3-22                   [1656, 64, 40, 40]        --
│    │    └─ConvTranspose2d: 3-23        [1656, 2, 80, 80]         1,154
==========================================================================================
Total params: 106,001,410
Trainable params: 106,001,410
Non-trainable params: 0
Total mult-adds (Units.TERABYTES): 1.09
==========================================================================================
Input size (MB): 593.51
Forward/backward pass size (MB): 9014.58
Params size (MB): 424.01
Estimated Total Size (MB): 10032.09
==========================================================================================</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  2%|▏         | 1/50 [00:04&lt;04:03,  4.96s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/50] Loss: 1620.3361
Average Test Loss: 377.9475</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 22%|██▏       | 11/50 [00:58&lt;03:15,  5.00s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [11/50] Loss: 249.2443
Average Test Loss: 228.7919</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 42%|████▏     | 21/50 [01:33&lt;01:40,  3.45s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/50] Loss: 168.6332
Average Test Loss: 172.4825</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 62%|██████▏   | 31/50 [02:21&lt;01:14,  3.90s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [31/50] Loss: 102.0034
Average Test Loss: 111.1758</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 40/50 [02:49&lt;00:32,  3.22s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/50] Loss: 65.1520</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 82%|████████▏ | 41/50 [02:53&lt;00:30,  3.39s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 60.7862</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 50/50 [03:30&lt;00:00,  4.22s/it]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-45-output-15.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="Autoencoder_files/figure-html/cell-45-output-15.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-64" class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>        inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>        targets <span class="op">=</span> targets.to(device)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward pass</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(inputs)</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate the loss</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>        test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the average test loss</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="co"># test_loss_list_P_25.append(average_test_loss)</span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 20.4597</code></pre>
</div>
</div>
<div id="cell-65" class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>torch.save(model.state_dict(), <span class="st">'model/auto_conv_in14_out2.pt'</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Autoencoder_CNN(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">14</span>, num_output_channels<span class="op">=</span><span class="dv">2</span>, c_hid <span class="op">=</span> <span class="dv">64</span>, latent_dim <span class="op">=</span> <span class="dv">2048</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>model.to(device) </span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>model.load_state_dict(torch.load(<span class="st">'model/auto_conv_in14_out2.pt'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;All keys matched successfully&gt;</code></pre>
</div>
</div>
</section>
<section id="single-channel-input-single-channel-output-p25" class="level2">
<h2 class="anchored" data-anchor-id="single-channel-input-single-channel-output-p25">Single channel input single channel output (P25)</h2>
<div id="cell-67" class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>target_var_96_list <span class="op">=</span>[<span class="st">'TSURF_K'</span>,</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'SNOWEW_M'</span>, <span class="st">'SNOWAGE_HR'</span>, <span class="st">'PRATE_MMpH'</span>, <span class="st">'CLOUD_OD'</span>, <span class="st">'U10_MpS'</span>,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'V10_MpS'</span>, <span class="st">'T2_K'</span>, <span class="st">'SWSFC_WpM2'</span>, <span class="st">'SOLM_M3pM3'</span>, <span class="st">'CLDTOP_KM'</span>, <span class="st">'CAPE'</span>,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'PBL_WRF_M'</span>, <span class="st">'PBL_YSU_M'</span>]  <span class="co"># ['U10_MpS', 'T2_K', 'V10_MpS']</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>target_var_120_list <span class="op">=</span> [<span class="st">'P25'</span>,<span class="st">'P10'</span>] </span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>X,y  <span class="op">=</span> get_data(target_var_96_list, target_var_120_list)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>X_train_all, X_test_all, y_train_all, y_test_all <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>X_train_all.shape, X_test_all.shape, y_train_all.shape, y_test_all.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X shape  (1656, 14, 80, 80)
y shape (1656, 2, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>((1324, 14, 80, 80), (332, 14, 80, 80), (1324, 2, 80, 80), (332, 2, 80, 80))</code></pre>
</div>
</div>
<div id="cell-68" class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_25_conv_auto <span class="op">=</span> []</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>y_channel <span class="op">=</span> <span class="dv">0</span> <span class="co"># selecting P25 as output</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co"># x_channel = 0</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x_channel <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>]):</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Selecting the channel #######################</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'X Channel name : '</span>, target_var_96_list[x_channel])</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>    X_train <span class="op">=</span> X_train_all[:, x_channel:x_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>    X_test <span class="op">=</span> X_test_all[:, x_channel:x_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>    y_train <span class="op">=</span> y_train_all[:, y_channel:y_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    y_test <span class="op">=</span> y_test_all[:, y_channel:y_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Shapes: '</span>, X_train.shape, X_test.shape, y_train.shape, y_test.shape)</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Creating the dataset loader #######################</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>    train_custom_dataset <span class="op">=</span> CustomDataset(X_train, y_train)</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_custom_dataset))</span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>    train_loader <span class="op">=</span> data.DataLoader(train_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_loader))</span></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>    test_custom_dataset <span class="op">=</span> CustomDataset(X_test, y_test)</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_custom_dataset))</span></span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>    test_loader <span class="op">=</span> data.DataLoader(test_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_loader))</span></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#################### Training the model ####################</span></span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Autoencoder_CNN(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">1</span>, num_output_channels<span class="op">=</span><span class="dv">1</span>, c_hid <span class="op">=</span> <span class="dv">8</span>, latent_dim <span class="op">=</span> <span class="dv">512</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>    model.to(device)</span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the loss function and optimizer</span></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>    criterion <span class="op">=</span> nn.MSELoss()</span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>    losses <span class="op">=</span> []</span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Training loop</span></span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>    num_epochs <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> trange(num_epochs):</span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>        model.train()  <span class="co"># Set the model to training mode</span></span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> train_loader:</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a>            optimizer.zero_grad()  <span class="co"># Zero the gradients</span></span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Backpropagation</span></span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb115-54"><a href="#cb115-54" aria-hidden="true" tabindex="-1"></a>            total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb115-55"><a href="#cb115-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-56"><a href="#cb115-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the average loss for this epoch</span></span>
<span id="cb115-57"><a href="#cb115-57" aria-hidden="true" tabindex="-1"></a>        average_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb115-58"><a href="#cb115-58" aria-hidden="true" tabindex="-1"></a>        losses.append(average_loss)</span>
<span id="cb115-59"><a href="#cb115-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb115-60"><a href="#cb115-60" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Epoch [</span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss">] Loss: </span><span class="sc">{</span>average_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb115-61"><a href="#cb115-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb115-62"><a href="#cb115-62" aria-hidden="true" tabindex="-1"></a>    <span class="co">############################# testing the model #############################</span></span>
<span id="cb115-63"><a href="#cb115-63" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb115-64"><a href="#cb115-64" aria-hidden="true" tabindex="-1"></a>    test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb115-65"><a href="#cb115-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-66"><a href="#cb115-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb115-67"><a href="#cb115-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb115-68"><a href="#cb115-68" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb115-69"><a href="#cb115-69" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb115-70"><a href="#cb115-70" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb115-71"><a href="#cb115-71" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb115-72"><a href="#cb115-72" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb115-73"><a href="#cb115-73" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb115-74"><a href="#cb115-74" aria-hidden="true" tabindex="-1"></a>            test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb115-75"><a href="#cb115-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-76"><a href="#cb115-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the average test loss</span></span>
<span id="cb115-77"><a href="#cb115-77" aria-hidden="true" tabindex="-1"></a>    average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb115-78"><a href="#cb115-78" aria-hidden="true" tabindex="-1"></a>    test_loss_list_P_25_conv_auto.append(average_test_loss)</span>
<span id="cb115-79"><a href="#cb115-79" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb115-80"><a href="#cb115-80" aria-hidden="true" tabindex="-1"></a>    plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, num_epochs <span class="op">+</span> <span class="dv">1</span>), losses)</span>
<span id="cb115-81"><a href="#cb115-81" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb115-82"><a href="#cb115-82" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb115-83"><a href="#cb115-83" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Train Loss vs. Epoch for channel '</span><span class="op">+</span>target_var_96_list[x_channel])</span>
<span id="cb115-84"><a href="#cb115-84" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>) </span>
<span id="cb115-85"><a href="#cb115-85" aria-hidden="true" tabindex="-1"></a>    plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  TSURF_K
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;02:14,  1.48it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 462.4725</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 212.0043</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:48,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 213.3173</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:40,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 234.0997</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:24&lt;00:34,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 211.7991</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:30&lt;00:29,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 216.9750</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 211.1435</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 214.2518</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 209.3667</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 208.2786</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 196.8076</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-24.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="Autoencoder_files/figure-html/cell-49-output-24.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWEW_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 540.4606</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 216.1673</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:47,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 211.7699</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 211.9133</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:34,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 214.4790</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:29,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 212.5737</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 212.8330</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 209.0824</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 207.7827</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 208.2993</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 191.6095</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-49.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="Autoencoder_files/figure-html/cell-49-output-49.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWAGE_HR
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:57,  3.49it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 590.1837</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 211.4096</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:46,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 213.1281</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 208.5330</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:33,  3.58it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 209.0068</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:28&lt;00:27,  3.61it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 211.9243</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:34&lt;00:21,  3.60it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 212.2428</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:40&lt;00:16,  3.48it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 210.3188</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:46&lt;00:11,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 211.6509</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:51&lt;00:05,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 212.8352</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:57&lt;00:00,  3.47it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 191.7548</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-74.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img src="Autoencoder_files/figure-html/cell-49-output-74.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PRATE_MMpH
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:56,  3.52it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 750.4891</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 213.9414</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:46,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 214.3703</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:41,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 209.9882</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:34,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 210.4570</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:29,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 211.3801</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:21,  3.76it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 214.6792</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 210.8055</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 214.0414</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:52&lt;00:05,  3.61it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 206.5140</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 194.9402</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-99.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37"><img src="Autoencoder_files/figure-html/cell-49-output-99.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLOUD_OD
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:54,  3.63it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 563.3871</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:05&lt;00:46,  3.82it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 63.2729</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:45,  3.51it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 23.8580</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 15.2393</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:37,  3.14it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 11.0129</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:29,  3.32it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 9.3018</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:22,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 8.1090</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 7.4336</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 8.8601</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 6.1420</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 7.4988</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-124.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="Autoencoder_files/figure-html/cell-49-output-124.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  U10_MpS
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:57,  3.48it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 684.8967</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 111.6166</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:46,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 22.6558</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 10.9635</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:35,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 12.9050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:29,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 6.2923</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 9.0327</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:16,  3.49it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 4.1764</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.52it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 3.8160</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:52&lt;00:05,  3.57it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 3.3957</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:57&lt;00:00,  3.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 3.1739</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-149.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39"><img src="Autoencoder_files/figure-html/cell-49-output-149.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  V10_MpS
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:56,  3.51it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 609.8626</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:53,  3.34it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 58.6357</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:46,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 14.3107</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:41,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 10.6218</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:35,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 6.9871</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:29,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 5.3444</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 4.6127</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 4.0642</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 3.5636</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 3.2190</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 2.9050</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-174.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="Autoencoder_files/figure-html/cell-49-output-174.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  T2_K
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:57,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 458.4550</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 213.3441</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:47,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 211.7652</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:41,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 212.4970</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:35,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 210.7104</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.52it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 208.7177</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:22,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 212.2414</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.47it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 207.2175</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:46&lt;00:11,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 211.3121</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:52&lt;00:05,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 208.7926</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 191.9081</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-198.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41"><img src="Autoencoder_files/figure-html/cell-49-output-198.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SWSFC_WpM2
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:56,  3.52it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 760.0155</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:53,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 224.7744</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:47,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 215.4670</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:41,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 214.6593</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:24&lt;00:35,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 211.3864</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 214.5846</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 215.2816</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.32it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 210.3355</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.49it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 213.1056</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 209.3009</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:59&lt;00:00,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 193.2200</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-222.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42"><img src="Autoencoder_files/figure-html/cell-49-output-222.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SOLM_M3pM3
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 518.8583</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:51,  3.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 183.2842</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:51,  3.10it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 106.5493</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:41,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 47.8360</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:24&lt;00:35,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 17.4837</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:30&lt;00:30,  3.28it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 12.6859</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:36&lt;00:23,  3.31it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 9.7521</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:42&lt;00:17,  3.30it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 8.4768</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 7.1218</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 7.4880</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 5.5514</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-247.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43"><img src="Autoencoder_files/figure-html/cell-49-output-247.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLDTOP_KM
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:57,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 603.6223</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 216.0129</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:50,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 212.5011</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:41,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 215.2624</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:24&lt;00:35,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 210.4688</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:30&lt;00:29,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 211.2793</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 208.5935</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 209.1620</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 208.9249</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 207.8753</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:59&lt;00:00,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 205.4745</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-272.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44"><img src="Autoencoder_files/figure-html/cell-49-output-272.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CAPE
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 480.7086</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 215.4105</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:46,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 211.5271</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 211.8129</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:35,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 208.5153</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 208.6479</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 215.5420</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 207.9001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 206.7139</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 208.8671</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 191.5815</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-297.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45"><img src="Autoencoder_files/figure-html/cell-49-output-297.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_WRF_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:57,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 487.6684</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:53,  3.33it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 210.6665</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:46,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 211.8588</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:41,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 209.3883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:24&lt;00:35,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 210.8873</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:29,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 209.3165</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 208.2383</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 208.4831</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 209.2067</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 207.0104</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:59&lt;00:00,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 190.8408</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-322.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46"><img src="Autoencoder_files/figure-html/cell-49-output-322.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_YSU_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 538.0652</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:53,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 213.2395</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:46,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 209.5626</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:40,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 218.8836</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:34,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 213.1157</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 211.7407</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 214.4044</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 209.6131</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 209.1906</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 207.2547</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 196.5285</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-49-output-347.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47"><img src="Autoencoder_files/figure-html/cell-49-output-347.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-69" class="cell">
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_25_conv_auto</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[196.80755892666903,
 191.6094970703125,
 191.75477183948863,
 194.94017861106178,
 7.4987756772474805,
 3.1738592061129483,
 2.9050224044106225,
 191.90811157226562,
 193.21996238014916,
 5.551396109841087,
 205.47452198375356,
 191.58150828968394,
 190.84084944291547,
 196.5285311612216]</code></pre>
</div>
</div>
<div id="cell-70" class="cell">
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a>name_loss_pairs <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(target_var_96_list, test_loss_list_P_25_conv_auto))</span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-3"><a href="#cb451-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort based on loss values</span></span>
<span id="cb451-4"><a href="#cb451-4" aria-hidden="true" tabindex="-1"></a>sorted_name_loss_pairs <span class="op">=</span> <span class="bu">sorted</span>(name_loss_pairs, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb451-5"><a href="#cb451-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs:</span>
<span id="cb451-6"><a href="#cb451-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pair)</span>
<span id="cb451-7"><a href="#cb451-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(sorted_name_loss_pairs)</span></span>
<span id="cb451-8"><a href="#cb451-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the lowest 3 names</span></span>
<span id="cb451-9"><a href="#cb451-9" aria-hidden="true" tabindex="-1"></a>lowest_3_names <span class="op">=</span> [pair[<span class="dv">0</span>] <span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs[:<span class="dv">3</span>]]</span>
<span id="cb451-10"><a href="#cb451-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb451-11"><a href="#cb451-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Lowest 3 names:"</span>, lowest_3_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>('V10_MpS', 2.9050224044106225)
('U10_MpS', 3.1738592061129483)
('SOLM_M3pM3', 5.551396109841087)
('CLOUD_OD', 7.4987756772474805)
('PBL_WRF_M', 190.84084944291547)
('CAPE', 191.58150828968394)
('SNOWEW_M', 191.6094970703125)
('SNOWAGE_HR', 191.75477183948863)
('T2_K', 191.90811157226562)
('SWSFC_WpM2', 193.21996238014916)
('PRATE_MMpH', 194.94017861106178)
('PBL_YSU_M', 196.5285311612216)
('TSURF_K', 196.80755892666903)
('CLDTOP_KM', 205.47452198375356)
Lowest 3 names: ['V10_MpS', 'U10_MpS', 'SOLM_M3pM3']</code></pre>
</div>
</div>
<div id="cell-71" class="cell">
<div class="sourceCode cell-code" id="cb453"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a>summary(model, input_size<span class="op">=</span>(<span class="dv">1000</span>, <span class="dv">1</span>, <span class="dv">80</span>, <span class="dv">80</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Autoencoder_CNN                          [1000, 1, 80, 80]         --
├─Encoder: 1-1                           [1000, 512]               --
│    └─Sequential: 2-1                   [1000, 512]               --
│    │    └─Conv2d: 3-1                  [1000, 8, 40, 40]         80
│    │    └─GELU: 3-2                    [1000, 8, 40, 40]         --
│    │    └─Conv2d: 3-3                  [1000, 8, 40, 40]         584
│    │    └─GELU: 3-4                    [1000, 8, 40, 40]         --
│    │    └─Conv2d: 3-5                  [1000, 16, 20, 20]        1,168
│    │    └─GELU: 3-6                    [1000, 16, 20, 20]        --
│    │    └─Conv2d: 3-7                  [1000, 16, 20, 20]        2,320
│    │    └─GELU: 3-8                    [1000, 16, 20, 20]        --
│    │    └─Conv2d: 3-9                  [1000, 32, 10, 10]        4,640
│    │    └─GELU: 3-10                   [1000, 32, 10, 10]        --
│    │    └─Flatten: 3-11                [1000, 3200]              --
│    │    └─Linear: 3-12                 [1000, 512]               1,638,912
├─Decoder: 1-2                           [1000, 1, 80, 80]         --
│    └─Sequential: 2-2                   [1000, 1, 80, 80]         --
│    │    └─Linear: 3-13                 [1000, 3200]              1,641,600
│    │    └─Unflatten: 3-14              [1000, 32, 10, 10]        --
│    │    └─ConvTranspose2d: 3-15        [1000, 16, 20, 20]        4,624
│    │    └─GELU: 3-16                   [1000, 16, 20, 20]        --
│    │    └─Conv2d: 3-17                 [1000, 16, 20, 20]        2,320
│    │    └─GELU: 3-18                   [1000, 16, 20, 20]        --
│    │    └─ConvTranspose2d: 3-19        [1000, 8, 40, 40]         1,160
│    │    └─GELU: 3-20                   [1000, 8, 40, 40]         --
│    │    └─Conv2d: 3-21                 [1000, 8, 40, 40]         584
│    │    └─GELU: 3-22                   [1000, 8, 40, 40]         --
│    │    └─ConvTranspose2d: 3-23        [1000, 1, 80, 80]         73
==========================================================================================
Total params: 3,298,065
Trainable params: 3,298,065
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 12.24
==========================================================================================
Input size (MB): 25.60
Forward/backward pass size (MB): 720.90
Params size (MB): 13.19
Estimated Total Size (MB): 759.69
==========================================================================================</code></pre>
</div>
</div>
</section>
<section id="single-channel-input-multiple-channel-output-p10" class="level2">
<h2 class="anchored" data-anchor-id="single-channel-input-multiple-channel-output-p10">Single channel input multiple channel output (P10)</h2>
<div id="cell-73" class="cell">
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_10_conv_auto <span class="op">=</span> []</span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a>y_channel <span class="op">=</span> <span class="dv">1</span> <span class="co"># selecting P10 as output</span></span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a><span class="co"># x_channel = 0</span></span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x_channel <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>]):</span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Selecting the channel #######################</span></span>
<span id="cb455-6"><a href="#cb455-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'X Channel name : '</span>, target_var_96_list[x_channel])</span>
<span id="cb455-7"><a href="#cb455-7" aria-hidden="true" tabindex="-1"></a>    X_train <span class="op">=</span> X_train_all[:, x_channel:x_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb455-8"><a href="#cb455-8" aria-hidden="true" tabindex="-1"></a>    X_test <span class="op">=</span> X_test_all[:, x_channel:x_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb455-9"><a href="#cb455-9" aria-hidden="true" tabindex="-1"></a>    y_train <span class="op">=</span> y_train_all[:, y_channel:y_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb455-10"><a href="#cb455-10" aria-hidden="true" tabindex="-1"></a>    y_test <span class="op">=</span> y_test_all[:, y_channel:y_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb455-11"><a href="#cb455-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Shapes: '</span>, X_train.shape, X_test.shape, y_train.shape, y_test.shape)</span>
<span id="cb455-12"><a href="#cb455-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-13"><a href="#cb455-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Creating the dataset loader #######################</span></span>
<span id="cb455-14"><a href="#cb455-14" aria-hidden="true" tabindex="-1"></a>    train_custom_dataset <span class="op">=</span> CustomDataset(X_train, y_train)</span>
<span id="cb455-15"><a href="#cb455-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_custom_dataset))</span></span>
<span id="cb455-16"><a href="#cb455-16" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb455-17"><a href="#cb455-17" aria-hidden="true" tabindex="-1"></a>    train_loader <span class="op">=</span> data.DataLoader(train_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb455-18"><a href="#cb455-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_loader))</span></span>
<span id="cb455-19"><a href="#cb455-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb455-20"><a href="#cb455-20" aria-hidden="true" tabindex="-1"></a>    test_custom_dataset <span class="op">=</span> CustomDataset(X_test, y_test)</span>
<span id="cb455-21"><a href="#cb455-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_custom_dataset))</span></span>
<span id="cb455-22"><a href="#cb455-22" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb455-23"><a href="#cb455-23" aria-hidden="true" tabindex="-1"></a>    test_loader <span class="op">=</span> data.DataLoader(test_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb455-24"><a href="#cb455-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_loader))</span></span>
<span id="cb455-25"><a href="#cb455-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb455-26"><a href="#cb455-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-27"><a href="#cb455-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#################### Training the model ####################</span></span>
<span id="cb455-28"><a href="#cb455-28" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Autoencoder_CNN(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">1</span>, num_output_channels<span class="op">=</span><span class="dv">1</span>, c_hid <span class="op">=</span> <span class="dv">8</span>, latent_dim <span class="op">=</span> <span class="dv">512</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb455-29"><a href="#cb455-29" aria-hidden="true" tabindex="-1"></a>    model.to(device)</span>
<span id="cb455-30"><a href="#cb455-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the loss function and optimizer</span></span>
<span id="cb455-31"><a href="#cb455-31" aria-hidden="true" tabindex="-1"></a>    criterion <span class="op">=</span> nn.MSELoss()</span>
<span id="cb455-32"><a href="#cb455-32" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb455-33"><a href="#cb455-33" aria-hidden="true" tabindex="-1"></a>    losses <span class="op">=</span> []</span>
<span id="cb455-34"><a href="#cb455-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Training loop</span></span>
<span id="cb455-35"><a href="#cb455-35" aria-hidden="true" tabindex="-1"></a>    num_epochs <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb455-36"><a href="#cb455-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> trange(num_epochs):</span>
<span id="cb455-37"><a href="#cb455-37" aria-hidden="true" tabindex="-1"></a>        model.train()  <span class="co"># Set the model to training mode</span></span>
<span id="cb455-38"><a href="#cb455-38" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb455-39"><a href="#cb455-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb455-40"><a href="#cb455-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> train_loader:</span>
<span id="cb455-41"><a href="#cb455-41" aria-hidden="true" tabindex="-1"></a>            optimizer.zero_grad()  <span class="co"># Zero the gradients</span></span>
<span id="cb455-42"><a href="#cb455-42" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb455-43"><a href="#cb455-43" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb455-44"><a href="#cb455-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb455-45"><a href="#cb455-45" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb455-46"><a href="#cb455-46" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb455-47"><a href="#cb455-47" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb455-48"><a href="#cb455-48" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb455-49"><a href="#cb455-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb455-50"><a href="#cb455-50" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Backpropagation</span></span>
<span id="cb455-51"><a href="#cb455-51" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb455-52"><a href="#cb455-52" aria-hidden="true" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb455-53"><a href="#cb455-53" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb455-54"><a href="#cb455-54" aria-hidden="true" tabindex="-1"></a>            total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb455-55"><a href="#cb455-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-56"><a href="#cb455-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the average loss for this epoch</span></span>
<span id="cb455-57"><a href="#cb455-57" aria-hidden="true" tabindex="-1"></a>        average_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb455-58"><a href="#cb455-58" aria-hidden="true" tabindex="-1"></a>        losses.append(average_loss)</span>
<span id="cb455-59"><a href="#cb455-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb455-60"><a href="#cb455-60" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Epoch [</span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss">] Loss: </span><span class="sc">{</span>average_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb455-61"><a href="#cb455-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb455-62"><a href="#cb455-62" aria-hidden="true" tabindex="-1"></a>    <span class="co">############################# testing the model #############################</span></span>
<span id="cb455-63"><a href="#cb455-63" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb455-64"><a href="#cb455-64" aria-hidden="true" tabindex="-1"></a>    test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb455-65"><a href="#cb455-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-66"><a href="#cb455-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb455-67"><a href="#cb455-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb455-68"><a href="#cb455-68" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb455-69"><a href="#cb455-69" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb455-70"><a href="#cb455-70" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb455-71"><a href="#cb455-71" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb455-72"><a href="#cb455-72" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb455-73"><a href="#cb455-73" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb455-74"><a href="#cb455-74" aria-hidden="true" tabindex="-1"></a>            test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb455-75"><a href="#cb455-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-76"><a href="#cb455-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the average test loss</span></span>
<span id="cb455-77"><a href="#cb455-77" aria-hidden="true" tabindex="-1"></a>    average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb455-78"><a href="#cb455-78" aria-hidden="true" tabindex="-1"></a>    test_loss_list_P_10_conv_auto.append(average_test_loss)</span>
<span id="cb455-79"><a href="#cb455-79" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb455-80"><a href="#cb455-80" aria-hidden="true" tabindex="-1"></a>    plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, num_epochs <span class="op">+</span> <span class="dv">1</span>), losses)</span>
<span id="cb455-81"><a href="#cb455-81" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb455-82"><a href="#cb455-82" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb455-83"><a href="#cb455-83" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Train Loss vs. Epoch for channel '</span><span class="op">+</span>target_var_96_list[x_channel])</span>
<span id="cb455-84"><a href="#cb455-84" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>) </span>
<span id="cb455-85"><a href="#cb455-85" aria-hidden="true" tabindex="-1"></a>    plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  TSURF_K
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:02,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 831.9463</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 413.6695</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:46,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 416.1795</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 414.0692</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:35,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 408.8671</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 408.6212</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:22,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 408.1124</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 407.2696</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 419.0648</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 411.9767</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 367.9784</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-25.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48"><img src="Autoencoder_files/figure-html/cell-53-output-25.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWEW_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1193.0016</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 413.8656</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:46,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 416.9739</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:41,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 405.7197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:35,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 414.4462</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 403.9555</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 406.6566</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 404.8177</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 414.5372</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 418.9334</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:59&lt;00:00,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 373.6601</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-50.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49"><img src="Autoencoder_files/figure-html/cell-53-output-50.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWAGE_HR
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:57,  3.48it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1176.4868</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 410.2950</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:47,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 414.8993</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 405.8627</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:34,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 416.4907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 413.8539</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 406.4541</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 404.2276</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 407.0577</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 402.6227</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 393.0328</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-75.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50"><img src="Autoencoder_files/figure-html/cell-53-output-75.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PRATE_MMpH
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:56,  3.54it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1028.3382</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:53,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 434.1988</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:46,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 412.9816</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 405.9959</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:34,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 404.1220</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 415.6019</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 403.8031</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 407.2635</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 404.3506</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 409.8351</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 367.3246</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-100.png" class="lightbox" data-gallery="quarto-lightbox-gallery-51"><img src="Autoencoder_files/figure-html/cell-53-output-100.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLOUD_OD
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:57,  3.49it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1599.0141</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:53,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 192.7198</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:47,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 68.0225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:41,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 44.4028</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:24&lt;00:35,  3.32it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 32.4964</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:30&lt;00:29,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 25.7723</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 23.6108</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 19.3957</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 19.0788</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 21.9598</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 18.7717</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-124.png" class="lightbox" data-gallery="quarto-lightbox-gallery-52"><img src="Autoencoder_files/figure-html/cell-53-output-124.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  U10_MpS
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:53,  3.73it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1023.2784</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:05&lt;00:52,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 280.1561</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:46,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 60.3793</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 29.8831</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:35,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 19.7393</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:29,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 16.8795</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 12.9342</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 11.2801</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:10,  3.56it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 10.1249</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:52&lt;00:05,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 11.3411</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 8.8163</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-149.png" class="lightbox" data-gallery="quarto-lightbox-gallery-53"><img src="Autoencoder_files/figure-html/cell-53-output-149.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  V10_MpS
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:56,  3.53it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1439.9822</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:51,  3.50it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 142.6731</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:46,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 39.2041</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:38,  3.66it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 20.6722</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:33,  3.51it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 16.5665</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:28&lt;00:28,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 12.4099</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:34&lt;00:23,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 10.8300</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:40&lt;00:17,  3.47it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 9.6913</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:46&lt;00:11,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 8.9197</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:52&lt;00:05,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 10.7642</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:57&lt;00:00,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 23.4499</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-174.png" class="lightbox" data-gallery="quarto-lightbox-gallery-54"><img src="Autoencoder_files/figure-html/cell-53-output-174.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  T2_K
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:56,  3.54it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1037.4250</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:53,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 413.2349</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:47,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 411.9822</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:41,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 406.0331</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:34,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 408.5417</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 403.6246</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 409.9414</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 402.6003</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 401.2209</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 403.0725</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 366.0120</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-198.png" class="lightbox" data-gallery="quarto-lightbox-gallery-55"><img src="Autoencoder_files/figure-html/cell-53-output-198.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SWSFC_WpM2
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:52,  3.82it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1358.9732</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 419.2162</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:46,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 413.3607</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 409.3754</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:34,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 411.0923</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 404.1099</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:22,  3.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 409.2167</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:40&lt;00:17,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 408.5509</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:46&lt;00:11,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 410.1073</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:52&lt;00:05,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 407.5864</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 364.5863</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-223.png" class="lightbox" data-gallery="quarto-lightbox-gallery-56"><img src="Autoencoder_files/figure-html/cell-53-output-223.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SOLM_M3pM3
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:56,  3.51it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1237.3417</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 337.7638</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:46,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 223.9836</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 98.1059</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:34,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 46.6351</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:29,  3.34it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 31.9773</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 26.2758</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 19.9056</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 17.7226</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 15.4444</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 14.0181</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-248.png" class="lightbox" data-gallery="quarto-lightbox-gallery-57"><img src="Autoencoder_files/figure-html/cell-53-output-248.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLDTOP_KM
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1227.4362</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:53,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 430.1239</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:46,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 414.0475</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 414.5093</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:24&lt;00:35,  3.34it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 412.3910</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 413.5266</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 408.5565</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 404.2547</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.32it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 417.1860</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 408.9205</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:59&lt;00:00,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 367.3491</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-272.png" class="lightbox" data-gallery="quarto-lightbox-gallery-58"><img src="Autoencoder_files/figure-html/cell-53-output-272.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CAPE
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:59,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1362.6006</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:54,  3.30it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 417.5348</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:46,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 409.7356</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 411.1969</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:35,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 413.3693</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:30,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 414.5004</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 405.8445</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 404.8460</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:47&lt;00:11,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 415.0352</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:53&lt;00:05,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 414.2297</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:59&lt;00:00,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 366.4497</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-296.png" class="lightbox" data-gallery="quarto-lightbox-gallery-59"><img src="Autoencoder_files/figure-html/cell-53-output-296.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_WRF_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:57,  3.47it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1069.1285</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:05&lt;00:52,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 408.2721</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:45,  3.51it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 408.3345</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:39,  3.50it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 411.1250</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:34,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 406.6349</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:29,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 409.1261</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 403.4630</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 405.4774</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:46&lt;00:11,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 403.7881</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:52&lt;00:05,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 408.1804</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 367.3865</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-321.png" class="lightbox" data-gallery="quarto-lightbox-gallery-60"><img src="Autoencoder_files/figure-html/cell-53-output-321.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_YSU_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1065.3006</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:50,  3.55it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 443.1136</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:45,  3.52it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 407.0351</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 409.3611</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:33,  3.50it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 403.8964</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 402.2005</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:22,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 402.1708</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:40&lt;00:17,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 403.3740</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:46&lt;00:11,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 398.9786</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:52&lt;00:05,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 408.3548</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 380.6446</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-53-output-346.png" class="lightbox" data-gallery="quarto-lightbox-gallery-61"><img src="Autoencoder_files/figure-html/cell-53-output-346.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-74" class="cell">
<div class="sourceCode cell-code" id="cb788"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb788-1"><a href="#cb788-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_10_conv_auto</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[367.97836858575994,
 373.660117409446,
 393.0328174937855,
 367.32460992986506,
 18.771740219809793,
 8.816288991407914,
 23.44990175420588,
 366.0119906338778,
 364.58628151633525,
 14.018102992664684,
 367.34911554509944,
 366.4497375488281,
 367.38653841885656,
 380.64462835138494]</code></pre>
</div>
</div>
<div id="cell-75" class="cell">
<div class="sourceCode cell-code" id="cb790"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb790-1"><a href="#cb790-1" aria-hidden="true" tabindex="-1"></a>name_loss_pairs <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(target_var_96_list, test_loss_list_P_10_conv_auto))</span>
<span id="cb790-2"><a href="#cb790-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-3"><a href="#cb790-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort based on loss values</span></span>
<span id="cb790-4"><a href="#cb790-4" aria-hidden="true" tabindex="-1"></a>sorted_name_loss_pairs <span class="op">=</span> <span class="bu">sorted</span>(name_loss_pairs, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb790-5"><a href="#cb790-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs:</span>
<span id="cb790-6"><a href="#cb790-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pair)</span>
<span id="cb790-7"><a href="#cb790-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(sorted_name_loss_pairs)</span></span>
<span id="cb790-8"><a href="#cb790-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the lowest 3 names</span></span>
<span id="cb790-9"><a href="#cb790-9" aria-hidden="true" tabindex="-1"></a>lowest_3_names <span class="op">=</span> [pair[<span class="dv">0</span>] <span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs[:<span class="dv">3</span>]]</span>
<span id="cb790-10"><a href="#cb790-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-11"><a href="#cb790-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Lowest 3 names:"</span>, lowest_3_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>('U10_MpS', 8.816288991407914)
('SOLM_M3pM3', 14.018102992664684)
('CLOUD_OD', 18.771740219809793)
('V10_MpS', 23.44990175420588)
('SWSFC_WpM2', 364.58628151633525)
('T2_K', 366.0119906338778)
('CAPE', 366.4497375488281)
('PRATE_MMpH', 367.32460992986506)
('CLDTOP_KM', 367.34911554509944)
('PBL_WRF_M', 367.38653841885656)
('TSURF_K', 367.97836858575994)
('SNOWEW_M', 373.660117409446)
('PBL_YSU_M', 380.64462835138494)
('SNOWAGE_HR', 393.0328174937855)
Lowest 3 names: ['U10_MpS', 'SOLM_M3pM3', 'CLOUD_OD']</code></pre>
</div>
</div>
</section>
<section id="insights-1" class="level2">
<h2 class="anchored" data-anchor-id="insights-1">Insights</h2>
<div id="cell-77" class="cell">
<div class="sourceCode cell-code" id="cb792"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb792-1"><a href="#cb792-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding values at corresponding indices</span></span>
<span id="cb792-2"><a href="#cb792-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> [(x <span class="op">+</span> y)<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(test_loss_list_P_10_conv_auto, test_loss_list_P_25_conv_auto)]</span>
<span id="cb792-3"><a href="#cb792-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-4"><a href="#cb792-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a DataFrame</span></span>
<span id="cb792-5"><a href="#cb792-5" aria-hidden="true" tabindex="-1"></a>data_frame <span class="op">=</span> {<span class="st">'Input channel'</span>: target_var_96_list, <span class="st">'P10'</span>: test_loss_list_P_10_conv_auto, <span class="st">'P25'</span>: test_loss_list_P_25_conv_auto, <span class="st">'P10+P25 avg'</span>: result}</span>
<span id="cb792-6"><a href="#cb792-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data_frame)</span>
<span id="cb792-7"><a href="#cb792-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-8"><a href="#cb792-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Sorting the DataFrame based on "List1 + List2"</span></span>
<span id="cb792-9"><a href="#cb792-9" aria-hidden="true" tabindex="-1"></a>df_sorted <span class="op">=</span> df.sort_values(by<span class="op">=</span><span class="st">'P10+P25 avg'</span>)</span>
<span id="cb792-10"><a href="#cb792-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-11"><a href="#cb792-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the sorted DataFrame</span></span>
<span id="cb792-12"><a href="#cb792-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-13"><a href="#cb792-13" aria-hidden="true" tabindex="-1"></a>df_rounded <span class="op">=</span> df_sorted.<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb792-14"><a href="#cb792-14" aria-hidden="true" tabindex="-1"></a>df_rounded.to_csv(<span class="st">'/home/rishabh.mondal/climax_alternative/Climax_2/results/test_loss_list_P_10_P25_conv_auto.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb792-15"><a href="#cb792-15" aria-hidden="true" tabindex="-1"></a>df_rounded</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Input channel</th>
<th data-quarto-table-cell-role="th">P10</th>
<th data-quarto-table-cell-role="th">P25</th>
<th data-quarto-table-cell-role="th">P10+P25 avg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>U10_MpS</td>
<td>8.8</td>
<td>3.2</td>
<td>6.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>SOLM_M3pM3</td>
<td>14.0</td>
<td>5.6</td>
<td>9.8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CLOUD_OD</td>
<td>18.8</td>
<td>7.5</td>
<td>13.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>V10_MpS</td>
<td>23.4</td>
<td>2.9</td>
<td>13.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>SWSFC_WpM2</td>
<td>364.6</td>
<td>193.2</td>
<td>278.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>T2_K</td>
<td>366.0</td>
<td>191.9</td>
<td>279.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>CAPE</td>
<td>366.4</td>
<td>191.6</td>
<td>279.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>PBL_WRF_M</td>
<td>367.4</td>
<td>190.8</td>
<td>279.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>PRATE_MMpH</td>
<td>367.3</td>
<td>194.9</td>
<td>281.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>TSURF_K</td>
<td>368.0</td>
<td>196.8</td>
<td>282.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>SNOWEW_M</td>
<td>373.7</td>
<td>191.6</td>
<td>282.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>CLDTOP_KM</td>
<td>367.3</td>
<td>205.5</td>
<td>286.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>PBL_YSU_M</td>
<td>380.6</td>
<td>196.5</td>
<td>288.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>SNOWAGE_HR</td>
<td>393.0</td>
<td>191.8</td>
<td>292.4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="training-on-top-4-channel-and-predicting-on-all-channel-conv" class="level2">
<h2 class="anchored" data-anchor-id="training-on-top-4-channel-and-predicting-on-all-channel-conv">Training on top 4 channel and predicting on all channel CONV</h2>
<div id="cell-79" class="cell">
<div class="sourceCode cell-code" id="cb793"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb793-1"><a href="#cb793-1" aria-hidden="true" tabindex="-1"></a><span class="co"># target_var_96_list =['TSURF_K',</span></span>
<span id="cb793-2"><a href="#cb793-2" aria-hidden="true" tabindex="-1"></a><span class="co">#        'SNOWEW_M', 'SNOWAGE_HR', 'PRATE_MMpH', 'CLOUD_OD', 'U10_MpS',</span></span>
<span id="cb793-3"><a href="#cb793-3" aria-hidden="true" tabindex="-1"></a><span class="co">#        'V10_MpS', 'T2_K', 'SWSFC_WpM2', 'SOLM_M3pM3', 'CLDTOP_KM', 'CAPE',</span></span>
<span id="cb793-4"><a href="#cb793-4" aria-hidden="true" tabindex="-1"></a><span class="co">#        'PBL_WRF_M', 'PBL_YSU_M']  # ['U10_MpS', 'T2_K', 'V10_MpS']</span></span>
<span id="cb793-5"><a href="#cb793-5" aria-hidden="true" tabindex="-1"></a>target_var_96_list<span class="op">=</span> [<span class="st">'V10_MpS'</span>,<span class="st">'U10_MpS'</span>,<span class="st">'SOLM_M3pM3'</span>, <span class="st">'CLOUD_OD'</span>]</span>
<span id="cb793-6"><a href="#cb793-6" aria-hidden="true" tabindex="-1"></a>target_var_120_list <span class="op">=</span> [<span class="st">'P25'</span>,<span class="st">'P10'</span>] </span>
<span id="cb793-7"><a href="#cb793-7" aria-hidden="true" tabindex="-1"></a>X,y  <span class="op">=</span> get_data(target_var_96_list, target_var_120_list)</span>
<span id="cb793-8"><a href="#cb793-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb793-9"><a href="#cb793-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb793-10"><a href="#cb793-10" aria-hidden="true" tabindex="-1"></a>X_train_all, X_test_all, y_train_all, y_test_all <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb793-11"><a href="#cb793-11" aria-hidden="true" tabindex="-1"></a>X_train_all.shape, X_test_all.shape, y_train_all.shape, y_test_all.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X shape  (1656, 4, 80, 80)
y shape (1656, 2, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>((1324, 4, 80, 80), (332, 4, 80, 80), (1324, 2, 80, 80), (332, 2, 80, 80))</code></pre>
</div>
</div>
<div id="cell-80" class="cell">
<div class="sourceCode cell-code" id="cb796"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb796-1"><a href="#cb796-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train_all.shape, X_test_all.shape, y_train_all.shape, y_test_all.shape)</span>
<span id="cb796-2"><a href="#cb796-2" aria-hidden="true" tabindex="-1"></a>train_custom_dataset <span class="op">=</span> CustomDataset(X_train_all, y_train_all)</span>
<span id="cb796-3"><a href="#cb796-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(train_custom_dataset))</span></span>
<span id="cb796-4"><a href="#cb796-4" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb796-5"><a href="#cb796-5" aria-hidden="true" tabindex="-1"></a>train_loader <span class="op">=</span> data.DataLoader(train_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb796-6"><a href="#cb796-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(train_loader))</span></span>
<span id="cb796-7"><a href="#cb796-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-8"><a href="#cb796-8" aria-hidden="true" tabindex="-1"></a>test_custom_dataset <span class="op">=</span> CustomDataset(X_test_all, y_test_all)</span>
<span id="cb796-9"><a href="#cb796-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(test_custom_dataset))</span></span>
<span id="cb796-10"><a href="#cb796-10" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb796-11"><a href="#cb796-11" aria-hidden="true" tabindex="-1"></a>test_loader <span class="op">=</span> data.DataLoader(test_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb796-12"><a href="#cb796-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(test_loader))</span></span>
<span id="cb796-13"><a href="#cb796-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-14"><a href="#cb796-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-15"><a href="#cb796-15" aria-hidden="true" tabindex="-1"></a><span class="co">#################### Training the model ####################</span></span>
<span id="cb796-16"><a href="#cb796-16" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Autoencoder_CNN(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">4</span>, num_output_channels<span class="op">=</span><span class="dv">2</span>, c_hid <span class="op">=</span> <span class="dv">64</span>, latent_dim <span class="op">=</span> <span class="dv">2048</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb796-17"><a href="#cb796-17" aria-hidden="true" tabindex="-1"></a>model.to(device) </span>
<span id="cb796-18"><a href="#cb796-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchinfo <span class="im">import</span> summary</span>
<span id="cb796-19"><a href="#cb796-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary(model, input_size<span class="op">=</span>(<span class="dv">1656</span>, <span class="dv">4</span>, <span class="dv">80</span>, <span class="dv">80</span>)))</span>
<span id="cb796-20"><a href="#cb796-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the loss function and optimizer</span></span>
<span id="cb796-21"><a href="#cb796-21" aria-hidden="true" tabindex="-1"></a>criterion <span class="op">=</span> nn.MSELoss()</span>
<span id="cb796-22"><a href="#cb796-22" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb796-23"><a href="#cb796-23" aria-hidden="true" tabindex="-1"></a>losses <span class="op">=</span> [] </span>
<span id="cb796-24"><a href="#cb796-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Training loop</span></span>
<span id="cb796-25"><a href="#cb796-25" aria-hidden="true" tabindex="-1"></a>num_epochs <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb796-26"><a href="#cb796-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> trange(num_epochs):</span>
<span id="cb796-27"><a href="#cb796-27" aria-hidden="true" tabindex="-1"></a>    model.train()  <span class="co"># Set the model to training mode</span></span>
<span id="cb796-28"><a href="#cb796-28" aria-hidden="true" tabindex="-1"></a>    total_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb796-29"><a href="#cb796-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb796-30"><a href="#cb796-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> inputs, targets <span class="kw">in</span> train_loader:</span>
<span id="cb796-31"><a href="#cb796-31" aria-hidden="true" tabindex="-1"></a>        optimizer.zero_grad()  <span class="co"># Zero the gradients</span></span>
<span id="cb796-32"><a href="#cb796-32" aria-hidden="true" tabindex="-1"></a>        inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb796-33"><a href="#cb796-33" aria-hidden="true" tabindex="-1"></a>        targets <span class="op">=</span> targets.to(device)</span>
<span id="cb796-34"><a href="#cb796-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward pass</span></span>
<span id="cb796-35"><a href="#cb796-35" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(inputs)</span>
<span id="cb796-36"><a href="#cb796-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb796-37"><a href="#cb796-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate the loss</span></span>
<span id="cb796-38"><a href="#cb796-38" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb796-39"><a href="#cb796-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb796-40"><a href="#cb796-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Backpropagation</span></span>
<span id="cb796-41"><a href="#cb796-41" aria-hidden="true" tabindex="-1"></a>        loss.backward()</span>
<span id="cb796-42"><a href="#cb796-42" aria-hidden="true" tabindex="-1"></a>        optimizer.step()</span>
<span id="cb796-43"><a href="#cb796-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb796-44"><a href="#cb796-44" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb796-45"><a href="#cb796-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-46"><a href="#cb796-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the average loss for this epoch</span></span>
<span id="cb796-47"><a href="#cb796-47" aria-hidden="true" tabindex="-1"></a>    average_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb796-48"><a href="#cb796-48" aria-hidden="true" tabindex="-1"></a>    losses.append(average_loss)</span>
<span id="cb796-49"><a href="#cb796-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>: </span>
<span id="cb796-50"><a href="#cb796-50" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Epoch [</span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss">] Loss: </span><span class="sc">{</span>average_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb796-51"><a href="#cb796-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-52"><a href="#cb796-52" aria-hidden="true" tabindex="-1"></a><span class="co">############################# testing the model #############################</span></span>
<span id="cb796-53"><a href="#cb796-53" aria-hidden="true" tabindex="-1"></a>        model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb796-54"><a href="#cb796-54" aria-hidden="true" tabindex="-1"></a>        test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb796-55"><a href="#cb796-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-56"><a href="#cb796-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb796-57"><a href="#cb796-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb796-58"><a href="#cb796-58" aria-hidden="true" tabindex="-1"></a>                inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb796-59"><a href="#cb796-59" aria-hidden="true" tabindex="-1"></a>                targets <span class="op">=</span> targets.to(device)</span>
<span id="cb796-60"><a href="#cb796-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-61"><a href="#cb796-61" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Forward pass</span></span>
<span id="cb796-62"><a href="#cb796-62" aria-hidden="true" tabindex="-1"></a>                outputs <span class="op">=</span> model(inputs)</span>
<span id="cb796-63"><a href="#cb796-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-64"><a href="#cb796-64" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Calculate the loss</span></span>
<span id="cb796-65"><a href="#cb796-65" aria-hidden="true" tabindex="-1"></a>                loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb796-66"><a href="#cb796-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-67"><a href="#cb796-67" aria-hidden="true" tabindex="-1"></a>                test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb796-68"><a href="#cb796-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-69"><a href="#cb796-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the average test loss</span></span>
<span id="cb796-70"><a href="#cb796-70" aria-hidden="true" tabindex="-1"></a>        average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb796-71"><a href="#cb796-71" aria-hidden="true" tabindex="-1"></a>        <span class="co"># test_loss_list_P_25.append(average_test_loss)</span></span>
<span id="cb796-72"><a href="#cb796-72" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb796-73"><a href="#cb796-73" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb796-74"><a href="#cb796-74" aria-hidden="true" tabindex="-1"></a>test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb796-75"><a href="#cb796-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-76"><a href="#cb796-76" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb796-77"><a href="#cb796-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb796-78"><a href="#cb796-78" aria-hidden="true" tabindex="-1"></a>        inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb796-79"><a href="#cb796-79" aria-hidden="true" tabindex="-1"></a>        targets <span class="op">=</span> targets.to(device)</span>
<span id="cb796-80"><a href="#cb796-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-81"><a href="#cb796-81" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward pass</span></span>
<span id="cb796-82"><a href="#cb796-82" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(inputs)</span>
<span id="cb796-83"><a href="#cb796-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-84"><a href="#cb796-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate the loss</span></span>
<span id="cb796-85"><a href="#cb796-85" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb796-86"><a href="#cb796-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-87"><a href="#cb796-87" aria-hidden="true" tabindex="-1"></a>        test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb796-88"><a href="#cb796-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-89"><a href="#cb796-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the average test loss</span></span>
<span id="cb796-90"><a href="#cb796-90" aria-hidden="true" tabindex="-1"></a>average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb796-91"><a href="#cb796-91" aria-hidden="true" tabindex="-1"></a><span class="co"># test_loss_list_P_25.append(average_test_loss)</span></span>
<span id="cb796-92"><a href="#cb796-92" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb796-93"><a href="#cb796-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb796-94"><a href="#cb796-94" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, num_epochs <span class="op">+</span> <span class="dv">1</span>), losses)</span>
<span id="cb796-95"><a href="#cb796-95" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb796-96"><a href="#cb796-96" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb796-97"><a href="#cb796-97" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.title('Train Loss vs. Epoch for channel '+target_var_96_list[x_channel])</span></span>
<span id="cb796-98"><a href="#cb796-98" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>) </span>
<span id="cb796-99"><a href="#cb796-99" aria-hidden="true" tabindex="-1"></a>plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1324, 4, 80, 80) (332, 4, 80, 80) (1324, 2, 80, 80) (332, 2, 80, 80)
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Autoencoder_CNN                          [1656, 2, 80, 80]         --
├─Encoder: 1-1                           [1656, 2048]              --
│    └─Sequential: 2-1                   [1656, 2048]              --
│    │    └─Conv2d: 3-1                  [1656, 64, 40, 40]        2,368
│    │    └─GELU: 3-2                    [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-3                  [1656, 64, 40, 40]        36,928
│    │    └─GELU: 3-4                    [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-5                  [1656, 128, 20, 20]       73,856
│    │    └─GELU: 3-6                    [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-7                  [1656, 128, 20, 20]       147,584
│    │    └─GELU: 3-8                    [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-9                  [1656, 256, 10, 10]       295,168
│    │    └─GELU: 3-10                   [1656, 256, 10, 10]       --
│    │    └─Flatten: 3-11                [1656, 25600]             --
│    │    └─Linear: 3-12                 [1656, 2048]              52,430,848
├─Decoder: 1-2                           [1656, 2, 80, 80]         --
│    └─Sequential: 2-2                   [1656, 2, 80, 80]         --
│    │    └─Linear: 3-13                 [1656, 25600]             52,454,400
│    │    └─Unflatten: 3-14              [1656, 256, 10, 10]       --
│    │    └─ConvTranspose2d: 3-15        [1656, 128, 20, 20]       295,040
│    │    └─GELU: 3-16                   [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-17                 [1656, 128, 20, 20]       147,584
│    │    └─GELU: 3-18                   [1656, 128, 20, 20]       --
│    │    └─ConvTranspose2d: 3-19        [1656, 64, 40, 40]        73,792
│    │    └─GELU: 3-20                   [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-21                 [1656, 64, 40, 40]        36,928
│    │    └─GELU: 3-22                   [1656, 64, 40, 40]        --
│    │    └─ConvTranspose2d: 3-23        [1656, 2, 80, 80]         1,154
==========================================================================================
Total params: 105,995,650
Trainable params: 105,995,650
Non-trainable params: 0
Total mult-adds (Units.TERABYTES): 1.07
==========================================================================================
Input size (MB): 169.57
Forward/backward pass size (MB): 9014.58
Params size (MB): 423.98
Estimated Total Size (MB): 9608.13
==========================================================================================</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  1%|▏         | 1/80 [00:02&lt;02:40,  2.03s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/80] Loss: 1343.9761
Average Test Loss: 313.2759</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 26%|██▋       | 21/80 [00:35&lt;01:40,  1.71s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/80] Loss: 51.4848
Average Test Loss: 41.3688</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 51%|█████▏    | 41/80 [01:09&lt;01:07,  1.72s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/80] Loss: 19.3960
Average Test Loss: 15.7720</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 76%|███████▋  | 61/80 [01:43&lt;00:32,  1.71s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/80] Loss: 10.1627
Average Test Loss: 6.6679</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 80/80 [02:15&lt;00:00,  1.70s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 3.3631</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-58-output-12.png" class="lightbox" data-gallery="quarto-lightbox-gallery-62"><img src="Autoencoder_files/figure-html/cell-58-output-12.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-81" class="cell">
<div class="sourceCode cell-code" id="cb808"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb808-1"><a href="#cb808-1" aria-hidden="true" tabindex="-1"></a>torch.save(model.state_dict(), <span class="st">'model/auto_conv_in4_out2.pt'</span>)</span>
<span id="cb808-2"><a href="#cb808-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Autoencoder_CNN(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">4</span>, num_output_channels<span class="op">=</span><span class="dv">2</span>, c_hid <span class="op">=</span> <span class="dv">64</span>, latent_dim <span class="op">=</span> <span class="dv">2048</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb808-3"><a href="#cb808-3" aria-hidden="true" tabindex="-1"></a>model.to(device) </span>
<span id="cb808-4"><a href="#cb808-4" aria-hidden="true" tabindex="-1"></a>model.load_state_dict(torch.load(<span class="st">'model/auto_conv_in4_out2.pt'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;All keys matched successfully&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="unet-autoencoder-with-convolutional-layers" class="level1">
<h1>UNET Autoencoder with convolutional layers</h1>
<section id="model-defination-2" class="level2">
<h2 class="anchored" data-anchor-id="model-defination-2">Model defination</h2>
<p><img src="../images/autoencoder/Unet_architecture.png" width="800"></p>
<div id="cell-86" class="cell">
<div class="sourceCode cell-code" id="cb810"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb810-1"><a href="#cb810-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Encoder(nn.Module):</span>
<span id="cb810-2"><a href="#cb810-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, image_size, num_input_channels, num_output_channels <span class="op">=</span> <span class="dv">1</span>, c_hid <span class="op">=</span> <span class="dv">16</span>, latent_dim <span class="op">=</span> <span class="dv">1024</span>, activation<span class="op">=</span> nn.GELU):</span>
<span id="cb810-3"><a href="#cb810-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(Encoder, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb810-4"><a href="#cb810-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.image_size <span class="op">=</span> image_size</span>
<span id="cb810-5"><a href="#cb810-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_input_channels <span class="op">=</span> num_input_channels</span>
<span id="cb810-6"><a href="#cb810-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_output_channels <span class="op">=</span> num_output_channels</span>
<span id="cb810-7"><a href="#cb810-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_hid <span class="op">=</span> c_hid</span>
<span id="cb810-8"><a href="#cb810-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.latent_dim <span class="op">=</span> latent_dim</span>
<span id="cb810-9"><a href="#cb810-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.activation <span class="op">=</span> activation</span>
<span id="cb810-10"><a href="#cb810-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.net <span class="op">=</span> nn.Sequential(</span>
<span id="cb810-11"><a href="#cb810-11" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels<span class="op">=</span><span class="va">self</span>.num_input_channels, out_channels<span class="op">=</span><span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb810-12"><a href="#cb810-12" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb810-13"><a href="#cb810-13" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels<span class="op">=</span><span class="va">self</span>.c_hid, out_channels<span class="op">=</span><span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb810-14"><a href="#cb810-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb810-15"><a href="#cb810-15" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels<span class="op">=</span><span class="va">self</span>.c_hid, out_channels<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb810-16"><a href="#cb810-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb810-17"><a href="#cb810-17" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.c_hid, out_channels<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb810-18"><a href="#cb810-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb810-19"><a href="#cb810-19" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels<span class="op">=</span><span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.c_hid, out_channels<span class="op">=</span><span class="dv">4</span><span class="op">*</span><span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb810-20"><a href="#cb810-20" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb810-21"><a href="#cb810-21" aria-hidden="true" tabindex="-1"></a>            nn.Flatten(),</span>
<span id="cb810-22"><a href="#cb810-22" aria-hidden="true" tabindex="-1"></a>            nn.Linear((<span class="dv">4</span> <span class="op">*</span> <span class="va">self</span>.c_hid) <span class="op">*</span> <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span> <span class="op">*</span> <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span>, <span class="va">self</span>.latent_dim)</span>
<span id="cb810-23"><a href="#cb810-23" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb810-24"><a href="#cb810-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb810-25"><a href="#cb810-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.net(x)</span>
<span id="cb810-26"><a href="#cb810-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb810-27"><a href="#cb810-27" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Decoder(nn.Module):</span>
<span id="cb810-28"><a href="#cb810-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, image_size, num_input_channels, num_output_channels <span class="op">=</span> <span class="dv">1</span>,c_hid <span class="op">=</span> <span class="dv">16</span>, latent_dim <span class="op">=</span> <span class="dv">1024</span>, activation<span class="op">=</span> nn.GELU):</span>
<span id="cb810-29"><a href="#cb810-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(Decoder, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb810-30"><a href="#cb810-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.image_size <span class="op">=</span> image_size</span>
<span id="cb810-31"><a href="#cb810-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_input_channels <span class="op">=</span> num_input_channels</span>
<span id="cb810-32"><a href="#cb810-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_output_channels <span class="op">=</span> num_output_channels</span>
<span id="cb810-33"><a href="#cb810-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_hid <span class="op">=</span> c_hid</span>
<span id="cb810-34"><a href="#cb810-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.latent_dim <span class="op">=</span> latent_dim</span>
<span id="cb810-35"><a href="#cb810-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.activation <span class="op">=</span> activation</span>
<span id="cb810-36"><a href="#cb810-36" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.decoder <span class="op">=</span> nn.Sequential(</span>
<span id="cb810-37"><a href="#cb810-37" aria-hidden="true" tabindex="-1"></a>            nn.Linear(<span class="va">self</span>.latent_dim, (<span class="dv">4</span> <span class="op">*</span> <span class="va">self</span>.c_hid) <span class="op">*</span> <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span> <span class="op">*</span> <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span>),</span>
<span id="cb810-38"><a href="#cb810-38" aria-hidden="true" tabindex="-1"></a>            nn.Unflatten(<span class="dv">1</span>, (<span class="dv">4</span><span class="op">*</span><span class="va">self</span>.c_hid, <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span>, <span class="va">self</span>.image_size<span class="op">//</span><span class="dv">8</span>)),</span>
<span id="cb810-39"><a href="#cb810-39" aria-hidden="true" tabindex="-1"></a>            nn.ConvTranspose2d(in_channels<span class="op">=</span><span class="dv">4</span><span class="op">*</span><span class="va">self</span>.c_hid, out_channels<span class="op">=</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>, output_padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb810-40"><a href="#cb810-40" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb810-41"><a href="#cb810-41" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels <span class="op">=</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.c_hid, out_channels<span class="op">=</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb810-42"><a href="#cb810-42" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb810-43"><a href="#cb810-43" aria-hidden="true" tabindex="-1"></a>            nn.ConvTranspose2d(in_channels <span class="op">=</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.c_hid, out_channels <span class="op">=</span> <span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>, output_padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb810-44"><a href="#cb810-44" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb810-45"><a href="#cb810-45" aria-hidden="true" tabindex="-1"></a>            nn.Conv2d(in_channels <span class="op">=</span> <span class="va">self</span>.c_hid,out_channels<span class="op">=</span> <span class="va">self</span>.c_hid, kernel_size<span class="op">=</span><span class="dv">3</span>, padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb810-46"><a href="#cb810-46" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.activation(),</span>
<span id="cb810-47"><a href="#cb810-47" aria-hidden="true" tabindex="-1"></a>            nn.ConvTranspose2d(in_channels <span class="op">=</span> <span class="va">self</span>.c_hid, out_channels<span class="op">=</span> <span class="va">self</span>.num_output_channels, kernel_size<span class="op">=</span><span class="dv">3</span>, stride<span class="op">=</span><span class="dv">2</span>, padding<span class="op">=</span><span class="dv">1</span>, output_padding<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb810-48"><a href="#cb810-48" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb810-49"><a href="#cb810-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb810-50"><a href="#cb810-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.decoder(x)</span>
<span id="cb810-51"><a href="#cb810-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb810-52"><a href="#cb810-52" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Autoencoder_UNET(nn.Module):</span>
<span id="cb810-53"><a href="#cb810-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, image_size, num_input_channels, num_output_channels <span class="op">=</span> <span class="dv">1</span>,c_hid <span class="op">=</span> <span class="dv">16</span>, latent_dim <span class="op">=</span> <span class="dv">1024</span>, activation<span class="op">=</span> nn.GELU, encoder <span class="op">=</span> Encoder, decoder <span class="op">=</span> Decoder):</span>
<span id="cb810-54"><a href="#cb810-54" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(Autoencoder_UNET, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb810-55"><a href="#cb810-55" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.image_size <span class="op">=</span> image_size</span>
<span id="cb810-56"><a href="#cb810-56" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_input_channels <span class="op">=</span> num_input_channels</span>
<span id="cb810-57"><a href="#cb810-57" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_output_channels <span class="op">=</span> num_output_channels</span>
<span id="cb810-58"><a href="#cb810-58" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c_hid <span class="op">=</span> c_hid</span>
<span id="cb810-59"><a href="#cb810-59" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.latent_dim <span class="op">=</span> latent_dim</span>
<span id="cb810-60"><a href="#cb810-60" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.activation <span class="op">=</span> activation</span>
<span id="cb810-61"><a href="#cb810-61" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.encoder <span class="op">=</span> encoder(<span class="va">self</span>.image_size, <span class="va">self</span>.num_input_channels, <span class="va">self</span>.num_output_channels, <span class="va">self</span>.c_hid, <span class="va">self</span>.latent_dim, <span class="va">self</span>.activation)</span>
<span id="cb810-62"><a href="#cb810-62" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.decoder <span class="op">=</span> decoder(<span class="va">self</span>.image_size, <span class="va">self</span>.num_input_channels, <span class="va">self</span>.num_output_channels, <span class="va">self</span>.c_hid, <span class="va">self</span>.latent_dim, <span class="va">self</span>.activation)</span>
<span id="cb810-63"><a href="#cb810-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># def forward(self, x):</span></span>
<span id="cb810-64"><a href="#cb810-64" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     x = self.encoder(x)</span></span>
<span id="cb810-65"><a href="#cb810-65" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     # print(x.shape)</span></span>
<span id="cb810-66"><a href="#cb810-66" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     x = self.decoder(x)</span></span>
<span id="cb810-67"><a href="#cb810-67" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     return x</span></span>
<span id="cb810-68"><a href="#cb810-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb810-69"><a href="#cb810-69" aria-hidden="true" tabindex="-1"></a>        conv1 <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">0</span>]</span>
<span id="cb810-70"><a href="#cb810-70" aria-hidden="true" tabindex="-1"></a>        activation1 <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">1</span>]</span>
<span id="cb810-71"><a href="#cb810-71" aria-hidden="true" tabindex="-1"></a>        conv2 <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">2</span>]</span>
<span id="cb810-72"><a href="#cb810-72" aria-hidden="true" tabindex="-1"></a>        activation2 <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">3</span>]</span>
<span id="cb810-73"><a href="#cb810-73" aria-hidden="true" tabindex="-1"></a>        conv3 <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">4</span>]</span>
<span id="cb810-74"><a href="#cb810-74" aria-hidden="true" tabindex="-1"></a>        activation3 <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">5</span>]</span>
<span id="cb810-75"><a href="#cb810-75" aria-hidden="true" tabindex="-1"></a>        conv4 <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">6</span>]</span>
<span id="cb810-76"><a href="#cb810-76" aria-hidden="true" tabindex="-1"></a>        activation4 <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">7</span>]</span>
<span id="cb810-77"><a href="#cb810-77" aria-hidden="true" tabindex="-1"></a>        conv5 <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">8</span>]</span>
<span id="cb810-78"><a href="#cb810-78" aria-hidden="true" tabindex="-1"></a>        activation5 <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">9</span>]</span>
<span id="cb810-79"><a href="#cb810-79" aria-hidden="true" tabindex="-1"></a>        flatten <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">10</span>]</span>
<span id="cb810-80"><a href="#cb810-80" aria-hidden="true" tabindex="-1"></a>        linear <span class="op">=</span> <span class="va">self</span>.encoder.net[<span class="dv">11</span>]</span>
<span id="cb810-81"><a href="#cb810-81" aria-hidden="true" tabindex="-1"></a>        lineart <span class="op">=</span> <span class="va">self</span>.decoder.decoder[<span class="dv">0</span>]</span>
<span id="cb810-82"><a href="#cb810-82" aria-hidden="true" tabindex="-1"></a>        unflattent <span class="op">=</span> <span class="va">self</span>.decoder.decoder[<span class="dv">1</span>]</span>
<span id="cb810-83"><a href="#cb810-83" aria-hidden="true" tabindex="-1"></a>        convt2 <span class="op">=</span> <span class="va">self</span>.decoder.decoder[<span class="dv">2</span>]</span>
<span id="cb810-84"><a href="#cb810-84" aria-hidden="true" tabindex="-1"></a>        activation7 <span class="op">=</span> <span class="va">self</span>.decoder.decoder[<span class="dv">3</span>]</span>
<span id="cb810-85"><a href="#cb810-85" aria-hidden="true" tabindex="-1"></a>        convt3 <span class="op">=</span> <span class="va">self</span>.decoder.decoder[<span class="dv">4</span>]</span>
<span id="cb810-86"><a href="#cb810-86" aria-hidden="true" tabindex="-1"></a>        activation8 <span class="op">=</span> <span class="va">self</span>.decoder.decoder[<span class="dv">5</span>]</span>
<span id="cb810-87"><a href="#cb810-87" aria-hidden="true" tabindex="-1"></a>        convt4 <span class="op">=</span> <span class="va">self</span>.decoder.decoder[<span class="dv">6</span>]</span>
<span id="cb810-88"><a href="#cb810-88" aria-hidden="true" tabindex="-1"></a>        activation9 <span class="op">=</span> <span class="va">self</span>.decoder.decoder[<span class="dv">7</span>]</span>
<span id="cb810-89"><a href="#cb810-89" aria-hidden="true" tabindex="-1"></a>        convt5 <span class="op">=</span> <span class="va">self</span>.decoder.decoder[<span class="dv">8</span>]</span>
<span id="cb810-90"><a href="#cb810-90" aria-hidden="true" tabindex="-1"></a>        activation10 <span class="op">=</span> <span class="va">self</span>.decoder.decoder[<span class="dv">9</span>]</span>
<span id="cb810-91"><a href="#cb810-91" aria-hidden="true" tabindex="-1"></a>        convt6 <span class="op">=</span> <span class="va">self</span>.decoder.decoder[<span class="dv">10</span>]</span>
<span id="cb810-92"><a href="#cb810-92" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> activation1(conv1(x))</span>
<span id="cb810-93"><a href="#cb810-93" aria-hidden="true" tabindex="-1"></a>        x2 <span class="op">=</span> activation2(conv2(x1))</span>
<span id="cb810-94"><a href="#cb810-94" aria-hidden="true" tabindex="-1"></a>        x3 <span class="op">=</span> activation3(conv3(x2))</span>
<span id="cb810-95"><a href="#cb810-95" aria-hidden="true" tabindex="-1"></a>        x4 <span class="op">=</span> activation4(conv4(x3))</span>
<span id="cb810-96"><a href="#cb810-96" aria-hidden="true" tabindex="-1"></a>        x5 <span class="op">=</span> activation5(conv5(x4))</span>
<span id="cb810-97"><a href="#cb810-97" aria-hidden="true" tabindex="-1"></a>        x6 <span class="op">=</span> flatten(x5)</span>
<span id="cb810-98"><a href="#cb810-98" aria-hidden="true" tabindex="-1"></a>        x7 <span class="op">=</span> linear(x6)</span>
<span id="cb810-99"><a href="#cb810-99" aria-hidden="true" tabindex="-1"></a>        x8 <span class="op">=</span> lineart(x7)</span>
<span id="cb810-100"><a href="#cb810-100" aria-hidden="true" tabindex="-1"></a>        x9 <span class="op">=</span> unflattent(x8)</span>
<span id="cb810-101"><a href="#cb810-101" aria-hidden="true" tabindex="-1"></a>        x10 <span class="op">=</span> activation7(convt2(x9<span class="op">+</span>x5))</span>
<span id="cb810-102"><a href="#cb810-102" aria-hidden="true" tabindex="-1"></a>        x11 <span class="op">=</span> activation8(convt3(x10<span class="op">+</span>x4))</span>
<span id="cb810-103"><a href="#cb810-103" aria-hidden="true" tabindex="-1"></a>        x12 <span class="op">=</span> activation9(convt4(x11<span class="op">+</span>x3))</span>
<span id="cb810-104"><a href="#cb810-104" aria-hidden="true" tabindex="-1"></a>        x13 <span class="op">=</span> activation10(convt5(x12<span class="op">+</span>x2))</span>
<span id="cb810-105"><a href="#cb810-105" aria-hidden="true" tabindex="-1"></a>        x13 <span class="op">=</span> convt6(x13<span class="op">+</span>x1)</span>
<span id="cb810-106"><a href="#cb810-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x13</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-87" class="cell">
<div class="sourceCode cell-code" id="cb811"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb811-1"><a href="#cb811-1" aria-hidden="true" tabindex="-1"></a>model_auto <span class="op">=</span> Autoencoder_UNET(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">14</span>, num_output_channels<span class="op">=</span><span class="dv">2</span>, c_hid <span class="op">=</span> <span class="dv">16</span>, latent_dim <span class="op">=</span> <span class="dv">1024</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb811-2"><a href="#cb811-2" aria-hidden="true" tabindex="-1"></a>model_auto</span>
<span id="cb811-3"><a href="#cb811-3" aria-hidden="true" tabindex="-1"></a>dummy_input <span class="op">=</span> torch.randn(<span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">80</span>, <span class="dv">80</span>)  <span class="co"># Assuming input size of (batch_size, num_num_input_channels, height, width)</span></span>
<span id="cb811-4"><a href="#cb811-4" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> model_auto(dummy_input)</span>
<span id="cb811-5"><a href="#cb811-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(out.shape)    </span>
<span id="cb811-6"><a href="#cb811-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_auto)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([11, 2, 80, 80])
Autoencoder_UNET(
  (encoder): Encoder(
    (net): Sequential(
      (0): Conv2d(14, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      (1): GELU(approximate='none')
      (2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (3): GELU(approximate='none')
      (4): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      (5): GELU(approximate='none')
      (6): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (7): GELU(approximate='none')
      (8): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
      (9): GELU(approximate='none')
      (10): Flatten(start_dim=1, end_dim=-1)
      (11): Linear(in_features=6400, out_features=1024, bias=True)
    )
  )
  (decoder): Decoder(
    (decoder): Sequential(
      (0): Linear(in_features=1024, out_features=6400, bias=True)
      (1): Unflatten(dim=1, unflattened_size=(64, 10, 10))
      (2): ConvTranspose2d(64, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), output_padding=(1, 1))
      (3): GELU(approximate='none')
      (4): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (5): GELU(approximate='none')
      (6): ConvTranspose2d(32, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), output_padding=(1, 1))
      (7): GELU(approximate='none')
      (8): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (9): GELU(approximate='none')
      (10): ConvTranspose2d(16, 2, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), output_padding=(1, 1))
    )
  )
)</code></pre>
</div>
</div>
<div id="cell-88" class="cell">
<div class="sourceCode cell-code" id="cb813"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb813-1"><a href="#cb813-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchinfo <span class="im">import</span> summary</span>
<span id="cb813-2"><a href="#cb813-2" aria-hidden="true" tabindex="-1"></a>summary(model_auto, input_size<span class="op">=</span>(<span class="dv">1656</span>, <span class="dv">14</span>, <span class="dv">80</span>, <span class="dv">80</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Autoencoder_UNET                         [1656, 2, 80, 80]         --
├─Encoder: 1-1                           --                        --
│    └─Sequential: 2-1                   --                        --
│    │    └─Conv2d: 3-1                  [1656, 16, 40, 40]        2,032
│    │    └─GELU: 3-2                    [1656, 16, 40, 40]        --
│    │    └─Conv2d: 3-3                  [1656, 16, 40, 40]        2,320
│    │    └─GELU: 3-4                    [1656, 16, 40, 40]        --
│    │    └─Conv2d: 3-5                  [1656, 32, 20, 20]        4,640
│    │    └─GELU: 3-6                    [1656, 32, 20, 20]        --
│    │    └─Conv2d: 3-7                  [1656, 32, 20, 20]        9,248
│    │    └─GELU: 3-8                    [1656, 32, 20, 20]        --
│    │    └─Conv2d: 3-9                  [1656, 64, 10, 10]        18,496
│    │    └─GELU: 3-10                   [1656, 64, 10, 10]        --
│    │    └─Flatten: 3-11                [1656, 6400]              --
│    │    └─Linear: 3-12                 [1656, 1024]              6,554,624
├─Decoder: 1-2                           --                        --
│    └─Sequential: 2-2                   --                        --
│    │    └─Linear: 3-13                 [1656, 6400]              6,560,000
│    │    └─Unflatten: 3-14              [1656, 64, 10, 10]        --
│    │    └─ConvTranspose2d: 3-15        [1656, 32, 20, 20]        18,464
│    │    └─GELU: 3-16                   [1656, 32, 20, 20]        --
│    │    └─Conv2d: 3-17                 [1656, 32, 20, 20]        9,248
│    │    └─GELU: 3-18                   [1656, 32, 20, 20]        --
│    │    └─ConvTranspose2d: 3-19        [1656, 16, 40, 40]        4,624
│    │    └─GELU: 3-20                   [1656, 16, 40, 40]        --
│    │    └─Conv2d: 3-21                 [1656, 16, 40, 40]        2,320
│    │    └─GELU: 3-22                   [1656, 16, 40, 40]        --
│    │    └─ConvTranspose2d: 3-23        [1656, 2, 80, 80]         290
==========================================================================================
Total params: 13,186,306
Trainable params: 13,186,306
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 85.34
==========================================================================================
Input size (MB): 593.51
Forward/backward pass size (MB): 2387.61
Params size (MB): 52.75
Estimated Total Size (MB): 3033.86
==========================================================================================</code></pre>
</div>
</div>
<div id="cell-89" class="cell">
<div class="sourceCode cell-code" id="cb815"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb815-1"><a href="#cb815-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchsummary <span class="im">import</span> summary</span>
<span id="cb815-2"><a href="#cb815-2" aria-hidden="true" tabindex="-1"></a>summary(model_auto, input_size<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">80</span>, <span class="dv">80</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1           [-1, 16, 40, 40]           2,032
              GELU-2           [-1, 16, 40, 40]               0
            Conv2d-3           [-1, 16, 40, 40]           2,320
              GELU-4           [-1, 16, 40, 40]               0
            Conv2d-5           [-1, 32, 20, 20]           4,640
              GELU-6           [-1, 32, 20, 20]               0
            Conv2d-7           [-1, 32, 20, 20]           9,248
              GELU-8           [-1, 32, 20, 20]               0
            Conv2d-9           [-1, 64, 10, 10]          18,496
             GELU-10           [-1, 64, 10, 10]               0
          Flatten-11                 [-1, 6400]               0
           Linear-12                 [-1, 1024]       6,554,624
           Linear-13                 [-1, 6400]       6,560,000
        Unflatten-14           [-1, 64, 10, 10]               0
  ConvTranspose2d-15           [-1, 32, 20, 20]          18,464
             GELU-16           [-1, 32, 20, 20]               0
           Conv2d-17           [-1, 32, 20, 20]           9,248
             GELU-18           [-1, 32, 20, 20]               0
  ConvTranspose2d-19           [-1, 16, 40, 40]           4,624
             GELU-20           [-1, 16, 40, 40]               0
           Conv2d-21           [-1, 16, 40, 40]           2,320
             GELU-22           [-1, 16, 40, 40]               0
  ConvTranspose2d-23            [-1, 2, 80, 80]             290
================================================================
Total params: 13,186,306
Trainable params: 13,186,306
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.34
Forward/backward pass size (MB): 2.69
Params size (MB): 50.30
Estimated Total Size (MB): 53.34
----------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="training-on-all-channel-and-predicting-on-all-channel-unet" class="level2">
<h2 class="anchored" data-anchor-id="training-on-all-channel-and-predicting-on-all-channel-unet">Training on all channel and predicting on all channel UNET</h2>
<div id="cell-91" class="cell">
<div class="sourceCode cell-code" id="cb817"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb817-1"><a href="#cb817-1" aria-hidden="true" tabindex="-1"></a>target_var_96_list <span class="op">=</span>[<span class="st">'TSURF_K'</span>,</span>
<span id="cb817-2"><a href="#cb817-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'SNOWEW_M'</span>, <span class="st">'SNOWAGE_HR'</span>, <span class="st">'PRATE_MMpH'</span>, <span class="st">'CLOUD_OD'</span>, <span class="st">'U10_MpS'</span>,</span>
<span id="cb817-3"><a href="#cb817-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'V10_MpS'</span>, <span class="st">'T2_K'</span>, <span class="st">'SWSFC_WpM2'</span>, <span class="st">'SOLM_M3pM3'</span>, <span class="st">'CLDTOP_KM'</span>, <span class="st">'CAPE'</span>,</span>
<span id="cb817-4"><a href="#cb817-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'PBL_WRF_M'</span>, <span class="st">'PBL_YSU_M'</span>]  <span class="co"># ['U10_MpS', 'T2_K', 'V10_MpS']</span></span>
<span id="cb817-5"><a href="#cb817-5" aria-hidden="true" tabindex="-1"></a>target_var_120_list <span class="op">=</span> [<span class="st">'P25'</span>,<span class="st">'P10'</span>] </span>
<span id="cb817-6"><a href="#cb817-6" aria-hidden="true" tabindex="-1"></a>X,y  <span class="op">=</span> get_data(target_var_96_list, target_var_120_list)</span>
<span id="cb817-7"><a href="#cb817-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb817-8"><a href="#cb817-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb817-9"><a href="#cb817-9" aria-hidden="true" tabindex="-1"></a>X_train_all, X_test_all, y_train_all, y_test_all <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb817-10"><a href="#cb817-10" aria-hidden="true" tabindex="-1"></a>X_train_all.shape, X_test_all.shape, y_train_all.shape, y_test_all.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X shape  (1656, 14, 80, 80)
y shape (1656, 2, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>((1324, 14, 80, 80), (332, 14, 80, 80), (1324, 2, 80, 80), (332, 2, 80, 80))</code></pre>
</div>
</div>
<div id="cell-92" class="cell">
<div class="sourceCode cell-code" id="cb820"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb820-1"><a href="#cb820-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train_all.shape, X_test_all.shape, y_train_all.shape, y_test_all.shape)</span>
<span id="cb820-2"><a href="#cb820-2" aria-hidden="true" tabindex="-1"></a>train_custom_dataset <span class="op">=</span> CustomDataset(X_train_all, y_train_all)</span>
<span id="cb820-3"><a href="#cb820-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(train_custom_dataset))</span></span>
<span id="cb820-4"><a href="#cb820-4" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb820-5"><a href="#cb820-5" aria-hidden="true" tabindex="-1"></a>train_loader <span class="op">=</span> data.DataLoader(train_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb820-6"><a href="#cb820-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(train_loader))</span></span>
<span id="cb820-7"><a href="#cb820-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-8"><a href="#cb820-8" aria-hidden="true" tabindex="-1"></a>test_custom_dataset <span class="op">=</span> CustomDataset(X_test_all, y_test_all)</span>
<span id="cb820-9"><a href="#cb820-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(test_custom_dataset))</span></span>
<span id="cb820-10"><a href="#cb820-10" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb820-11"><a href="#cb820-11" aria-hidden="true" tabindex="-1"></a>test_loader <span class="op">=</span> data.DataLoader(test_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb820-12"><a href="#cb820-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(test_loader))</span></span>
<span id="cb820-13"><a href="#cb820-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-14"><a href="#cb820-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-15"><a href="#cb820-15" aria-hidden="true" tabindex="-1"></a><span class="co">#################### Training the model ####################</span></span>
<span id="cb820-16"><a href="#cb820-16" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Autoencoder_UNET(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">14</span>, num_output_channels<span class="op">=</span><span class="dv">2</span>, c_hid <span class="op">=</span> <span class="dv">64</span>, latent_dim <span class="op">=</span> <span class="dv">2048</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb820-17"><a href="#cb820-17" aria-hidden="true" tabindex="-1"></a>model.to(device) </span>
<span id="cb820-18"><a href="#cb820-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchinfo <span class="im">import</span> summary</span>
<span id="cb820-19"><a href="#cb820-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary(model, input_size<span class="op">=</span>(<span class="dv">1656</span>, <span class="dv">14</span>, <span class="dv">80</span>, <span class="dv">80</span>)))</span>
<span id="cb820-20"><a href="#cb820-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the loss function and optimizer</span></span>
<span id="cb820-21"><a href="#cb820-21" aria-hidden="true" tabindex="-1"></a>criterion <span class="op">=</span> nn.MSELoss()</span>
<span id="cb820-22"><a href="#cb820-22" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb820-23"><a href="#cb820-23" aria-hidden="true" tabindex="-1"></a>losses <span class="op">=</span> [] </span>
<span id="cb820-24"><a href="#cb820-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Training loop</span></span>
<span id="cb820-25"><a href="#cb820-25" aria-hidden="true" tabindex="-1"></a>num_epochs <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb820-26"><a href="#cb820-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> trange(num_epochs):</span>
<span id="cb820-27"><a href="#cb820-27" aria-hidden="true" tabindex="-1"></a>    model.train()  <span class="co"># Set the model to training mode</span></span>
<span id="cb820-28"><a href="#cb820-28" aria-hidden="true" tabindex="-1"></a>    total_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb820-29"><a href="#cb820-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb820-30"><a href="#cb820-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> inputs, targets <span class="kw">in</span> train_loader:</span>
<span id="cb820-31"><a href="#cb820-31" aria-hidden="true" tabindex="-1"></a>        optimizer.zero_grad()  <span class="co"># Zero the gradients</span></span>
<span id="cb820-32"><a href="#cb820-32" aria-hidden="true" tabindex="-1"></a>        inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb820-33"><a href="#cb820-33" aria-hidden="true" tabindex="-1"></a>        targets <span class="op">=</span> targets.to(device)</span>
<span id="cb820-34"><a href="#cb820-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward pass</span></span>
<span id="cb820-35"><a href="#cb820-35" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(inputs)</span>
<span id="cb820-36"><a href="#cb820-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb820-37"><a href="#cb820-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate the loss</span></span>
<span id="cb820-38"><a href="#cb820-38" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb820-39"><a href="#cb820-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb820-40"><a href="#cb820-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Backpropagation</span></span>
<span id="cb820-41"><a href="#cb820-41" aria-hidden="true" tabindex="-1"></a>        loss.backward()</span>
<span id="cb820-42"><a href="#cb820-42" aria-hidden="true" tabindex="-1"></a>        optimizer.step()</span>
<span id="cb820-43"><a href="#cb820-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb820-44"><a href="#cb820-44" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb820-45"><a href="#cb820-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-46"><a href="#cb820-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the average loss for this epoch</span></span>
<span id="cb820-47"><a href="#cb820-47" aria-hidden="true" tabindex="-1"></a>    average_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb820-48"><a href="#cb820-48" aria-hidden="true" tabindex="-1"></a>    losses.append(average_loss)</span>
<span id="cb820-49"><a href="#cb820-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>: </span>
<span id="cb820-50"><a href="#cb820-50" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Epoch [</span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss">] Loss: </span><span class="sc">{</span>average_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb820-51"><a href="#cb820-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-52"><a href="#cb820-52" aria-hidden="true" tabindex="-1"></a><span class="co">############################# testing the model #############################</span></span>
<span id="cb820-53"><a href="#cb820-53" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb820-54"><a href="#cb820-54" aria-hidden="true" tabindex="-1"></a>test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb820-55"><a href="#cb820-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-56"><a href="#cb820-56" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb820-57"><a href="#cb820-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb820-58"><a href="#cb820-58" aria-hidden="true" tabindex="-1"></a>        inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb820-59"><a href="#cb820-59" aria-hidden="true" tabindex="-1"></a>        targets <span class="op">=</span> targets.to(device)</span>
<span id="cb820-60"><a href="#cb820-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-61"><a href="#cb820-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward pass</span></span>
<span id="cb820-62"><a href="#cb820-62" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(inputs)</span>
<span id="cb820-63"><a href="#cb820-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-64"><a href="#cb820-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate the loss</span></span>
<span id="cb820-65"><a href="#cb820-65" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb820-66"><a href="#cb820-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-67"><a href="#cb820-67" aria-hidden="true" tabindex="-1"></a>        test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb820-68"><a href="#cb820-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-69"><a href="#cb820-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the average test loss</span></span>
<span id="cb820-70"><a href="#cb820-70" aria-hidden="true" tabindex="-1"></a>average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb820-71"><a href="#cb820-71" aria-hidden="true" tabindex="-1"></a><span class="co"># test_loss_list_P_25.append(average_test_loss)</span></span>
<span id="cb820-72"><a href="#cb820-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb820-73"><a href="#cb820-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-74"><a href="#cb820-74" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, num_epochs <span class="op">+</span> <span class="dv">1</span>), losses)</span>
<span id="cb820-75"><a href="#cb820-75" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb820-76"><a href="#cb820-76" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb820-77"><a href="#cb820-77" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.title('Train Loss vs. Epoch for channel '+target_var_96_list[x_channel])</span></span>
<span id="cb820-78"><a href="#cb820-78" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>) </span>
<span id="cb820-79"><a href="#cb820-79" aria-hidden="true" tabindex="-1"></a>plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1324, 14, 80, 80) (332, 14, 80, 80) (1324, 2, 80, 80) (332, 2, 80, 80)
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Autoencoder_UNET                         [1656, 2, 80, 80]         --
├─Encoder: 1-1                           --                        --
│    └─Sequential: 2-1                   --                        --
│    │    └─Conv2d: 3-1                  [1656, 64, 40, 40]        8,128
│    │    └─GELU: 3-2                    [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-3                  [1656, 64, 40, 40]        36,928
│    │    └─GELU: 3-4                    [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-5                  [1656, 128, 20, 20]       73,856
│    │    └─GELU: 3-6                    [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-7                  [1656, 128, 20, 20]       147,584
│    │    └─GELU: 3-8                    [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-9                  [1656, 256, 10, 10]       295,168
│    │    └─GELU: 3-10                   [1656, 256, 10, 10]       --
│    │    └─Flatten: 3-11                [1656, 25600]             --
│    │    └─Linear: 3-12                 [1656, 2048]              52,430,848
├─Decoder: 1-2                           --                        --
│    └─Sequential: 2-2                   --                        --
│    │    └─Linear: 3-13                 [1656, 25600]             52,454,400
│    │    └─Unflatten: 3-14              [1656, 256, 10, 10]       --
│    │    └─ConvTranspose2d: 3-15        [1656, 128, 20, 20]       295,040
│    │    └─GELU: 3-16                   [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-17                 [1656, 128, 20, 20]       147,584
│    │    └─GELU: 3-18                   [1656, 128, 20, 20]       --
│    │    └─ConvTranspose2d: 3-19        [1656, 64, 40, 40]        73,792
│    │    └─GELU: 3-20                   [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-21                 [1656, 64, 40, 40]        36,928
│    │    └─GELU: 3-22                   [1656, 64, 40, 40]        --
│    │    └─ConvTranspose2d: 3-23        [1656, 2, 80, 80]         1,154
==========================================================================================
Total params: 106,001,410
Trainable params: 106,001,410
Non-trainable params: 0
Total mult-adds (Units.TERABYTES): 1.09
==========================================================================================
Input size (MB): 593.51
Forward/backward pass size (MB): 9014.58
Params size (MB): 424.01
Estimated Total Size (MB): 10032.09
==========================================================================================</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:03&lt;11:37,  3.50s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 3185.9086</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [01:08&lt;10:15,  3.44s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 238.7220</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [02:19&lt;09:16,  3.50s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 90.1479</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [03:44&lt;09:57,  4.30s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 19.3867</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [05:06&lt;08:00,  4.04s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 7.6679</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [06:30&lt;07:00,  4.24s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 5.9376</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [07:57&lt;05:25,  4.12s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 7.9944</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [09:21&lt;03:59,  4.06s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 5.3282</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [10:38&lt;02:34,  3.97s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 4.2981</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [11:58&lt;01:13,  3.87s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 4.3096</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [13:15&lt;00:00,  3.98s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 3.9575</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-66-output-24.png" class="lightbox" data-gallery="quarto-lightbox-gallery-63"><img src="Autoencoder_files/figure-html/cell-66-output-24.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-93" class="cell">
<div class="sourceCode cell-code" id="cb844"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb844-1"><a href="#cb844-1" aria-hidden="true" tabindex="-1"></a>torch.save(model.state_dict(), <span class="st">'model/auto_conv_unet_in14_out2.pt'</span>)</span>
<span id="cb844-2"><a href="#cb844-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Autoencoder_UNET(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">14</span>, num_output_channels<span class="op">=</span><span class="dv">2</span>, c_hid <span class="op">=</span> <span class="dv">64</span>, latent_dim <span class="op">=</span> <span class="dv">2048</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb844-3"><a href="#cb844-3" aria-hidden="true" tabindex="-1"></a>model.to(device) </span>
<span id="cb844-4"><a href="#cb844-4" aria-hidden="true" tabindex="-1"></a>model.load_state_dict(torch.load(<span class="st">'model/auto_conv_unet_in14_out2.pt'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;All keys matched successfully&gt;</code></pre>
</div>
</div>
</section>
<section id="single-channel-input-single-channel-outputp25-unet" class="level2">
<h2 class="anchored" data-anchor-id="single-channel-input-single-channel-outputp25-unet">Single channel input single channel output(P25) UNET</h2>
<div id="cell-95" class="cell">
<div class="sourceCode cell-code" id="cb846"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb846-1"><a href="#cb846-1" aria-hidden="true" tabindex="-1"></a>target_var_96_list <span class="op">=</span>[<span class="st">'TSURF_K'</span>,</span>
<span id="cb846-2"><a href="#cb846-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'SNOWEW_M'</span>, <span class="st">'SNOWAGE_HR'</span>, <span class="st">'PRATE_MMpH'</span>, <span class="st">'CLOUD_OD'</span>, <span class="st">'U10_MpS'</span>,</span>
<span id="cb846-3"><a href="#cb846-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'V10_MpS'</span>, <span class="st">'T2_K'</span>, <span class="st">'SWSFC_WpM2'</span>, <span class="st">'SOLM_M3pM3'</span>, <span class="st">'CLDTOP_KM'</span>, <span class="st">'CAPE'</span>,</span>
<span id="cb846-4"><a href="#cb846-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'PBL_WRF_M'</span>, <span class="st">'PBL_YSU_M'</span>]  <span class="co"># ['U10_MpS', 'T2_K', 'V10_MpS']</span></span>
<span id="cb846-5"><a href="#cb846-5" aria-hidden="true" tabindex="-1"></a>target_var_120_list <span class="op">=</span> [<span class="st">'P25'</span>,<span class="st">'P10'</span>] </span>
<span id="cb846-6"><a href="#cb846-6" aria-hidden="true" tabindex="-1"></a>X,y  <span class="op">=</span> get_data(target_var_96_list, target_var_120_list)</span>
<span id="cb846-7"><a href="#cb846-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb846-8"><a href="#cb846-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb846-9"><a href="#cb846-9" aria-hidden="true" tabindex="-1"></a>X_train_all, X_test_all, y_train_all, y_test_all <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb846-10"><a href="#cb846-10" aria-hidden="true" tabindex="-1"></a>X_train_all.shape, X_test_all.shape, y_train_all.shape, y_test_all.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X shape  (1656, 14, 80, 80)
y shape (1656, 2, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>((1324, 14, 80, 80), (332, 14, 80, 80), (1324, 2, 80, 80), (332, 2, 80, 80))</code></pre>
</div>
</div>
<div id="cell-96" class="cell">
<div class="sourceCode cell-code" id="cb849"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb849-1"><a href="#cb849-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_25_conv_auto_unet <span class="op">=</span> [] </span>
<span id="cb849-2"><a href="#cb849-2" aria-hidden="true" tabindex="-1"></a>y_channel <span class="op">=</span> <span class="dv">0</span> <span class="co"># selecting P25 as output</span></span>
<span id="cb849-3"><a href="#cb849-3" aria-hidden="true" tabindex="-1"></a><span class="co"># x_channel = 0</span></span>
<span id="cb849-4"><a href="#cb849-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x_channel <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>]):</span>
<span id="cb849-5"><a href="#cb849-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Selecting the channel #######################</span></span>
<span id="cb849-6"><a href="#cb849-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'X Channel name : '</span>, target_var_96_list[x_channel])</span>
<span id="cb849-7"><a href="#cb849-7" aria-hidden="true" tabindex="-1"></a>    X_train <span class="op">=</span> X_train_all[:, x_channel:x_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb849-8"><a href="#cb849-8" aria-hidden="true" tabindex="-1"></a>    X_test <span class="op">=</span> X_test_all[:, x_channel:x_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb849-9"><a href="#cb849-9" aria-hidden="true" tabindex="-1"></a>    y_train <span class="op">=</span> y_train_all[:, y_channel:y_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb849-10"><a href="#cb849-10" aria-hidden="true" tabindex="-1"></a>    y_test <span class="op">=</span> y_test_all[:, y_channel:y_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb849-11"><a href="#cb849-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Shapes: '</span>, X_train.shape, X_test.shape, y_train.shape, y_test.shape)</span>
<span id="cb849-12"><a href="#cb849-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb849-13"><a href="#cb849-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Creating the dataset loader #######################</span></span>
<span id="cb849-14"><a href="#cb849-14" aria-hidden="true" tabindex="-1"></a>    train_custom_dataset <span class="op">=</span> CustomDataset(X_train, y_train)</span>
<span id="cb849-15"><a href="#cb849-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_custom_dataset))</span></span>
<span id="cb849-16"><a href="#cb849-16" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb849-17"><a href="#cb849-17" aria-hidden="true" tabindex="-1"></a>    train_loader <span class="op">=</span> data.DataLoader(train_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb849-18"><a href="#cb849-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_loader))</span></span>
<span id="cb849-19"><a href="#cb849-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb849-20"><a href="#cb849-20" aria-hidden="true" tabindex="-1"></a>    test_custom_dataset <span class="op">=</span> CustomDataset(X_test, y_test)</span>
<span id="cb849-21"><a href="#cb849-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_custom_dataset))</span></span>
<span id="cb849-22"><a href="#cb849-22" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb849-23"><a href="#cb849-23" aria-hidden="true" tabindex="-1"></a>    test_loader <span class="op">=</span> data.DataLoader(test_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb849-24"><a href="#cb849-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_loader))</span></span>
<span id="cb849-25"><a href="#cb849-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb849-26"><a href="#cb849-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb849-27"><a href="#cb849-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#################### Training the model ####################</span></span>
<span id="cb849-28"><a href="#cb849-28" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Autoencoder_UNET(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">1</span>, num_output_channels<span class="op">=</span><span class="dv">1</span>, c_hid <span class="op">=</span> <span class="dv">8</span>, latent_dim <span class="op">=</span> <span class="dv">512</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb849-29"><a href="#cb849-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb849-30"><a href="#cb849-30" aria-hidden="true" tabindex="-1"></a>    model.to(device)</span>
<span id="cb849-31"><a href="#cb849-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the loss function and optimizer</span></span>
<span id="cb849-32"><a href="#cb849-32" aria-hidden="true" tabindex="-1"></a>    criterion <span class="op">=</span> nn.MSELoss()</span>
<span id="cb849-33"><a href="#cb849-33" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb849-34"><a href="#cb849-34" aria-hidden="true" tabindex="-1"></a>    losses <span class="op">=</span> []</span>
<span id="cb849-35"><a href="#cb849-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Training loop</span></span>
<span id="cb849-36"><a href="#cb849-36" aria-hidden="true" tabindex="-1"></a>    num_epochs <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb849-37"><a href="#cb849-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> trange(num_epochs):</span>
<span id="cb849-38"><a href="#cb849-38" aria-hidden="true" tabindex="-1"></a>        model.train()  <span class="co"># Set the model to training mode</span></span>
<span id="cb849-39"><a href="#cb849-39" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb849-40"><a href="#cb849-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb849-41"><a href="#cb849-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> train_loader:</span>
<span id="cb849-42"><a href="#cb849-42" aria-hidden="true" tabindex="-1"></a>            optimizer.zero_grad()  <span class="co"># Zero the gradients</span></span>
<span id="cb849-43"><a href="#cb849-43" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb849-44"><a href="#cb849-44" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb849-45"><a href="#cb849-45" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb849-46"><a href="#cb849-46" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb849-47"><a href="#cb849-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb849-48"><a href="#cb849-48" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb849-49"><a href="#cb849-49" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb849-50"><a href="#cb849-50" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb849-51"><a href="#cb849-51" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Backpropagation</span></span>
<span id="cb849-52"><a href="#cb849-52" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb849-53"><a href="#cb849-53" aria-hidden="true" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb849-54"><a href="#cb849-54" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb849-55"><a href="#cb849-55" aria-hidden="true" tabindex="-1"></a>            total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb849-56"><a href="#cb849-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb849-57"><a href="#cb849-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the average loss for this epoch</span></span>
<span id="cb849-58"><a href="#cb849-58" aria-hidden="true" tabindex="-1"></a>        average_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb849-59"><a href="#cb849-59" aria-hidden="true" tabindex="-1"></a>        losses.append(average_loss)</span>
<span id="cb849-60"><a href="#cb849-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb849-61"><a href="#cb849-61" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Epoch [</span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss">] Loss: </span><span class="sc">{</span>average_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb849-62"><a href="#cb849-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb849-63"><a href="#cb849-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">############################# testing the model #############################</span></span>
<span id="cb849-64"><a href="#cb849-64" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb849-65"><a href="#cb849-65" aria-hidden="true" tabindex="-1"></a>    test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb849-66"><a href="#cb849-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb849-67"><a href="#cb849-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb849-68"><a href="#cb849-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb849-69"><a href="#cb849-69" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb849-70"><a href="#cb849-70" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb849-71"><a href="#cb849-71" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb849-72"><a href="#cb849-72" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb849-73"><a href="#cb849-73" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb849-74"><a href="#cb849-74" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb849-75"><a href="#cb849-75" aria-hidden="true" tabindex="-1"></a>            test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb849-76"><a href="#cb849-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb849-77"><a href="#cb849-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the average test loss</span></span>
<span id="cb849-78"><a href="#cb849-78" aria-hidden="true" tabindex="-1"></a>    average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb849-79"><a href="#cb849-79" aria-hidden="true" tabindex="-1"></a>    test_loss_list_P_25_conv_auto_unet.append(average_test_loss)</span>
<span id="cb849-80"><a href="#cb849-80" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb849-81"><a href="#cb849-81" aria-hidden="true" tabindex="-1"></a>    plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, num_epochs <span class="op">+</span> <span class="dv">1</span>), losses)</span>
<span id="cb849-82"><a href="#cb849-82" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb849-83"><a href="#cb849-83" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb849-84"><a href="#cb849-84" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Train Loss vs. Epoch for channel '</span><span class="op">+</span>target_var_96_list[x_channel])</span>
<span id="cb849-85"><a href="#cb849-85" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>) </span>
<span id="cb849-86"><a href="#cb849-86" aria-hidden="true" tabindex="-1"></a>    plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  TSURF_K
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 0/200 [00:00&lt;?, ?it/s]  0%|          | 1/200 [00:00&lt;01:04,  3.09it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 2015.0104</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:57,  3.11it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 224.4622</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:13&lt;00:49,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 217.3994</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:43,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 213.6307</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:37,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 211.9555</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:30,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 212.0086</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:38&lt;00:24,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 210.0710</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 216.9347</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 214.3995</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 209.9813</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 192.8667</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-24.png" class="lightbox" data-gallery="quarto-lightbox-gallery-64"><img src="Autoencoder_files/figure-html/cell-69-output-24.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWEW_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:01,  3.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 720.3883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:56,  3.15it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 215.2669</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:50,  3.15it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 212.9412</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:43,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 210.6425</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:37,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 209.0133</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:30,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 216.0626</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:38&lt;00:24,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 209.8225</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 209.2404</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 212.0243</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 208.9202</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 191.8743</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-49.png" class="lightbox" data-gallery="quarto-lightbox-gallery-65"><img src="Autoencoder_files/figure-html/cell-69-output-49.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWAGE_HR
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:01,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 656.6864</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:56,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 215.9682</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:50,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 211.3083</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:43,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 213.7716</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:36,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 210.4161</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:31,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 208.3461</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:38&lt;00:24,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 210.5009</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 210.7708</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:11,  3.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 208.3222</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:06,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 208.7196</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 198.2665</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-74.png" class="lightbox" data-gallery="quarto-lightbox-gallery-66"><img src="Autoencoder_files/figure-html/cell-69-output-74.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PRATE_MMpH
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:02,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 598.2960</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:56,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 227.3699</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:49,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 219.5535</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:43,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 210.1886</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:37,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 210.2708</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:31,  3.14it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 209.0613</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:38&lt;00:24,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 208.2215</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.14it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 207.7972</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 213.5013</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.25it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 208.5548</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 199.3592</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-99.png" class="lightbox" data-gallery="quarto-lightbox-gallery-67"><img src="Autoencoder_files/figure-html/cell-69-output-99.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLOUD_OD
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:01,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 586.9568</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:55,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 62.2030</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:49,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 21.8947</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:41,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 13.4883</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:37,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 13.7934</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:31,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 8.8402</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:24,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 8.3218</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 8.3719</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.25it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 7.2083</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 6.5652</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 7.9540</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-124.png" class="lightbox" data-gallery="quarto-lightbox-gallery-68"><img src="Autoencoder_files/figure-html/cell-69-output-124.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  U10_MpS
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:59,  3.33it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 473.9317</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:55,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 69.0522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:48,  3.30it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 18.4941</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:43,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 10.7839</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:37,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 7.7059</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:31,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 6.4899</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:24,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 5.4837</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:43&lt;00:18,  3.25it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 7.5561</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 3.8554</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.27it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 4.0530</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 3.1830</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-149.png" class="lightbox" data-gallery="quarto-lightbox-gallery-69"><img src="Autoencoder_files/figure-html/cell-69-output-149.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  V10_MpS
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:00,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 561.4590</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:55,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 71.1724</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:49,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 19.3733</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:43,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 9.0035</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:37,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 7.7880</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:31,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 5.6728</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:24,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 8.2339</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 3.8740</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 4.9030</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 4.0399</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 3.4703</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-174.png" class="lightbox" data-gallery="quarto-lightbox-gallery-70"><img src="Autoencoder_files/figure-html/cell-69-output-174.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  T2_K
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 4816.9447</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:57,  3.13it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 234.2117</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:49,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 222.6848</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:43,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 215.6618</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:37,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 213.7606</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:30,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 213.5892</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:25,  3.15it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 211.2940</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 213.9061</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 214.1695</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 208.9214</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 192.4815</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-198.png" class="lightbox" data-gallery="quarto-lightbox-gallery-71"><img src="Autoencoder_files/figure-html/cell-69-output-198.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SWSFC_WpM2
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:59,  3.34it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 512.7773</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:54,  3.28it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 214.1751</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:49,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 212.7058</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:43,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 214.4303</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:36,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 212.5624</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:31,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 208.8632</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:24,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 210.4221</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:43&lt;00:18,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 209.8110</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 207.3880</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 207.7816</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 191.0656</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-223.png" class="lightbox" data-gallery="quarto-lightbox-gallery-72"><img src="Autoencoder_files/figure-html/cell-69-output-223.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SOLM_M3pM3
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 574.8718</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:54,  3.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 181.5824</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:49,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 115.5675</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:42,  3.25it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 39.5182</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:24&lt;00:36,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 16.1863</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:30,  3.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 11.7081</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:24,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 8.9398</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:43&lt;00:18,  3.25it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 8.2249</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:49&lt;00:12,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 6.6518</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:55&lt;00:05,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 5.9480</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:01&lt;00:00,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 5.3015</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-248.png" class="lightbox" data-gallery="quarto-lightbox-gallery-73"><img src="Autoencoder_files/figure-html/cell-69-output-248.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLDTOP_KM
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.39it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 647.1522</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:55,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 215.3608</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:49,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 211.6647</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:44,  3.10it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 209.6907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:37,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 211.7445</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:31,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 207.4063</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:38&lt;00:24,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 207.9890</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.25it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 207.9899</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 209.2992</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 213.8687</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 191.1090</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-273.png" class="lightbox" data-gallery="quarto-lightbox-gallery-74"><img src="Autoencoder_files/figure-html/cell-69-output-273.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CAPE
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:00,  3.30it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 589.8784</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:56,  3.15it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 213.6897</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:50,  3.14it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 215.2983</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:43,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 216.7662</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:35,  3.31it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 213.0695</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:29,  3.30it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 214.7085</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:24,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 213.2036</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:43&lt;00:18,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 212.2645</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:49&lt;00:11,  3.34it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 207.4999</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 213.0907</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:01&lt;00:00,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 191.7055</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-298.png" class="lightbox" data-gallery="quarto-lightbox-gallery-75"><img src="Autoencoder_files/figure-html/cell-69-output-298.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_WRF_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:00,  3.27it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 613.1753</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:55,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 215.8198</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:49,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 211.0306</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:42,  3.27it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 210.1862</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:38,  3.11it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 208.5808</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:30,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 208.4701</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:24,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 209.8240</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 208.0958</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 209.3367</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 207.0369</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 192.7273</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-323.png" class="lightbox" data-gallery="quarto-lightbox-gallery-76"><img src="Autoencoder_files/figure-html/cell-69-output-323.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_YSU_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:00,  3.28it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 419.9077</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:55,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 210.7698</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:48,  3.25it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 208.6584</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:43,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 210.8284</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:37,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 208.8175</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:31,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 206.5321</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:24,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 207.8562</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 207.3433</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 206.2741</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:57&lt;00:06,  3.01it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 207.5728</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 194.3204</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-69-output-348.png" class="lightbox" data-gallery="quarto-lightbox-gallery-77"><img src="Autoencoder_files/figure-html/cell-69-output-348.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-97" class="cell">
<div class="sourceCode cell-code" id="cb1184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1184-1"><a href="#cb1184-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_25_conv_auto_unet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[192.86672002618963,
 191.87428977272728,
 198.26652665571734,
 199.35923628373578,
 7.954025506973267,
 3.18301400271329,
 3.4703480113636362,
 192.4814786044034,
 191.06564331054688,
 5.301476088437167,
 191.10903930664062,
 191.70547346635297,
 192.72732405229047,
 194.32039434259588]</code></pre>
</div>
</div>
<div id="cell-98" class="cell">
<div class="sourceCode cell-code" id="cb1186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1186-1"><a href="#cb1186-1" aria-hidden="true" tabindex="-1"></a>name_loss_pairs <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(target_var_96_list, test_loss_list_P_25_conv_auto_unet))</span>
<span id="cb1186-2"><a href="#cb1186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1186-3"><a href="#cb1186-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort based on loss values</span></span>
<span id="cb1186-4"><a href="#cb1186-4" aria-hidden="true" tabindex="-1"></a>sorted_name_loss_pairs <span class="op">=</span> <span class="bu">sorted</span>(name_loss_pairs, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb1186-5"><a href="#cb1186-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs:</span>
<span id="cb1186-6"><a href="#cb1186-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pair)</span>
<span id="cb1186-7"><a href="#cb1186-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(sorted_name_loss_pairs)</span></span>
<span id="cb1186-8"><a href="#cb1186-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the lowest 3 names</span></span>
<span id="cb1186-9"><a href="#cb1186-9" aria-hidden="true" tabindex="-1"></a>lowest_3_names <span class="op">=</span> [pair[<span class="dv">0</span>] <span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs[:<span class="dv">3</span>]]</span>
<span id="cb1186-10"><a href="#cb1186-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1186-11"><a href="#cb1186-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Lowest 3 names:"</span>, lowest_3_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>('U10_MpS', 3.18301400271329)
('V10_MpS', 3.4703480113636362)
('SOLM_M3pM3', 5.301476088437167)
('CLOUD_OD', 7.954025506973267)
('SWSFC_WpM2', 191.06564331054688)
('CLDTOP_KM', 191.10903930664062)
('CAPE', 191.70547346635297)
('SNOWEW_M', 191.87428977272728)
('T2_K', 192.4814786044034)
('PBL_WRF_M', 192.72732405229047)
('TSURF_K', 192.86672002618963)
('PBL_YSU_M', 194.32039434259588)
('SNOWAGE_HR', 198.26652665571734)
('PRATE_MMpH', 199.35923628373578)
Lowest 3 names: ['U10_MpS', 'V10_MpS', 'SOLM_M3pM3']</code></pre>
</div>
</div>
<div id="cell-99" class="cell">
<div class="sourceCode cell-code" id="cb1188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1188-1"><a href="#cb1188-1" aria-hidden="true" tabindex="-1"></a>summary(model, input_size<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">80</span>, <span class="dv">80</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1            [-1, 8, 40, 40]              80
              GELU-2            [-1, 8, 40, 40]               0
            Conv2d-3            [-1, 8, 40, 40]             584
              GELU-4            [-1, 8, 40, 40]               0
            Conv2d-5           [-1, 16, 20, 20]           1,168
              GELU-6           [-1, 16, 20, 20]               0
            Conv2d-7           [-1, 16, 20, 20]           2,320
              GELU-8           [-1, 16, 20, 20]               0
            Conv2d-9           [-1, 32, 10, 10]           4,640
             GELU-10           [-1, 32, 10, 10]               0
          Flatten-11                 [-1, 3200]               0
           Linear-12                  [-1, 512]       1,638,912
           Linear-13                 [-1, 3200]       1,641,600
        Unflatten-14           [-1, 32, 10, 10]               0
  ConvTranspose2d-15           [-1, 16, 20, 20]           4,624
             GELU-16           [-1, 16, 20, 20]               0
           Conv2d-17           [-1, 16, 20, 20]           2,320
             GELU-18           [-1, 16, 20, 20]               0
  ConvTranspose2d-19            [-1, 8, 40, 40]           1,160
             GELU-20            [-1, 8, 40, 40]               0
           Conv2d-21            [-1, 8, 40, 40]             584
             GELU-22            [-1, 8, 40, 40]               0
  ConvTranspose2d-23            [-1, 1, 80, 80]              73
================================================================
Total params: 3,298,065
Trainable params: 3,298,065
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.02
Forward/backward pass size (MB): 1.35
Params size (MB): 12.58
Estimated Total Size (MB): 13.95
----------------------------------------------------------------</code></pre>
</div>
</div>
<div id="cell-100" class="cell">
<div class="sourceCode cell-code" id="cb1190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1190-1"><a href="#cb1190-1" aria-hidden="true" tabindex="-1"></a>summary(model, input_size<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">80</span>, <span class="dv">80</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1            [-1, 8, 40, 40]              80
              GELU-2            [-1, 8, 40, 40]               0
            Conv2d-3            [-1, 8, 40, 40]             584
              GELU-4            [-1, 8, 40, 40]               0
            Conv2d-5           [-1, 16, 20, 20]           1,168
              GELU-6           [-1, 16, 20, 20]               0
            Conv2d-7           [-1, 16, 20, 20]           2,320
              GELU-8           [-1, 16, 20, 20]               0
            Conv2d-9           [-1, 32, 10, 10]           4,640
             GELU-10           [-1, 32, 10, 10]               0
          Flatten-11                 [-1, 3200]               0
           Linear-12                 [-1, 1024]       3,277,824
          Encoder-13                 [-1, 1024]               0
           Linear-14                 [-1, 3200]       3,280,000
        Unflatten-15           [-1, 32, 10, 10]               0
  ConvTranspose2d-16           [-1, 16, 20, 20]           4,624
             GELU-17           [-1, 16, 20, 20]               0
           Conv2d-18           [-1, 16, 20, 20]           2,320
             GELU-19           [-1, 16, 20, 20]               0
  ConvTranspose2d-20            [-1, 8, 40, 40]           1,160
             GELU-21            [-1, 8, 40, 40]               0
           Conv2d-22            [-1, 8, 40, 40]             584
             GELU-23            [-1, 8, 40, 40]               0
  ConvTranspose2d-24            [-1, 1, 80, 80]              73
          Decoder-25            [-1, 1, 80, 80]               0
================================================================
Total params: 6,575,377
Trainable params: 6,575,377
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.02
Forward/backward pass size (MB): 1.41
Params size (MB): 25.08
Estimated Total Size (MB): 26.51
----------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="single-channel-input-single-channel-outputp10-unet" class="level2">
<h2 class="anchored" data-anchor-id="single-channel-input-single-channel-outputp10-unet">Single channel input single channel output(P10) UNET</h2>
<div id="cell-102" class="cell">
<div class="sourceCode cell-code" id="cb1192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1192-1"><a href="#cb1192-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_10_conv_auto_unet <span class="op">=</span> [] </span>
<span id="cb1192-2"><a href="#cb1192-2" aria-hidden="true" tabindex="-1"></a>y_channel <span class="op">=</span> <span class="dv">1</span> <span class="co"># selecting P10 as output</span></span>
<span id="cb1192-3"><a href="#cb1192-3" aria-hidden="true" tabindex="-1"></a><span class="co"># x_channel = 0</span></span>
<span id="cb1192-4"><a href="#cb1192-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x_channel <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>]):</span>
<span id="cb1192-5"><a href="#cb1192-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Selecting the channel #######################</span></span>
<span id="cb1192-6"><a href="#cb1192-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'X Channel name : '</span>, target_var_96_list[x_channel])</span>
<span id="cb1192-7"><a href="#cb1192-7" aria-hidden="true" tabindex="-1"></a>    X_train <span class="op">=</span> X_train_all[:, x_channel:x_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb1192-8"><a href="#cb1192-8" aria-hidden="true" tabindex="-1"></a>    X_test <span class="op">=</span> X_test_all[:, x_channel:x_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb1192-9"><a href="#cb1192-9" aria-hidden="true" tabindex="-1"></a>    y_train <span class="op">=</span> y_train_all[:, y_channel:y_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb1192-10"><a href="#cb1192-10" aria-hidden="true" tabindex="-1"></a>    y_test <span class="op">=</span> y_test_all[:, y_channel:y_channel<span class="op">+</span><span class="dv">1</span>, :,:]</span>
<span id="cb1192-11"><a href="#cb1192-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Shapes: '</span>, X_train.shape, X_test.shape, y_train.shape, y_test.shape)</span>
<span id="cb1192-12"><a href="#cb1192-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1192-13"><a href="#cb1192-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">####################### Creating the dataset loader #######################</span></span>
<span id="cb1192-14"><a href="#cb1192-14" aria-hidden="true" tabindex="-1"></a>    train_custom_dataset <span class="op">=</span> CustomDataset(X_train, y_train)</span>
<span id="cb1192-15"><a href="#cb1192-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_custom_dataset))</span></span>
<span id="cb1192-16"><a href="#cb1192-16" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb1192-17"><a href="#cb1192-17" aria-hidden="true" tabindex="-1"></a>    train_loader <span class="op">=</span> data.DataLoader(train_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1192-18"><a href="#cb1192-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(train_loader))</span></span>
<span id="cb1192-19"><a href="#cb1192-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1192-20"><a href="#cb1192-20" aria-hidden="true" tabindex="-1"></a>    test_custom_dataset <span class="op">=</span> CustomDataset(X_test, y_test)</span>
<span id="cb1192-21"><a href="#cb1192-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_custom_dataset))</span></span>
<span id="cb1192-22"><a href="#cb1192-22" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb1192-23"><a href="#cb1192-23" aria-hidden="true" tabindex="-1"></a>    test_loader <span class="op">=</span> data.DataLoader(test_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1192-24"><a href="#cb1192-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(len(test_loader))</span></span>
<span id="cb1192-25"><a href="#cb1192-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1192-26"><a href="#cb1192-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1192-27"><a href="#cb1192-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#################### Training the model ####################</span></span>
<span id="cb1192-28"><a href="#cb1192-28" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Autoencoder_UNET(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">1</span>, num_output_channels<span class="op">=</span><span class="dv">1</span>, c_hid <span class="op">=</span> <span class="dv">8</span>, latent_dim <span class="op">=</span> <span class="dv">512</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb1192-29"><a href="#cb1192-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1192-30"><a href="#cb1192-30" aria-hidden="true" tabindex="-1"></a>    model.to(device)</span>
<span id="cb1192-31"><a href="#cb1192-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the loss function and optimizer</span></span>
<span id="cb1192-32"><a href="#cb1192-32" aria-hidden="true" tabindex="-1"></a>    criterion <span class="op">=</span> nn.MSELoss()</span>
<span id="cb1192-33"><a href="#cb1192-33" aria-hidden="true" tabindex="-1"></a>    optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb1192-34"><a href="#cb1192-34" aria-hidden="true" tabindex="-1"></a>    losses <span class="op">=</span> []</span>
<span id="cb1192-35"><a href="#cb1192-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Training loop</span></span>
<span id="cb1192-36"><a href="#cb1192-36" aria-hidden="true" tabindex="-1"></a>    num_epochs <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb1192-37"><a href="#cb1192-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> epoch <span class="kw">in</span> trange(num_epochs):</span>
<span id="cb1192-38"><a href="#cb1192-38" aria-hidden="true" tabindex="-1"></a>        model.train()  <span class="co"># Set the model to training mode</span></span>
<span id="cb1192-39"><a href="#cb1192-39" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb1192-40"><a href="#cb1192-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1192-41"><a href="#cb1192-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> train_loader:</span>
<span id="cb1192-42"><a href="#cb1192-42" aria-hidden="true" tabindex="-1"></a>            optimizer.zero_grad()  <span class="co"># Zero the gradients</span></span>
<span id="cb1192-43"><a href="#cb1192-43" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb1192-44"><a href="#cb1192-44" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb1192-45"><a href="#cb1192-45" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb1192-46"><a href="#cb1192-46" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb1192-47"><a href="#cb1192-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1192-48"><a href="#cb1192-48" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb1192-49"><a href="#cb1192-49" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb1192-50"><a href="#cb1192-50" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1192-51"><a href="#cb1192-51" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Backpropagation</span></span>
<span id="cb1192-52"><a href="#cb1192-52" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb1192-53"><a href="#cb1192-53" aria-hidden="true" tabindex="-1"></a>            optimizer.step()</span>
<span id="cb1192-54"><a href="#cb1192-54" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1192-55"><a href="#cb1192-55" aria-hidden="true" tabindex="-1"></a>            total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb1192-56"><a href="#cb1192-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1192-57"><a href="#cb1192-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the average loss for this epoch</span></span>
<span id="cb1192-58"><a href="#cb1192-58" aria-hidden="true" tabindex="-1"></a>        average_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb1192-59"><a href="#cb1192-59" aria-hidden="true" tabindex="-1"></a>        losses.append(average_loss)</span>
<span id="cb1192-60"><a href="#cb1192-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb1192-61"><a href="#cb1192-61" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Epoch [</span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss">] Loss: </span><span class="sc">{</span>average_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb1192-62"><a href="#cb1192-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1192-63"><a href="#cb1192-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">############################# testing the model #############################</span></span>
<span id="cb1192-64"><a href="#cb1192-64" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb1192-65"><a href="#cb1192-65" aria-hidden="true" tabindex="-1"></a>    test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb1192-66"><a href="#cb1192-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1192-67"><a href="#cb1192-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> torch.no_grad():</span>
<span id="cb1192-68"><a href="#cb1192-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb1192-69"><a href="#cb1192-69" aria-hidden="true" tabindex="-1"></a>            inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb1192-70"><a href="#cb1192-70" aria-hidden="true" tabindex="-1"></a>            targets <span class="op">=</span> targets.to(device)</span>
<span id="cb1192-71"><a href="#cb1192-71" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass</span></span>
<span id="cb1192-72"><a href="#cb1192-72" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(inputs)</span>
<span id="cb1192-73"><a href="#cb1192-73" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate the loss</span></span>
<span id="cb1192-74"><a href="#cb1192-74" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb1192-75"><a href="#cb1192-75" aria-hidden="true" tabindex="-1"></a>            test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb1192-76"><a href="#cb1192-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1192-77"><a href="#cb1192-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the average test loss</span></span>
<span id="cb1192-78"><a href="#cb1192-78" aria-hidden="true" tabindex="-1"></a>    average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb1192-79"><a href="#cb1192-79" aria-hidden="true" tabindex="-1"></a>    test_loss_list_P_10_conv_auto_unet.append(average_test_loss)</span>
<span id="cb1192-80"><a href="#cb1192-80" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb1192-81"><a href="#cb1192-81" aria-hidden="true" tabindex="-1"></a>    plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, num_epochs <span class="op">+</span> <span class="dv">1</span>), losses)</span>
<span id="cb1192-82"><a href="#cb1192-82" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb1192-83"><a href="#cb1192-83" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb1192-84"><a href="#cb1192-84" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Train Loss vs. Epoch for channel '</span><span class="op">+</span>target_var_96_list[x_channel])</span>
<span id="cb1192-85"><a href="#cb1192-85" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>) </span>
<span id="cb1192-86"><a href="#cb1192-86" aria-hidden="true" tabindex="-1"></a>    plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  TSURF_K
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:04,  3.10it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 9347.3935</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:55,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 445.2209</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:49,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 421.8352</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:43,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 411.4913</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:37,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 406.5355</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:31,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 410.0266</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:24,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 403.3963</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 402.2838</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.14it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 404.5083</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 408.9846</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 393.9739</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-25.png" class="lightbox" data-gallery="quarto-lightbox-gallery-78"><img src="Autoencoder_files/figure-html/cell-74-output-25.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWEW_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:01,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1062.0485</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:57,  3.13it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 425.7831</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:50,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 414.1087</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:43,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 407.9692</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:37,  3.13it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 409.0262</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:29,  3.32it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 413.5665</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:24,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 406.8342</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 401.0203</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 403.7887</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 412.0851</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 384.9228</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-49.png" class="lightbox" data-gallery="quarto-lightbox-gallery-79"><img src="Autoencoder_files/figure-html/cell-74-output-49.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SNOWAGE_HR
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:02,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1334.1772</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:55,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 432.3582</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:51,  3.09it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 416.2745</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:42,  3.27it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 412.7553</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:36,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 411.6587</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:30,  3.28it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 409.5164</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:25,  3.11it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 409.2917</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:43&lt;00:18,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 414.7216</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 405.0483</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:05,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 404.8374</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 366.9726</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-73.png" class="lightbox" data-gallery="quarto-lightbox-gallery-80"><img src="Autoencoder_files/figure-html/cell-74-output-73.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PRATE_MMpH
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:07,  2.95it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1228.4596</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:56,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 418.4353</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:13&lt;00:49,  3.20it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 411.4351</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:19&lt;00:42,  3.30it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 411.3802</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:25&lt;00:36,  3.27it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 408.2070</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:30,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 402.7285</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:38&lt;00:24,  3.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 405.0596</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:44&lt;00:18,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 401.6986</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:50&lt;00:12,  3.22it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 401.9078</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:56&lt;00:06,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 405.1741</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:02&lt;00:00,  3.19it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 397.5330</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-98.png" class="lightbox" data-gallery="quarto-lightbox-gallery-81"><img src="Autoencoder_files/figure-html/cell-74-output-98.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLOUD_OD
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:00,  3.28it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1086.5345</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:54,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 115.0784</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:48,  3.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 55.1418</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:41,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 35.0410</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:24&lt;00:35,  3.32it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 25.9328</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:30,  3.27it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 22.8977</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:23,  3.32it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 22.6624</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:43&lt;00:18,  3.15it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 18.5878</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:49&lt;00:11,  3.25it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 16.7638</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:55&lt;00:05,  3.31it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 18.7935</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:01&lt;00:00,  3.27it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 16.7694</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-123.png" class="lightbox" data-gallery="quarto-lightbox-gallery-82"><img src="Autoencoder_files/figure-html/cell-74-output-123.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  U10_MpS
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1370.2549</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:53,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 253.0794</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:48,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 73.3127</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:44,  3.12it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 34.2972</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:24&lt;00:37,  3.16it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 23.2712</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:30,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 18.8157</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:37&lt;00:25,  3.14it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 17.0560</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:43&lt;00:17,  3.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 13.7983</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:49&lt;00:12,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 12.2436</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:55&lt;00:05,  3.21it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 11.2890</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:01&lt;00:00,  3.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 16.9951</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-148.png" class="lightbox" data-gallery="quarto-lightbox-gallery-83"><img src="Autoencoder_files/figure-html/cell-74-output-148.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  V10_MpS
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:00,  3.28it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1202.3667</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:54,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 284.9583</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:48,  3.26it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 49.5132</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:42,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 23.7217</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:24&lt;00:37,  3.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 16.5870</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:31&lt;00:29,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 13.4451</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:39&lt;00:33,  2.34it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 11.5799</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:47&lt;00:25,  2.32it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 10.4765</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:55&lt;00:15,  2.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 13.5249</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [01:03&lt;00:06,  3.06it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 9.1645</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:10&lt;00:00,  2.85it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 8.1653</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-172.png" class="lightbox" data-gallery="quarto-lightbox-gallery-84"><img src="Autoencoder_files/figure-html/cell-74-output-172.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  T2_K
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:01,  3.25it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1344.0557</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:08&lt;01:31,  1.95it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 410.2120</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:15&lt;00:48,  3.25it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 409.9936</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:21&lt;00:42,  3.27it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 403.0425</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:27&lt;00:34,  3.47it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 413.2495</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:33&lt;00:32,  3.06it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 410.5454</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:41&lt;00:22,  3.51it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 408.9813</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:46&lt;00:16,  3.63it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 404.3268</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:52&lt;00:11,  3.53it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 402.1354</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:58&lt;00:05,  3.47it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 403.1094</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:03&lt;00:00,  3.14it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 370.9240</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-196.png" class="lightbox" data-gallery="quarto-lightbox-gallery-85"><img src="Autoencoder_files/figure-html/cell-74-output-196.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SWSFC_WpM2
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:13,  2.70it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1138.2640</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:51,  3.49it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 428.3663</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:45,  3.49it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 428.3100</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:39,  3.49it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 411.9817</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:34,  3.50it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 406.6649</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:29,  3.36it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 406.5036</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:22,  3.47it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 404.4717</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:16,  3.52it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 413.3260</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:46&lt;00:10,  3.61it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 404.8024</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:52&lt;00:05,  3.50it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 408.2683</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 375.5593</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-220.png" class="lightbox" data-gallery="quarto-lightbox-gallery-86"><img src="Autoencoder_files/figure-html/cell-74-output-220.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  SOLM_M3pM3
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:57,  3.47it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1171.9761</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 311.1736</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:46,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 213.8882</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 86.1118</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:35,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 43.9884</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:34&lt;00:50,  1.95it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 33.4366</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:48&lt;00:21,  3.66it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 26.7442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:54&lt;00:17,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 25.1023</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:59&lt;00:12,  3.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 19.1235</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [01:05&lt;00:05,  3.38it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 16.5218</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:12&lt;00:00,  2.74it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 17.8878</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-244.png" class="lightbox" data-gallery="quarto-lightbox-gallery-87"><img src="Autoencoder_files/figure-html/cell-74-output-244.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CLDTOP_KM
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:58,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1209.7468</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:51,  3.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 418.6483</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:48,  3.31it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 411.9460</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 416.4541</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:34,  3.48it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 410.3450</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:28,  3.49it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 404.6752</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:22,  3.50it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 411.7702</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:40&lt;00:17,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 404.7753</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:46&lt;00:11,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 410.6092</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:52&lt;00:05,  3.49it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 406.9762</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:58&lt;00:00,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 364.9331</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-269.png" class="lightbox" data-gallery="quarto-lightbox-gallery-88"><img src="Autoencoder_files/figure-html/cell-74-output-269.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  CAPE
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;01:05,  3.05it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1286.6324</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:50,  3.56it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 416.3279</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:45,  3.46it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 412.8959</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:39,  3.53it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 432.9754</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:35,  3.37it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 423.2503</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:26,  3.68it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 407.6195</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:34&lt;00:22,  3.56it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 405.0848</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:40&lt;00:16,  3.55it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 418.5362</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:46&lt;00:11,  3.53it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 398.3066</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:51&lt;00:05,  3.50it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 399.7189</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:57&lt;00:00,  3.49it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 366.6939</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-293.png" class="lightbox" data-gallery="quarto-lightbox-gallery-89"><img src="Autoencoder_files/figure-html/cell-74-output-293.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_WRF_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:57,  3.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1160.2099</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:52,  3.40it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 410.9463</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:11&lt;00:46,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 407.0937</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:18&lt;00:40,  3.42it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 406.6331</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:33,  3.57it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 405.4273</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:29&lt;00:27,  3.55it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 406.6442</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:35&lt;00:23,  3.32it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 405.2662</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:41&lt;00:17,  3.47it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 400.4130</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:46&lt;00:11,  3.43it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 403.3931</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:52&lt;00:05,  3.47it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 409.0273</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [00:57&lt;00:00,  3.45it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 364.0550</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-317.png" class="lightbox" data-gallery="quarto-lightbox-gallery-90"><img src="Autoencoder_files/figure-html/cell-74-output-317.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>X Channel name :  PBL_YSU_M
Shapes:  (1324, 1, 80, 80) (332, 1, 80, 80) (1324, 1, 80, 80) (332, 1, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  0%|          | 1/200 [00:00&lt;00:54,  3.64it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/200] Loss: 1176.6661</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 10%|█         | 21/200 [00:06&lt;00:49,  3.63it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/200] Loss: 410.8530</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 20%|██        | 41/200 [00:12&lt;00:47,  3.35it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/200] Loss: 408.6113</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 30%|███       | 61/200 [00:17&lt;00:40,  3.41it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/200] Loss: 400.7242</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 40%|████      | 81/200 [00:23&lt;00:36,  3.23it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/200] Loss: 407.2048</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 50%|█████     | 101/200 [00:30&lt;00:30,  3.24it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [101/200] Loss: 407.0074</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 60%|██████    | 121/200 [00:36&lt;00:25,  3.12it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [121/200] Loss: 405.1491</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 70%|███████   | 141/200 [00:42&lt;00:18,  3.27it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [141/200] Loss: 428.9850</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 80%|████████  | 161/200 [00:48&lt;00:11,  3.32it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [161/200] Loss: 411.7955</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 90%|█████████ | 181/200 [00:54&lt;00:05,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [181/200] Loss: 412.6084</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 200/200 [01:00&lt;00:00,  3.29it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 375.2351</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-74-output-342.png" class="lightbox" data-gallery="quarto-lightbox-gallery-91"><img src="Autoencoder_files/figure-html/cell-74-output-342.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-103" class="cell">
<div class="sourceCode cell-code" id="cb1521"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1521-1"><a href="#cb1521-1" aria-hidden="true" tabindex="-1"></a>test_loss_list_P_10_conv_auto_unet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[393.97390192205256,
 384.9228349165483,
 366.9725619229403,
 397.5330338911577,
 16.76939444108443,
 16.99508944424716,
 8.165278738195246,
 370.9240167791193,
 375.55933172052556,
 17.88784339211204,
 364.93308327414775,
 366.69390869140625,
 364.0550065474077,
 375.23513239080256]</code></pre>
</div>
</div>
<div id="cell-104" class="cell">
<div class="sourceCode cell-code" id="cb1523"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1523-1"><a href="#cb1523-1" aria-hidden="true" tabindex="-1"></a>name_loss_pairs <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(target_var_96_list, test_loss_list_P_10_conv_auto_unet))</span>
<span id="cb1523-2"><a href="#cb1523-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1523-3"><a href="#cb1523-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort based on loss values</span></span>
<span id="cb1523-4"><a href="#cb1523-4" aria-hidden="true" tabindex="-1"></a>sorted_name_loss_pairs <span class="op">=</span> <span class="bu">sorted</span>(name_loss_pairs, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb1523-5"><a href="#cb1523-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs:</span>
<span id="cb1523-6"><a href="#cb1523-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(pair)</span>
<span id="cb1523-7"><a href="#cb1523-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(sorted_name_loss_pairs)</span></span>
<span id="cb1523-8"><a href="#cb1523-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the lowest 3 names</span></span>
<span id="cb1523-9"><a href="#cb1523-9" aria-hidden="true" tabindex="-1"></a>lowest_3_names <span class="op">=</span> [pair[<span class="dv">0</span>] <span class="cf">for</span> pair <span class="kw">in</span> sorted_name_loss_pairs[:<span class="dv">3</span>]]</span>
<span id="cb1523-10"><a href="#cb1523-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1523-11"><a href="#cb1523-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Lowest 3 names:"</span>, lowest_3_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>('V10_MpS', 8.165278738195246)
('CLOUD_OD', 16.76939444108443)
('U10_MpS', 16.99508944424716)
('SOLM_M3pM3', 17.88784339211204)
('PBL_WRF_M', 364.0550065474077)
('CLDTOP_KM', 364.93308327414775)
('CAPE', 366.69390869140625)
('SNOWAGE_HR', 366.9725619229403)
('T2_K', 370.9240167791193)
('PBL_YSU_M', 375.23513239080256)
('SWSFC_WpM2', 375.55933172052556)
('SNOWEW_M', 384.9228349165483)
('TSURF_K', 393.97390192205256)
('PRATE_MMpH', 397.5330338911577)
Lowest 3 names: ['V10_MpS', 'CLOUD_OD', 'U10_MpS']</code></pre>
</div>
</div>
</section>
<section id="insights-2" class="level2">
<h2 class="anchored" data-anchor-id="insights-2">Insights</h2>
<div id="cell-106" class="cell">
<div class="sourceCode cell-code" id="cb1525"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1525-1"><a href="#cb1525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding values at corresponding indices</span></span>
<span id="cb1525-2"><a href="#cb1525-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> [(x <span class="op">+</span> y)<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(test_loss_list_P_10_conv_auto_unet, test_loss_list_P_25_conv_auto_unet)]</span>
<span id="cb1525-3"><a href="#cb1525-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1525-4"><a href="#cb1525-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a DataFrame</span></span>
<span id="cb1525-5"><a href="#cb1525-5" aria-hidden="true" tabindex="-1"></a>data_frame <span class="op">=</span> {<span class="st">'Input channel'</span>: target_var_96_list, <span class="st">'P10'</span>: test_loss_list_P_10_conv_auto_unet, <span class="st">'P25'</span>: test_loss_list_P_25_conv_auto_unet, <span class="st">'P10+P25 avg'</span>: result}</span>
<span id="cb1525-6"><a href="#cb1525-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data_frame)</span>
<span id="cb1525-7"><a href="#cb1525-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1525-8"><a href="#cb1525-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Sorting the DataFrame based on "List1 + List2"</span></span>
<span id="cb1525-9"><a href="#cb1525-9" aria-hidden="true" tabindex="-1"></a>df_sorted <span class="op">=</span> df.sort_values(by<span class="op">=</span><span class="st">'P10+P25 avg'</span>)</span>
<span id="cb1525-10"><a href="#cb1525-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1525-11"><a href="#cb1525-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the sorted DataFrame</span></span>
<span id="cb1525-12"><a href="#cb1525-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1525-13"><a href="#cb1525-13" aria-hidden="true" tabindex="-1"></a>df_rounded <span class="op">=</span> df_sorted.<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb1525-14"><a href="#cb1525-14" aria-hidden="true" tabindex="-1"></a>df_rounded.to_csv(<span class="st">'/home/rishabh.mondal/climax_alternative/Climax_2/results/test_loss_list_P_10_P25_conv_auto_unet.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1525-15"><a href="#cb1525-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1525-16"><a href="#cb1525-16" aria-hidden="true" tabindex="-1"></a>df_rounded</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Input channel</th>
<th data-quarto-table-cell-role="th">P10</th>
<th data-quarto-table-cell-role="th">P25</th>
<th data-quarto-table-cell-role="th">P10+P25 avg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>V10_MpS</td>
<td>8.2</td>
<td>3.5</td>
<td>5.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>U10_MpS</td>
<td>17.0</td>
<td>3.2</td>
<td>10.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>SOLM_M3pM3</td>
<td>17.9</td>
<td>5.3</td>
<td>11.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>CLOUD_OD</td>
<td>16.8</td>
<td>8.0</td>
<td>12.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>CLDTOP_KM</td>
<td>364.9</td>
<td>191.1</td>
<td>278.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>PBL_WRF_M</td>
<td>364.1</td>
<td>192.7</td>
<td>278.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11</td>
<td>CAPE</td>
<td>366.7</td>
<td>191.7</td>
<td>279.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>T2_K</td>
<td>370.9</td>
<td>192.5</td>
<td>281.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>SNOWAGE_HR</td>
<td>367.0</td>
<td>198.3</td>
<td>282.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>SWSFC_WpM2</td>
<td>375.6</td>
<td>191.1</td>
<td>283.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>PBL_YSU_M</td>
<td>375.2</td>
<td>194.3</td>
<td>284.8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>SNOWEW_M</td>
<td>384.9</td>
<td>191.9</td>
<td>288.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>TSURF_K</td>
<td>394.0</td>
<td>192.9</td>
<td>293.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>PRATE_MMpH</td>
<td>397.5</td>
<td>199.4</td>
<td>298.4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="training-on-top-4-channel-and-predicting-on-all-channel-unet" class="level2">
<h2 class="anchored" data-anchor-id="training-on-top-4-channel-and-predicting-on-all-channel-unet">Training on top 4 channel and predicting on all channel UNET</h2>
<div id="cell-108" class="cell">
<div class="sourceCode cell-code" id="cb1526"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1526-1"><a href="#cb1526-1" aria-hidden="true" tabindex="-1"></a><span class="co"># target_var_96_list =['TSURF_K',</span></span>
<span id="cb1526-2"><a href="#cb1526-2" aria-hidden="true" tabindex="-1"></a><span class="co">#        'SNOWEW_M', 'SNOWAGE_HR', 'PRATE_MMpH', 'CLOUD_OD', 'U10_MpS',</span></span>
<span id="cb1526-3"><a href="#cb1526-3" aria-hidden="true" tabindex="-1"></a><span class="co">#        'V10_MpS', 'T2_K', 'SWSFC_WpM2', 'SOLM_M3pM3', 'CLDTOP_KM', 'CAPE',</span></span>
<span id="cb1526-4"><a href="#cb1526-4" aria-hidden="true" tabindex="-1"></a><span class="co">#        'PBL_WRF_M', 'PBL_YSU_M']  # ['U10_MpS', 'T2_K', 'V10_MpS']</span></span>
<span id="cb1526-5"><a href="#cb1526-5" aria-hidden="true" tabindex="-1"></a>target_var_96_list<span class="op">=</span> [<span class="st">'V10_MpS'</span>,<span class="st">'U10_MpS'</span>,<span class="st">'SOLM_M3pM3'</span>, <span class="st">'CLOUD_OD'</span>]</span>
<span id="cb1526-6"><a href="#cb1526-6" aria-hidden="true" tabindex="-1"></a>target_var_120_list <span class="op">=</span> [<span class="st">'P25'</span>,<span class="st">'P10'</span>] </span>
<span id="cb1526-7"><a href="#cb1526-7" aria-hidden="true" tabindex="-1"></a>X,y  <span class="op">=</span> get_data(target_var_96_list, target_var_120_list)</span>
<span id="cb1526-8"><a href="#cb1526-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1526-9"><a href="#cb1526-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1526-10"><a href="#cb1526-10" aria-hidden="true" tabindex="-1"></a>X_train_all, X_test_all, y_train_all, y_test_all <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb1526-11"><a href="#cb1526-11" aria-hidden="true" tabindex="-1"></a>X_train_all.shape, X_test_all.shape, y_train_all.shape, y_test_all.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X shape  (1656, 4, 80, 80)
y shape (1656, 2, 80, 80)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>((1324, 4, 80, 80), (332, 4, 80, 80), (1324, 2, 80, 80), (332, 2, 80, 80))</code></pre>
</div>
</div>
<div id="cell-109" class="cell">
<div class="sourceCode cell-code" id="cb1529"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1529-1"><a href="#cb1529-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train_all.shape, X_test_all.shape, y_train_all.shape, y_test_all.shape)</span>
<span id="cb1529-2"><a href="#cb1529-2" aria-hidden="true" tabindex="-1"></a>train_custom_dataset <span class="op">=</span> CustomDataset(X_train_all, y_train_all)</span>
<span id="cb1529-3"><a href="#cb1529-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(train_custom_dataset))</span></span>
<span id="cb1529-4"><a href="#cb1529-4" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb1529-5"><a href="#cb1529-5" aria-hidden="true" tabindex="-1"></a>train_loader <span class="op">=</span> data.DataLoader(train_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1529-6"><a href="#cb1529-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(train_loader))</span></span>
<span id="cb1529-7"><a href="#cb1529-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1529-8"><a href="#cb1529-8" aria-hidden="true" tabindex="-1"></a>test_custom_dataset <span class="op">=</span> CustomDataset(X_test_all, y_test_all)</span>
<span id="cb1529-9"><a href="#cb1529-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(test_custom_dataset))</span></span>
<span id="cb1529-10"><a href="#cb1529-10" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb1529-11"><a href="#cb1529-11" aria-hidden="true" tabindex="-1"></a>test_loader <span class="op">=</span> data.DataLoader(test_custom_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1529-12"><a href="#cb1529-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print(len(test_loader))</span></span>
<span id="cb1529-13"><a href="#cb1529-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1529-14"><a href="#cb1529-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1529-15"><a href="#cb1529-15" aria-hidden="true" tabindex="-1"></a><span class="co">#################### Training the model ####################</span></span>
<span id="cb1529-16"><a href="#cb1529-16" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Autoencoder_UNET(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">4</span>, num_output_channels<span class="op">=</span><span class="dv">2</span>, c_hid <span class="op">=</span> <span class="dv">64</span>, latent_dim <span class="op">=</span> <span class="dv">2048</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb1529-17"><a href="#cb1529-17" aria-hidden="true" tabindex="-1"></a>model.to(device) </span>
<span id="cb1529-18"><a href="#cb1529-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torchinfo <span class="im">import</span> summary</span>
<span id="cb1529-19"><a href="#cb1529-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary(model, input_size<span class="op">=</span>(<span class="dv">1656</span>, <span class="dv">4</span>, <span class="dv">80</span>, <span class="dv">80</span>)))</span>
<span id="cb1529-20"><a href="#cb1529-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the loss function and optimizer</span></span>
<span id="cb1529-21"><a href="#cb1529-21" aria-hidden="true" tabindex="-1"></a>criterion <span class="op">=</span> nn.MSELoss()</span>
<span id="cb1529-22"><a href="#cb1529-22" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> torch.optim.Adam(model.parameters(), lr<span class="op">=</span><span class="fl">0.001</span>)</span>
<span id="cb1529-23"><a href="#cb1529-23" aria-hidden="true" tabindex="-1"></a>losses <span class="op">=</span> [] </span>
<span id="cb1529-24"><a href="#cb1529-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Training loop</span></span>
<span id="cb1529-25"><a href="#cb1529-25" aria-hidden="true" tabindex="-1"></a>num_epochs <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1529-26"><a href="#cb1529-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> trange(num_epochs):</span>
<span id="cb1529-27"><a href="#cb1529-27" aria-hidden="true" tabindex="-1"></a>    model.train()  <span class="co"># Set the model to training mode</span></span>
<span id="cb1529-28"><a href="#cb1529-28" aria-hidden="true" tabindex="-1"></a>    total_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb1529-29"><a href="#cb1529-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1529-30"><a href="#cb1529-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> inputs, targets <span class="kw">in</span> train_loader:</span>
<span id="cb1529-31"><a href="#cb1529-31" aria-hidden="true" tabindex="-1"></a>        optimizer.zero_grad()  <span class="co"># Zero the gradients</span></span>
<span id="cb1529-32"><a href="#cb1529-32" aria-hidden="true" tabindex="-1"></a>        inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb1529-33"><a href="#cb1529-33" aria-hidden="true" tabindex="-1"></a>        targets <span class="op">=</span> targets.to(device)</span>
<span id="cb1529-34"><a href="#cb1529-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward pass</span></span>
<span id="cb1529-35"><a href="#cb1529-35" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(inputs)</span>
<span id="cb1529-36"><a href="#cb1529-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1529-37"><a href="#cb1529-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate the loss</span></span>
<span id="cb1529-38"><a href="#cb1529-38" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb1529-39"><a href="#cb1529-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1529-40"><a href="#cb1529-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Backpropagation</span></span>
<span id="cb1529-41"><a href="#cb1529-41" aria-hidden="true" tabindex="-1"></a>        loss.backward()</span>
<span id="cb1529-42"><a href="#cb1529-42" aria-hidden="true" tabindex="-1"></a>        optimizer.step()</span>
<span id="cb1529-43"><a href="#cb1529-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1529-44"><a href="#cb1529-44" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb1529-45"><a href="#cb1529-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1529-46"><a href="#cb1529-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the average loss for this epoch</span></span>
<span id="cb1529-47"><a href="#cb1529-47" aria-hidden="true" tabindex="-1"></a>    average_loss <span class="op">=</span> total_loss <span class="op">/</span> <span class="bu">len</span>(train_loader)</span>
<span id="cb1529-48"><a href="#cb1529-48" aria-hidden="true" tabindex="-1"></a>    losses.append(average_loss)</span>
<span id="cb1529-49"><a href="#cb1529-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>: </span>
<span id="cb1529-50"><a href="#cb1529-50" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Epoch [</span><span class="sc">{</span>epoch<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_epochs<span class="sc">}</span><span class="ss">] Loss: </span><span class="sc">{</span>average_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb1529-51"><a href="#cb1529-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1529-52"><a href="#cb1529-52" aria-hidden="true" tabindex="-1"></a><span class="co">############################# testing the model #############################</span></span>
<span id="cb1529-53"><a href="#cb1529-53" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">eval</span>()  <span class="co"># Set the model to evaluation mode</span></span>
<span id="cb1529-54"><a href="#cb1529-54" aria-hidden="true" tabindex="-1"></a>test_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb1529-55"><a href="#cb1529-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1529-56"><a href="#cb1529-56" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> torch.no_grad():</span>
<span id="cb1529-57"><a href="#cb1529-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> inputs, targets <span class="kw">in</span> test_loader:</span>
<span id="cb1529-58"><a href="#cb1529-58" aria-hidden="true" tabindex="-1"></a>        inputs <span class="op">=</span> inputs.to(device)</span>
<span id="cb1529-59"><a href="#cb1529-59" aria-hidden="true" tabindex="-1"></a>        targets <span class="op">=</span> targets.to(device)</span>
<span id="cb1529-60"><a href="#cb1529-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1529-61"><a href="#cb1529-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Forward pass</span></span>
<span id="cb1529-62"><a href="#cb1529-62" aria-hidden="true" tabindex="-1"></a>        outputs <span class="op">=</span> model(inputs)</span>
<span id="cb1529-63"><a href="#cb1529-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1529-64"><a href="#cb1529-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate the loss</span></span>
<span id="cb1529-65"><a href="#cb1529-65" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> criterion(outputs, targets)</span>
<span id="cb1529-66"><a href="#cb1529-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1529-67"><a href="#cb1529-67" aria-hidden="true" tabindex="-1"></a>        test_loss <span class="op">+=</span> loss.item()</span>
<span id="cb1529-68"><a href="#cb1529-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1529-69"><a href="#cb1529-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the average test loss</span></span>
<span id="cb1529-70"><a href="#cb1529-70" aria-hidden="true" tabindex="-1"></a>average_test_loss <span class="op">=</span> test_loss <span class="op">/</span> <span class="bu">len</span>(test_loader)</span>
<span id="cb1529-71"><a href="#cb1529-71" aria-hidden="true" tabindex="-1"></a><span class="co"># test_loss_list_P_25.append(average_test_loss)</span></span>
<span id="cb1529-72"><a href="#cb1529-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Average Test Loss: </span><span class="sc">{</span>average_test_loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb1529-73"><a href="#cb1529-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1529-74"><a href="#cb1529-74" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, num_epochs <span class="op">+</span> <span class="dv">1</span>), losses)</span>
<span id="cb1529-75"><a href="#cb1529-75" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb1529-76"><a href="#cb1529-76" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb1529-77"><a href="#cb1529-77" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.title('Train Loss vs. Epoch for channel '+target_var_96_list[x_channel])</span></span>
<span id="cb1529-78"><a href="#cb1529-78" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>) </span>
<span id="cb1529-79"><a href="#cb1529-79" aria-hidden="true" tabindex="-1"></a>plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1324, 4, 80, 80) (332, 4, 80, 80) (1324, 2, 80, 80) (332, 2, 80, 80)
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Autoencoder_UNET                         [1656, 2, 80, 80]         --
├─Encoder: 1-1                           --                        --
│    └─Sequential: 2-1                   --                        --
│    │    └─Conv2d: 3-1                  [1656, 64, 40, 40]        2,368
│    │    └─GELU: 3-2                    [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-3                  [1656, 64, 40, 40]        36,928
│    │    └─GELU: 3-4                    [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-5                  [1656, 128, 20, 20]       73,856
│    │    └─GELU: 3-6                    [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-7                  [1656, 128, 20, 20]       147,584
│    │    └─GELU: 3-8                    [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-9                  [1656, 256, 10, 10]       295,168
│    │    └─GELU: 3-10                   [1656, 256, 10, 10]       --
│    │    └─Flatten: 3-11                [1656, 25600]             --
│    │    └─Linear: 3-12                 [1656, 2048]              52,430,848
├─Decoder: 1-2                           --                        --
│    └─Sequential: 2-2                   --                        --
│    │    └─Linear: 3-13                 [1656, 25600]             52,454,400
│    │    └─Unflatten: 3-14              [1656, 256, 10, 10]       --
│    │    └─ConvTranspose2d: 3-15        [1656, 128, 20, 20]       295,040
│    │    └─GELU: 3-16                   [1656, 128, 20, 20]       --
│    │    └─Conv2d: 3-17                 [1656, 128, 20, 20]       147,584
│    │    └─GELU: 3-18                   [1656, 128, 20, 20]       --
│    │    └─ConvTranspose2d: 3-19        [1656, 64, 40, 40]        73,792
│    │    └─GELU: 3-20                   [1656, 64, 40, 40]        --
│    │    └─Conv2d: 3-21                 [1656, 64, 40, 40]        36,928
│    │    └─GELU: 3-22                   [1656, 64, 40, 40]        --
│    │    └─ConvTranspose2d: 3-23        [1656, 2, 80, 80]         1,154
==========================================================================================
Total params: 105,995,650
Trainable params: 105,995,650
Non-trainable params: 0
Total mult-adds (Units.TERABYTES): 1.07
==========================================================================================
Input size (MB): 169.57
Forward/backward pass size (MB): 9014.58
Params size (MB): 423.98
Estimated Total Size (MB): 9608.13
==========================================================================================</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  1%|          | 1/100 [00:01&lt;03:17,  1.99s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [1/100] Loss: 519.4141</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 21%|██        | 21/100 [00:36&lt;02:15,  1.72s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [21/100] Loss: 10.5276</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 41%|████      | 41/100 [01:10&lt;01:41,  1.72s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [41/100] Loss: 2.6655</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 61%|██████    | 61/100 [01:44&lt;01:06,  1.72s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [61/100] Loss: 5.3309</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> 81%|████████  | 81/100 [02:19&lt;00:32,  1.72s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch [81/100] Loss: 2.3606</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 100/100 [02:52&lt;00:00,  1.72s/it]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Test Loss: 0.9041</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="Autoencoder_files/figure-html/cell-79-output-14.png" class="lightbox" data-gallery="quarto-lightbox-gallery-92"><img src="Autoencoder_files/figure-html/cell-79-output-14.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-110" class="cell">
<div class="sourceCode cell-code" id="cb1543"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1543-1"><a href="#cb1543-1" aria-hidden="true" tabindex="-1"></a>torch.save(model.state_dict(), <span class="st">'model/auto_conv_unet_in4_out2.pt'</span>)</span>
<span id="cb1543-2"><a href="#cb1543-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Autoencoder_UNET(image_size <span class="op">=</span> <span class="dv">80</span>, num_input_channels <span class="op">=</span> <span class="dv">4</span>, num_output_channels<span class="op">=</span><span class="dv">2</span>, c_hid <span class="op">=</span> <span class="dv">64</span>, latent_dim <span class="op">=</span> <span class="dv">2048</span>, activation<span class="op">=</span> nn.GELU)</span>
<span id="cb1543-3"><a href="#cb1543-3" aria-hidden="true" tabindex="-1"></a>model.to(device) </span>
<span id="cb1543-4"><a href="#cb1543-4" aria-hidden="true" tabindex="-1"></a>model.load_state_dict(torch.load(<span class="st">'model/auto_conv_unet_in4_out2.pt'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;All keys matched successfully&gt;</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/jaiswalsuraj487\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>